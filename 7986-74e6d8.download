"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7986],{27986:function(e,t,s){s.d(t,{Z:function(){return tK}});var l=s(52676),a=s(6027),i=s(21689),n=s(13990),r=s(13005),o=s(87748),d=s(17224),c=s.n(d),u=s(75271),m=s(46571),h=s(37639),p=s(25010),x=s(96164),g=s(46988),v=s(31022),f=s(76011),b=s(7717),_=s(27976),j=s(97571),y=s(29871),w=s(90488),N=s(39696),Z=s(31447),S=s(65884),k=s(69205),C=s(4814),E=s(57546),D=s(34276);let T=e=>(/^https?:\/\//i.test(e)||(e="https://"+e),e);var I=u.memo(e=>{let{data:t,selected:s,goToTraditionalSearch:a}=e,i=(0,d.useRouter)(),n=(0,b.useTranslations)(),r=(0,v.Z)(e=>e.setLoading),[o,c]=(0,u.useState)(!1),m=async()=>{var e;if((null==t?void 0:t.type)==="site"||!await (0,D.f)({query:null===(e=t.title)||void 0===e?void 0:e.trim(),setLoading:r}))return;v.Z.getState().startSearch("guess");let{isOpenThreadModal:s,closeThreadModal:l}=E.Z.getState();s&&l(),i.push((0,h.M)({query:t.title}))};if((null==t?void 0:t.type)==="site"){let{domain:e,title:a}=t,i=T(e);return(0,l.jsxs)("section",{className:(0,C.Z)("scroll-m-32","transition-[background] flex group items-center gap-2 p-2 text-sm rounded cursor-pointer",(s||o)&&"bg-slate-200 dark:bg-slate-700"),onMouseOver:()=>c(!0),onMouseLeave:()=>c(!1),onClick:()=>{window.open(i,"_blank")},children:[(0,l.jsx)("div",{children:(0,l.jsx)(w.Z,{classNames:{wrapper:"flex-shrink-0"},src:"https://www.google.com/s2/favicons?domain=".concat(i,"&sz=",16)})}),(0,l.jsx)("span",{className:"truncate mr-2 flex-shrink-0",children:a}),(0,l.jsxs)("span",{className:"flex items-center min-w-0",children:[(0,l.jsx)(N.Z,{className:"flex-shrink-0 w-3 h-3 mr-1 text-gray-400 dark:text-gray-500"}),(0,l.jsx)("span",{className:"text-xs text-gray-400 dark:text-gray-500 truncate",children:i})]}),(0,l.jsx)(Z.Z,{className:"opacity-0 group-hover:opacity-100 transition-opacity ml-auto flex-shrink-0",size:18})]})}return(null==t?void 0:t.type)==="websearch"?(0,l.jsxs)("div",{className:(0,C.Z)("scroll-m-32","transition-[background] flex group items-center gap-2 p-2 text-sm rounded cursor-pointer",(s||o)&&"bg-slate-200 dark:bg-slate-700"),onMouseOver:()=>c(!0),onMouseLeave:()=>c(!1),onClick:a,children:[(0,l.jsx)(S.Z,{className:"w-4 h-4"}),(0,l.jsx)("div",{className:"text-sm",children:n("traditional_search")}),(0,l.jsx)("div",{className:"text-xs text-gray-500 ml-1 italic",children:n("traditional_search_tip")}),(0,l.jsx)("div",{className:"ml-auto border border-[#9B9FFF] text-[#9B9FFF] rounded-xl px-1",children:"Beta"})]}):(0,l.jsxs)("div",{className:(0,C.Z)("scroll-m-32","transition-[background] flex group items-center gap-2 p-2 text-sm rounded cursor-pointer",(s||o)&&"bg-slate-200 dark:bg-slate-700"),onMouseOver:()=>c(!0),onMouseLeave:()=>c(!1),onClick:m,children:[(0,l.jsx)(k.Z,{className:"w-4 h-4"}),t.title]})}),A=s(26595),R=s(57207),z=s(37376),F=s(14428),L=s(50726),P=s(73070),M=s(65130),U=s(28930),O=s(72932),B=s(36551),V=s(46344),Y=s(31442),q=s(67241),W=s(4590),J=s(97247),X=s(31063),G=s(60161),H=s(17112),$=s(43378),Q=s(20627),K=s(35487),ee=s(14562),et=s(70463),es=s(84997),el=s(56662),ea=s(12745),ei=s(7106),en=s(21721),er=s(10328),eo=s(87106),ed=s(81555),ec=s(9455),eu=s(65550),em=s(38188),eh=s(65819),ep=s(38793),ex=s(48958),eg=s(40736),ev=s(46745),ef=s(3488),eb=s(64744),e_=s(2488),ej=s(70017),ey=s(1167),ew=s(25994),eN=s(49759),eZ=s(56975),eS=s(41031),ek=s(74538),eC=s(98683),eE=s(14386),eD=s(21133),eT=e=>{let{selectItem:t,selectClick:s}=e,a=(0,b.useTranslations)(),i=(0,eh.gQ)(),n=(0,u.useMemo)(()=>i?[{icon:(0,l.jsx)(eE.aL,{className:"w-5 h-5"}),name:a("shareThread.secret"),value:"PRIVATE"},{icon:(0,l.jsx)(eC.Z,{className:"w-5 h-5"}),name:a("shareThread.enterprise_title"),value:"PARTIAL_PUBLIC"},{icon:(0,l.jsx)(eD.FO,{className:"w-5 h-5"}),name:a("shareThread.shareable"),value:"PUBLIC"}]:[{icon:(0,l.jsx)(eE.aL,{className:"w-5 h-5"}),name:a("shareThread.secret"),value:"PRIVATE"},{icon:(0,l.jsx)(eD.FO,{className:"w-5 h-5"}),name:a("shareThread.shareable"),value:"PUBLIC"}],[i]),r=(0,u.useMemo)(()=>{let e=n.find(e=>e.value===t.permission.read_permission);return(null==e?void 0:e.name)||""},[t]),o=(0,u.useMemo)(()=>{let e=n.find(e=>e.value===t.permission.read_permission);return(null==e?void 0:e.icon)||""},[t]);return(0,l.jsxs)(eN.F,{children:[(0,l.jsx)(eZ.S,{children:(0,l.jsxs)("div",{className:"flex items-center justify-between w-full px-2 py-1  bg-white border border-gray-300 rounded-md shadow-sm cursor-pointer  hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2  focus:ring-indigo-500 dark:bg-[#202531] dark:border-[#454E5D]  dark:hover:bg-[#202531]",children:[o,(0,l.jsx)("span",{className:"ml-2 mr-4 whitespace-nowrap",children:r}),(0,l.jsx)(O.Z,{size:20})]})}),(0,l.jsx)(eS.a,{"aria-label":"topic Changed",className:"p-2 overflow-auto",style:{position:"relative",pointerEvents:"auto"},children:n.map((e,a)=>(0,l.jsx)(ek.W,{className:"text-[#1D3C6D] cursor-pointer hover:!bg-blue-100 hover:!text-[#1D3C6D] dark:text-[#EDF3FC] hover:dark:!bg-[#2E3643] hover:dark:!text-[#EDF3FC]",onClick:()=>{s(t,e.value)},children:e.name},a))})]})},eI=s(26449),eA=s(89335),eR=s(77844),ez=s(95191),eF=s(59892),eL=e=>{let{defaultItem:t,isUsing:s,isEditing:a,callbacks:i,setIsEditing:n,onSubmit:r,tooltipOpen:o}=e,d=(0,b.useTranslations)(),c=(0,b.useLocale)(),m=(0,v.Z)(e=>e.proSelected),h=(0,eh.ZP)(e=>e.isLogin),[x,g]=(0,u.useState)({name:t.title,description:t.description,placeholder:t.placeholder,steps:t.sub_topics}),[f,_]=(0,u.useState)(""),[j,y]=(0,u.useState)(!1),[w,N]=(0,u.useState)(""),[Z,S]=(0,u.useState)(!1),[k,C]=(0,u.useState)([]),[E,D]=(0,u.useState)([]),[T,I]=(0,u.useState)(!1),{copy:A,copied:R}=(0,ej.V)(),[z,F]=(0,u.useState)(!1),L=eR.Z.getState().current,P=t.system,M=P||!t.created_at,[U,O]=(0,u.useState)("");(0,u.useEffect)(()=>{(async()=>{let e=await (0,ez.Y)(t.title),s=(0,eF.b)(e);O("".concat(location.origin,"/agents/").concat(s,"-").concat(t.short_id).concat(L?"?invite="+L:""))})()},[t.title,t.short_id,L]),(0,u.useEffect)(()=>{try{var e;I(!!(t.params&&(null===(e=t.params[0])||void 0===e?void 0:e.type)==="file"))}catch(e){console.log(e),I(!1)}},[t]);let V=(e,t)=>{t.length>100||g(s=>({...s,steps:s.steps.map((s,l)=>l===e?{...s,title:t}:s)}))},Y=(e,t)=>{g(s=>({...s,steps:s.steps.map((s,l)=>l===e?{...s,source_type:t.source_type,source_id:t.source_id,source_info:t.source_info,tools:t.tools}:s)}))},q=e=>{if(x.steps.length<=1){H.Z.warning(d("agent.min_one_step_required"));return}g(t=>({...t,steps:t.steps.filter((t,s)=>s!==e)}))},W=e=>{if(x.steps.length>=ew.o2){H.Z.warning(d("agent.max_steps_reached",{count:ew.o2}));return}g(t=>({...t,steps:[...t.steps.slice(0,e+1),{title:"",source_type:B.gl},...t.steps.slice(e+1)]}))},J=async()=>{try{var e,s;if(!x.name.trim()){N(d("agent.please_input_agent_name"));return}if(x.steps.some(e=>!e.title.trim())){N(d("agent.please_input_steps"));return}if(!h)return;y(!0),N("");let l=null;if(M){let s={introduction:x.description||"",title:x.name,placeholder:x.placeholder,sub_topics:x.steps,params:null==t?void 0:t.params,template_type:ed.W.DEFAULT,lang:c};(l=await (0,eo.YX)(s)).data&&(null===(e=i.onCreate)||void 0===e||e.call(i,l.data))}else if(t){let e={short_id:t.short_id,introduction:x.description||"",title:x.name,placeholder:x.placeholder,sub_topics:x.steps,params:null==t?void 0:t.params,template_type:ed.W.DEFAULT};(l=await (0,eo._Z)(e)).data&&(null===(s=i.onUpdate)||void 0===s||s.call(i,l.data))}if(!l||!l.success){H.Z.error((null==l?void 0:l.error)||d("save_failed")),y(!1);return}H.Z.success(d("save_success")),n(!1),(0,X.fk)(P?G.U.AGENT_SAVE:G.U.AGENT_CREATE_SAVE,{name:x.name},!0)}catch(e){N(e instanceof Error?e.message:d("save_failed"))}finally{y(!1)}},Q=async e=>{if(e.preventDefault(),!j){if(!t){N(d("please_select_report_type"));return}if(!f){N(d("please_input_industry_name"));return}try{y(!0),N("");let e=v.Z.getState().proSelected?B.NY:B.R_,s=localStorage.getItem(em.J.GTAG_EVENT_ACTIVATION)||eh.ZP.getState().anonymousToken,l=await (0,eo.GK)(t.short_id,{query:f,mode:e,device_id:s});if(!l.data||!l.success){H.Z.error((null==l?void 0:l.error)||d("submit_failed")),y(!1);return}let a=l.data.sub_queries;await r(a)}catch(e){N(e instanceof Error?e.message:d("submit_failed"))}finally{y(!1)}}},K=async()=>{var e,s;if(!t)return;if(!h){H.Z.success(d("delete_success")),null===(s=i.onDelete)||void 0===s||s.call(i,t.id);return}let l=await (0,eo.hX)([t.short_id]);if(!l.success){H.Z.error((null==l?void 0:l.error)||d("delete_failed"));return}H.Z.success(d("delete_success")),null===(e=i.onDelete)||void 0===e||e.call(i,t.id)},ee=async()=>{S(!0);try{let e=await (0,eo.hi)(t.short_id);e.data&&(C(e.data.filter(e=>!0===e.permission.is_self)||[]),D(e.data.filter(e=>!1===e.permission.is_self)||[]))}catch(e){console.log(e),C([]),D([])}},et=async(e,t)=>{200===(await (0,eA.n2)({topic_id:e.short_id,read_permission:t})).status&&C(s=>s.map(s=>s.short_id===e.short_id?{...s,permission:{read_permission:t,is_self:s.permission.is_self,can_read:s.permission.can_read}}:s))};(0,u.useEffect)(()=>{if(k.length<=0){F(!0);return}let e=k.every(e=>"PUBLIC"===e.permission.read_permission),t=k.some(e=>"PRIVATE"===e.permission.read_permission);e?F(!0):t?F(!1):F(!0)},[k]);let es=(0,l.jsx)($.Vq,{open:Z,onOpenChange:S,children:(0,l.jsxs)($.cZ,{className:"max-w-2xl w-full max-h-full",children:[(0,l.jsx)($.fK,{children:(0,l.jsx)($.$N,{children:d("share_research_plan")})}),(0,l.jsxs)("section",{className:"px-6 pb-8 pt-4 w-full overflow-hidden",children:[(0,l.jsx)("p",{className:"text-sm text-muted-foreground mb-2",children:d("agent.copy_link_label")}),(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("p",{className:"flex-1 p-2 text-sm bg-muted rounded-md rounded-r-none truncate",children:z&&0===E.length?U:"".concat(U.slice(0,40),"...")}),(0,l.jsx)(p.z,{size:"sm",disabled:!z,className:"px-3 shrink-0 rounded-l-none transition-colors duration-300 ".concat(R?"bg-green-500 hover:bg-green-600":""),onClick:()=>{if(E.length>0&&o&&!E.every(e=>"PUBLIC"===e.permission.read_permission)){o();return}A(U),(0,X.fk)(G.U.AGENT_SHARE,{value:1},!0)},children:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[R?(0,l.jsx)(eg.Z,{className:"h-4 w-4"}):(0,l.jsx)(ev.Z,{className:"h-4 w-4"}),(0,l.jsx)("span",{children:d("copy")})]})})]}),k.length>0&&(0,l.jsxs)("div",{className:"border border-theme-border-100 rounded-md mt-6",children:[(0,l.jsxs)("div",{className:"flex gap-2 bg-[#FFF0DE] text-[#f59a23] px-2 py-1 rounded-t-md",children:[(0,l.jsx)(ef.Z,{size:20,className:"mt-[2px]"}),(0,l.jsx)("span",{children:d("agent.share_tip_desc")})]}),(0,l.jsx)("div",{className:"flex flex-col gap-4 p-3 mt-2",children:k.map(e=>(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("div",{className:"max-w-[200px] whitespace-nowrap overflow-hidden text-ellipsis text-base font-bold",children:e.name}),(0,l.jsxs)("div",{className:"text-sm text-gray-400",children:["(",d("agent.share_tip_desc_file"),")"]}),(0,l.jsx)("div",{className:"ml-auto",children:(0,l.jsx)(eT,{selectItem:e,selectClick:et})})]},e.short_id))})]}),(0,l.jsx)("div",{className:"mt-6 space-y-4",children:(0,l.jsx)("div",{className:"flex flex-col gap-4",children:(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)("p",{className:"text-sm font-medium",children:d("agent.share_description_title")}),(0,l.jsxs)("ul",{className:"list-inside space-y-1 text-sm text-muted-foreground",children:[(0,l.jsx)("li",{children:d("agent.share_description_1")}),(0,l.jsx)("li",{children:d("agent.share_description_2")}),(0,l.jsx)("li",{children:d("agent.share_description_3")})]})]})})})]})]})});if(a){var el;return(0,l.jsxs)("div",{className:"flex flex-col h-full relative",children:[(0,l.jsxs)("div",{className:"flex-1 flex flex-col h-full p-6 overflow-y-auto scrollbar",children:[(0,l.jsx)("h3",{className:"flex-none font-medium mb-4",children:d("agent.edit_template")}),(0,l.jsxs)("div",{className:"flex-1 space-y-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,l.jsxs)("label",{className:"block text-sm font-medium mb-2",children:[d("agent.agent_name"),(0,l.jsx)("span",{className:"text-red-500 ml-0.5",children:"*"})]}),(0,l.jsxs)("div",{className:"text-xs text-gray-500",children:[x.name.length,"/70"]})]}),(0,l.jsx)(ex.Y,{value:x.name,onChange:e=>g(t=>({...t,name:e.target.value})),placeholder:d("agent.input_agent_name"),maxLength:70})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,l.jsx)("label",{className:"block text-sm font-medium",children:d("agent.agent_description")}),(0,l.jsxs)("div",{className:"text-xs text-gray-500",children:[(null===(el=x.description)||void 0===el?void 0:el.length)||0,"/200"]})]}),(0,l.jsx)(ep.Y,{value:x.description,onChange:e=>g(t=>({...t,description:e.target.value})),placeholder:d("agent.input_agent_description"),maxLength:200,minRows:3,maxRows:5})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,l.jsx)("label",{className:"block text-sm font-medium",children:d("agent.template_placeholder")}),(0,l.jsxs)("div",{className:"text-xs text-gray-500",children:[x.placeholder.length,"/100"]})]}),(0,l.jsx)(ep.Y,{value:x.placeholder,onChange:e=>g(t=>({...t,placeholder:e.target.value})),placeholder:d("agent.input_template_placeholder"),maxLength:100,minRows:2,maxRows:3})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,l.jsxs)("label",{className:"block text-sm font-medium",children:[d("agent.agent_steps"),(0,l.jsx)("span",{className:"text-red-500 ml-0.5",children:"*"})]}),(0,l.jsxs)(p.z,{size:"sm",variant:"ghost",onClick:()=>{if(x.steps.length>=ew.o2){H.Z.warning(d("agent.max_steps_reached",{count:ew.o2}));return}g(e=>({...e,steps:[...e.steps,{title:"",source_type:B.gl}]}))},children:["+ ",d("agent.add_step")]})]}),(0,l.jsx)("div",{className:"space-y-2",children:x.steps.map((e,t)=>(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("div",{className:"flex-none w-6 text-sm text-gray-500",children:t+1}),(0,l.jsx)(ex.Y,{value:e.title,onChange:e=>V(t,e.target.value),placeholder:d("agent.input_step_content"),maxLength:100}),(0,l.jsxs)("div",{className:"flex gap-1",children:[!T&&(0,l.jsx)(eI.Z,{item:e,onChange:Y,index:t}),(0,l.jsx)(p.z,{size:"sm",variant:"ghost",onClick:()=>W(t),className:"text-gray-500 hover:text-blue-500",children:(0,l.jsx)("span",{children:"+"})}),(0,l.jsx)(p.z,{size:"sm",variant:"ghost",onClick:()=>q(t),className:"text-gray-500 hover:text-red-500",children:(0,l.jsx)("span",{children:"-"})})]})]},t))})]})]}),w&&(0,l.jsx)("div",{className:"mt-4 text-sm text-red-500",children:w})]}),(0,l.jsxs)("div",{className:"flex-none flex items-center justify-between gap-2 px-6 py-4 border-t",children:[!P&&(0,l.jsx)("div",{children:(0,l.jsx)(p.z,{variant:"destructive",size:"sm",onClick:K,children:d("delete")})}),(0,l.jsxs)("div",{className:"flex-1 flex justify-end space-x-2",children:[(0,l.jsx)(p.z,{variant:"outline",size:"sm",onClick:()=>{var e;n(!1),N(""),g({name:t.title,description:t.description,placeholder:t.placeholder,steps:t.sub_topics}),null===(e=i.onBack)||void 0===e||e.call(i)},children:d("cancel")}),(0,l.jsx)(p.z,{size:"sm",onClick:J,disabled:j||!x.name,children:P?d("save_to_my_templates"):d("confirm")})]})]})]})}return s?(0,l.jsxs)("div",{className:"p-6",children:[(0,l.jsxs)(p.z,{variant:"ghost",size:"sm",onClick:i.onBack,className:"hover:bg-gray-100 dark:hover:bg-gray-600 mb-4",disabled:j,children:[(0,l.jsx)(eb.Z,{className:"h-4 w-4"}),(0,l.jsx)("span",{children:d("back")})]}),(0,l.jsxs)("form",{onSubmit:Q,className:"space-y-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"flex items-center justify-between gap-2 mb-2",children:[(0,l.jsxs)("label",{htmlFor:"brandName",className:"block text-sm font-medium",children:[d("research_target"),(0,l.jsx)("span",{className:"text-red-500 ml-0.5",children:"*"})]}),(0,l.jsxs)("div",{className:"text-xs text-gray-500",children:[f.length,"/70"]})]}),(0,l.jsx)(ex.Y,{id:"brandName",name:"brandName",placeholder:d("research_target_placeholder",{count:70}),value:f,onChange:e=>{_(e.target.value),N("")},maxLength:70,autoFocus:!0,isDisabled:j,isInvalid:!!w,errorMessage:w,isRequired:!0,autoComplete:"off",autoCorrect:"off",autoCapitalize:"off"})]}),(0,l.jsx)("div",{className:"absolute bottom-6 right-6",children:(0,l.jsx)(p.z,{type:"submit",size:"sm",disabled:j,children:j?d("generating"):d("confirm")})})]})]}):!a&&x.name?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("section",{className:"h-full flex flex-col gap-2",children:[(0,l.jsxs)("div",{className:"flex-1 p-6",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,l.jsx)("span",{className:"font-bold",children:d("introduction")}),m&&(0,l.jsxs)("span",{className:"flex items-center gap-2",children:[(0,l.jsx)(ey.pn,{delayDuration:100,children:(0,l.jsxs)(ey.u,{children:[(0,l.jsx)(ey.aJ,{children:(0,l.jsx)(e_.Z,{className:"h-4 w-4"})}),(0,l.jsx)(ey._v,{children:d("agent.pro_search_cost_tip")})]})}),(0,l.jsx)("span",{className:"text-sm text-gray-500",children:d("agent.pro_search_cost",{count:x.steps.length})})]})]}),(0,l.jsx)("p",{className:"text-sm mt-6",children:x.description}),(0,l.jsx)("ul",{className:"mt-6 list-disc list-inside space-y-1",children:x.steps.map(e=>(0,l.jsx)("li",{children:e.title},e.title))})]}),(0,l.jsx)("section",{className:"flex-none pl-4 pr-2 pb-4",children:(0,l.jsxs)("section",{className:"flex items-center justify-between gap-2",children:[(0,l.jsx)("section",{children:h&&(0,l.jsx)(p.z,{variant:"outline",onClick:ee,className:"flex items-center gap-2",children:(0,l.jsx)("span",{children:d("share_research_plan")})})}),(0,l.jsxs)("section",{className:"space-x-2",children:[h&&(0,l.jsx)(p.z,{variant:"outline",onClick:()=>{n(!0),(0,X.fk)(G.U.AGENT_EDIT,{name:x.name},!0)},children:d("edit")}),(0,l.jsx)(p.z,{onClick:()=>{var e;null===(e=i.onConfirm)||void 0===e||e.call(i,t)},children:d("apply")})]})]})})]}),es]}):null},eP=s(30674),eM=s(37481);let eU=[{key:"processing",label:"agent.create_agent_step_1"},{key:"createing",label:"agent.create_agent_step_2"},{key:"collecting",label:"agent.create_agent_step_3"},{key:"optimizing",label:"agent.create_agent_step_4"}];var eO=e=>{let{onCreate:t,onCancel:s}=e,a=(0,b.useTranslations)(),[i,n]=(0,u.useState)(!1),[r,o]=(0,u.useState)(!1),[d,c]=(0,u.useState)(""),[m,h]=(0,u.useState)(0),[x,f]=(0,u.useState)();(0,u.useEffect)(()=>{if(i)return(async()=>{for(let e of eU.map((e,t)=>t))await new Promise(e=>setTimeout(e,1e3)),h(e)})(),()=>{h(0)}},[i]);let _=async()=>{n(!0);let{proSelected:e}=v.Z.getState(),t=e?B.NY:B.R_,s=localStorage.getItem(em.J.GTAG_EVENT_ACTIVATION)||eh.ZP.getState().anonymousToken,l=await (0,eo.RV)({query:d,mode:t,device_id:s});if(!l||!l.success||!l.data){n(!1),H.Z.error((null==l?void 0:l.error)||a("error.failed_to_generate_template"));return}f(l.data),n(!1),o(!0);let{title:i}=l.data;(0,X.fk)(G.U.AGENT_CREATE_SUBMIT,{name:i},!0)},j=()=>{c(""),s(),o(!1),f(void 0)};return r&&x?(0,l.jsx)("div",{className:"flex-1 h-full",children:(0,l.jsx)(eL,{defaultItem:x,isUsing:!1,isEditing:!0,setIsEditing:()=>{},onSubmit:()=>{},callbacks:{onBack:j,onCreate:e=>{t(e)},onDelete:()=>{},onUpdate:()=>{},onConfirm:()=>{}}},"create-template")}):(0,l.jsxs)("div",{className:"flex flex-col h-full p-8",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,l.jsx)("h3",{className:"text-md font-medium",children:a("create_ai_search_agent_button")}),!i&&(0,l.jsxs)("span",{className:"text-sm text-gray-500",children:[d.length," / ",100]})]}),i?(0,l.jsx)("div",{className:"flex-1 flex flex-col",children:(0,l.jsx)("div",{className:"space-y-4 w-full max-w-md",children:eU.map((e,t)=>(0,l.jsxs)("div",{className:(0,eM.cn)("flex items-center space-x-4",m>=t?"text-primary":"text-gray-400"),children:[(0,l.jsx)("span",{children:a(e.label)}),(0,l.jsx)(eP.c,{size:"sm",className:(0,eM.cn)("opacity-0",m===t&&"opacity-100")})]},e.key))})}):(0,l.jsxs)("div",{className:"flex-1 mb-6",children:[(0,l.jsx)(g.Z,{className:(0,eM.cn)("p-4 rounded-xl shadow-sm","border-1 border-[#dbe2e9] dark:border-[#343b4d] dark:bg-[#20232a]","w-full bg-inherit outline-none resize-none transition-height"),value:d,onChange:e=>c(e.target.value),onKeyDown:e=>{13==e.keyCode&&!1==e.shiftKey&&!i&&d.trim()&&(e.preventDefault(),_())},placeholder:a("create_ai_search_agent_placeholder"),maxLength:100,minRows:2,autoFocus:!0}),(0,l.jsxs)("div",{className:"mt-4 text-sm",children:[(0,l.jsx)("p",{className:"text-gray-500 mb-2",children:a("agent.example")}),(0,l.jsxs)("div",{className:"flex flex-col gap-2 text-gray-500",children:[(0,l.jsx)("p",{children:a("agent.example_1")}),(0,l.jsx)("p",{children:a("agent.example_2")}),(0,l.jsx)("p",{children:a("agent.example_3")})]})]})]}),(0,l.jsx)("div",{className:"flex justify-end items-center",children:!i&&(0,l.jsxs)("div",{className:"space-x-2",children:[(0,l.jsx)(p.z,{variant:"outline",onClick:j,children:a("cancel")}),(0,l.jsx)(p.z,{onClick:_,disabled:!d.trim(),children:a("submit_task")})]})})]})},eB=s(5588),eV=s(72696),eY=s(35525),eq=s(87010),eW=e=>{let{defaultValue:t,onChange:s,disabled:a,allowedModels:i}=e,n=(0,b.useTranslations)(),{setIsOpen:r,getDataRetentionEnabled:o,setCallback:d}=(0,eY.Z)(),{allModelList:c}=(0,v.Z)(),u=e=>{if(("deepseek-reasoner"===e||"deepseek-chat"===e)&&!o()){r(!0),d(()=>{s(e)});return}s(e)},h=i&&i.length>0?c.filter(e=>i.includes(e.value)):c;return(0,l.jsxs)(eV.h_,{children:[(0,l.jsx)(eV.$F,{asChild:!0,disabled:a,children:(0,l.jsx)("button",{className:"relative inline-block w-full",children:(0,l.jsxs)("div",{className:(0,m.cn)("flex items-center justify-between w-full px-4 py-2 bg-white border border-[#EBEEF3] rounded-md shadow-sm cursor-pointer hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 border dark:border-[#545D6F] dark:bg-[#202531] dark:hover:bg-gray-700",a&&"opacity-50 cursor-not-allowed"),children:[(0,l.jsxs)("span",{className:"flex items-center whitespace-nowrap",children:[(()=>{var e;let s=null===(e=c.find(e=>e.value===t))||void 0===e?void 0:e.provider;return s?eq.e[s]:null})(),(0,l.jsx)("span",{className:"ml-2 mr-4",children:(()=>{let e=c.find(e=>e.value===t);return e?e.label:""})()})]}),(0,l.jsx)(O.Z,{size:20})]})})}),(0,l.jsxs)(eV.AW,{className:"w-fit p-3 dark:bg-[#454E5D] dark:border-[#2E3643]",children:[(0,l.jsx)("div",{className:"mb-2 text-base",children:n("set_advanced_model")}),(0,l.jsx)("div",{className:"max-h-[40vh] overflow-y-auto custom-scrollbar",children:h.map(e=>(0,l.jsxs)(eV.Xi,{className:(0,m.cn)("flex items-center cursor-pointer","text-[#1D3C6D] hover:!bg-blue-100 hover:!text-[#1D3C6D] dark:text-[#EDF3FC] hover:dark:!bg-[#2E3643] hover:dark:!text-[#EDF3FC]",!_.r8&&e.is_dev&&"hidden"),onClick:()=>u(e.value),children:[(0,l.jsxs)("span",{className:"flex items-center",children:[eq.e[e.provider],(0,l.jsx)("span",{className:"ml-2",children:e.label})]}),(0,l.jsxs)("span",{className:"flex gap-2",children:[e.is_beta&&(0,l.jsx)("span",{className:"rounded-xl text-[#0080FF] bg-[#D6F3FF] dark:bg-[#191E26] dark:text-[#EDF3FC] px-2 py-0.5 text-xs",children:"Beta"}),e.is_pro&&(0,l.jsx)("span",{className:"rounded-xl text-[#0080FF] bg-[#D6F3FF] dark:bg-[#191E26] dark:text-[#EDF3FC] px-2 py-0.5 text-xs",children:"Pro"})]})]},e.value))})]})]})},eJ=s(93734),eX=s(78017),eG=e=>{let{dafaultTemplate:t,onCreate:s,onDelete:a,onUpdate:i,onConfirm:n,onCancel:r}=e,o=(0,b.useTranslations)(),d=(0,b.useLocale)(),[c,h]=(0,u.useState)(!1),[x,g]=(0,u.useState)({title:"",description:"",instructions:"",model:eX._,sourceType:B.gl,topicInfo:{title:"",id:""}}),[v,f]=(0,u.useState)(!1),[_,j]=(0,u.useState)("");(0,u.useEffect)(()=>{if(!t||!t.sub_topics[0])return;let{source_id:e,source_type:s,llm_model:l,instructions:a}=t.sub_topics[0];g({title:t.title||"",description:t.placeholder||"",instructions:a||"",model:l||eX._,sourceType:s||B.gl,topicInfo:{title:t.title||"",id:e||""}})},[t]);let y=()=>{r()},w=()=>({introduction:x.description,title:x.title,placeholder:"",sub_topics:[{title:x.title,source_type:x.sourceType,source_id:x.topicInfo.id,llm_model:x.model,instructions:x.instructions}],template_type:ed.W.CUSTOM,lang:d}),N=async()=>{f(!0);let e=w(),t=await (0,eo.YX)(e);t.data&&s(t.data),f(!1)},Z=async()=>{f(!0);let e={...w(),short_id:(null==t?void 0:t.short_id)||""},s=await (0,eo._Z)(e);s.data&&(null==i||i(s.data),h(!1)),f(!1)},S=async()=>{if(!t)return;let e=await (0,eo.hX)([t.short_id]);if(!e.success){H.Z.error((null==e?void 0:e.error)||o("delete_failed"));return}H.Z.success(o("delete_success")),null==a||a(t.id)};return(0,l.jsx)("div",{className:"flex-1 h-full",children:(0,l.jsxs)("div",{className:"flex flex-col h-full relative",children:[(0,l.jsxs)("div",{className:"flex-1 flex flex-col h-full p-6 overflow-y-auto scrollbar",children:[(0,l.jsxs)("div",{className:"flex-1 space-y-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,l.jsxs)("label",{className:"block text-sm font-medium mb-2",children:[o("agent.agent_name"),(0,l.jsx)("span",{className:"text-red-500 ml-0.5",children:"*"})]}),(0,l.jsxs)("div",{className:"text-xs text-gray-500",children:[x.title.length,"/70"]})]}),(0,l.jsx)(eB.I,{value:x.title,onChange:e=>g(t=>({...t,title:e.target.value})),placeholder:o("agent.input_agent_name"),maxLength:70,disabled:!c&&!!t})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,l.jsx)("label",{className:"block text-sm font-medium",children:o("agent.agent_description")}),(0,l.jsxs)("div",{className:"text-xs text-gray-500",children:[x.description.length,"/200"]})]}),(0,l.jsx)(ep.Y,{value:x.description,onChange:e=>g(t=>({...t,description:e.target.value})),placeholder:o("agent.input_agent_description"),maxLength:200,minRows:2,maxRows:5,isDisabled:!c&&!!t})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,l.jsxs)("label",{className:"block text-sm font-medium",children:[o("agent.instructions"),(0,l.jsx)("span",{className:"text-red-500 ml-0.5",children:"*"})]}),(0,l.jsxs)("div",{className:"text-xs text-gray-500",children:[x.instructions.length,"/2000"]})]}),(0,l.jsx)(ep.Y,{value:x.instructions,onChange:e=>g(t=>({...t,instructions:e.target.value})),placeholder:o("agent.input_agent_prompt"),maxLength:2e3,minRows:3,maxRows:20,isDisabled:!c&&!!t})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"mb-2",children:(0,l.jsx)("label",{className:"block text-sm font-medium",children:o("agent.model")})}),(0,l.jsx)(eW,{defaultValue:x.model,onChange:e=>{g(t=>({...t,model:e}))},disabled:!c&&!!t})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"flex items-center justify-between mb-2",children:(0,l.jsx)("label",{className:"block text-sm font-medium",children:o("agent.sources")})}),(0,l.jsx)(eI.Z,{item:{title:x.topicInfo.title,source_type:x.sourceType,source_id:x.topicInfo.id},onChange:(e,t)=>{g(e=>({...e,sourceType:t.source_type})),t.source_type===B.RQ&&g(e=>({...e,topicInfo:{title:t.title,id:t.source_id}}))},index:1,children:(0,l.jsx)(p.z,{variant:"outline",size:"lg",className:"w-full",disabled:!c&&!!t,children:x.sourceType?o((0,eJ.Y)(x.sourceType)):o("agent.manage_sources")})})]})]}),_&&(0,l.jsx)("div",{className:"mt-4 text-sm text-red-500",children:_})]}),(0,l.jsx)("div",{className:"flex-none flex items-center justify-between gap-2 px-6 py-4 border-t",children:t?(0,l.jsxs)("div",{className:(0,m.cn)("flex-1 flex space-x-2",c?"justify-between":"justify-end"),children:[c&&(0,l.jsx)(p.z,{variant:"destructive",size:"sm",onClick:S,children:o("delete")}),c?(0,l.jsxs)("div",{className:"space-x-2",children:[(0,l.jsx)(p.z,{variant:"outline",onClick:()=>{h(!1)},children:o("cancel")}),(0,l.jsx)(p.z,{onClick:Z,disabled:v,children:o("confirm")})]}):(0,l.jsx)("div",{className:"space-x-2",children:(0,l.jsx)(p.z,{onClick:()=>{null==n||n(t)},children:o("apply")})})]}):(0,l.jsxs)("div",{className:"flex-1 flex justify-end space-x-2",children:[(0,l.jsx)(p.z,{variant:"outline",size:"sm",onClick:()=>{y()},children:o("cancel")}),(0,l.jsx)(p.z,{size:"sm",onClick:N,disabled:v||!x.title||!x.instructions,children:o("confirm")})]})})]})})},eH=e=>{let{loading:t,isCreating:s,setIsCreating:a,onCreate:i}=e,n=(0,b.useTranslations)(),[r,o]=(0,u.useState)("search"),d=()=>{if(!eh.ZP.getState().isLogin){E.Z.getState().setLoginModalVisible(!0);return}a(!0)},c=e=>{i(e),a(!1)},m=()=>{a(!1)};return s?"search"===r?(0,l.jsx)(eO,{onCreate:c,onCancel:m}):(0,l.jsx)(eG,{onCreate:c,onCancel:m}):(0,l.jsxs)("div",{className:"flex flex-col items-center justify-center h-full p-8 px-16 text-center",children:[(0,l.jsx)("h3",{className:"text-xl font-medium mb-4",children:n("create_ai_search_agent")}),(0,l.jsx)("p",{className:"text-gray-500 mb-6",children:n("customize_your_ai_search_assistant")}),(0,l.jsx)("div",{className:"flex flex-col gap-4",children:(0,l.jsxs)(p.z,{size:"lg",className:"w-full h-12 text-base font-medium",disabled:t,onClick:()=>{d(),o("search"),(0,X.fk)(G.U.SEARCH_AGENT_CREATE,{name:"create_ai_search_agent"},!0)},children:[(0,l.jsx)(k.Z,{className:"w-5 h-5 mr-2"}),(0,l.jsx)("span",{children:n("create_ai_search_agent_button")})]})})]})},e$=s(57591),eQ=s(74926),eK=e=>{let{isOpen:t,onClose:s,handleEdit:a,onDelete:i,defaultItem:n}=e,r=(0,b.useTranslations)(),o=(0,eh.ZP)(e=>e.isLogin),d=async()=>{if(n){if(o){let e=await (0,eo.hX)([n.short_id]);if(!e.success){H.Z.error((null==e?void 0:e.error)||r("delete_failed"));return}}H.Z.success(r("delete_success")),i(n.id),s()}};return(0,l.jsx)(l.Fragment,{children:(0,l.jsx)($.Vq,{open:t,onOpenChange:s,children:(0,l.jsxs)($.cZ,{className:"max-w-xl w-full max-h-full",children:[(0,l.jsx)($.fK,{children:(0,l.jsx)($.$N,{children:(0,l.jsxs)("div",{className:"flex items-center gap-2 mr-3",children:[(0,l.jsx)(ef.Z,{size:20}),(0,l.jsx)("span",{children:r("agent.agent_unavailable")})]})})}),(0,l.jsx)($.a7,{className:"pt-0",children:(0,l.jsx)("div",{className:"flex flex-col gap-2",children:o?r("agent.agent_unavailable_desc"):r("agent.agent_unavailable_desc_tip")})}),(0,l.jsxs)($.cN,{children:[o&&(0,l.jsx)(p.z,{onClick:a,variant:"outline",children:r("edit")}),(0,l.jsx)(p.z,{onClick:d,color:"primary",children:r("delete")})]})]})})})},e0=()=>{let{id:e}=(0,d.useRouter)().query;return e};let e1=[(0,l.jsx)(Q.Z,{className:"h-4 w-4"},"barchart"),(0,l.jsx)(K.Z,{className:"h-4 w-4"},"linechart"),(0,l.jsx)(ee.Z,{className:"h-4 w-4"},"wallet"),(0,l.jsx)(et.Z,{className:"h-4 w-4"},"settings"),(0,l.jsx)(es.Z,{className:"h-4 w-4"},"share2"),(0,l.jsx)(P.Z,{className:"h-4 w-4"},"filetext"),(0,l.jsx)(k.Z,{className:"h-4 w-4"},"search"),(0,l.jsx)(el.Z,{className:"h-4 w-4"},"bookopen"),(0,l.jsx)(L.Z,{className:"h-4 w-4"},"messagesquare"),(0,l.jsx)(ea.Z,{className:"h-4 w-4"},"target")],e2="my-templates";var e5=e=>{var t;let{template:s,onOpenChange:a,onConfirm:i}=e,n=(0,b.useTranslations)(),r=(0,b.useLocale)(),o=(0,eh.ZP)(e=>e.isLogin),d=e0(),{tempTemplates:x}=(0,eQ.Z)(),[g,f,_]=(0,e$.Z)([]),[j,y]=(0,u.useState)(!1),[w,N]=(0,u.useState)(""),[Z,S]=(0,u.useState)(e2),[k,C]=(0,u.useState)(null),[E,D]=(0,u.useState)(!0),[T,I]=(0,u.useState)(!1),[A,R]=(0,u.useState)(!1),[z,F]=(0,u.useState)(),L=(null===(t=g.find(e=>e.id===e2))||void 0===t?void 0:t.children)||[],P=g.find(e=>e.id===Z),{isOpen:M,onOpen:U,onClose:O}=(0,ec.q)();null==P||P.children.find(e=>e.id===k);let V=null==P?void 0:P.children.find(e=>e.id===w),Y=(0,u.useMemo)(()=>Z===e2&&0===L.length,[Z,L.length]);(0,u.useEffect)(()=>{void 0!==o&&q()},[o]);let q=async()=>{D(!0);try{let e=[(0,eo.P)({language:r,system:!0})];o&&e.unshift((0,eo.P)({language:r,system:!1}));let t=await Promise.all(e),s=o?t[1]:t[0],a=o?t[0]:{success:!0,data:[]};(null==a?void 0:a.success)||H.Z.error((null==a?void 0:a.error)||n("error.get_user_templates_failed")),(null==s?void 0:s.success)||H.Z.error((null==s?void 0:s.error)||n("error.get_system_templates_failed"));let i=[...(null==a?void 0:a.data)||[],...((null==s?void 0:s.data)||[]).filter(e=>e.category)],d=J(i),c={id:"all",icon:(0,l.jsx)(ei.Z,{className:"h-4 w-4"}),title:n("agent.all"),children:s.data||[]};f([c,...d]),W()}catch(e){H.Z.error(n("error.get_templates_failed"))}finally{D(!1)}},W=async()=>{if(!s||!_.current)return;S(e2);let e=null;if(_.current.map(t=>{t.children.map(t=>{t.id===s.id&&(e=t)})}),e)$(e);else{let e={introduction:s.introduction,title:s.title,sub_topics:s.sub_topics,placeholder:s.placeholder,params:s.params,template_type:ed.W.CUSTOM,lang:r},t=await (0,eo.YX)(e);if(t.data){H.Z.success(n("agent.add_share_template_success")),et(t.data);let e=window.location.pathname;history.replaceState({},"",e)}}},J=(0,u.useCallback)(e=>{let t=e.filter(e=>!e.system),s=e.filter(e=>e.system),a={id:e2,icon:(0,l.jsx)(en.Z,{className:"h-4 w-4"}),title:n("my_templates"),children:t};return!o&&x.length&&a.children.unshift(...x),[a,...Object.entries(s.reduce((e,t)=>(e[t.category]||(e[t.category]=[]),e[t.category].push(t),e),{})).map((e,t)=>{let[s,l]=e;return{id:s.toLowerCase().replace(/\s+/g,"-"),icon:e1[t],title:s,children:l}})]},[n]),$=e=>{C(e.id),F(e)},Q=()=>{I(!1),N("")},K=()=>{F(void 0)},ee=async e=>{let t=e.sub_topics.filter(e=>{var t;return e.source_type===B.RQ&&(null===(t=e.source_info)||void 0===t?void 0:t.is_self)===!1});if(t&&t.length>0){let s=await (0,eo.hi)(e.short_id);if(s.data&&s.data.length>0&&!t.every(e=>{var t;return null===(t=s.data)||void 0===t?void 0:t.some(t=>t.short_id===e.source_id&&"PUBLIC"===t.permission.read_permission)})){U();return}}null==i||i(e),(0,X.fk)(e.system?G.U.AGENT_SEARCH_USE:G.U.AGENT_CREATE_USE,{value:1},!0)},et=e=>{if(!_.current)return;let t=[..._.current];t.map(t=>{t.id===e2&&t.children.unshift(e)}),f(t),S(e2),R(!1),Q(),$(e)},es=e=>{var t;let s=[...g];s.map(t=>{t.id===e2&&t.children.map(t=>{t.id===e.id&&(t.title=e.title,t.description=e.introduction,t.placeholder=e.placeholder,t.sub_topics=e.sub_topics,t.params=e.params,t.template_type=e.template_type)})}),f(s);let l=null===(t=s.find(e=>e.id===e2))||void 0===t?void 0:t.children.find(t=>t.id===e.id);l&&$(l),Q()},el=e=>{let t=[...g];t.map(t=>{t.id===e2&&(t.children=t.children.filter(t=>t.id!==e))}),f(t),C(null),Q(),K(),d===e&&c().push("/")},ea=async e=>{null==a||a(!1),c().push((0,h.M)({query:"",multiQuery:e.map(e=>({query:e,category:v.Z.getState().extensionSelected}))}))};return(0,l.jsxs)("div",{className:"flex px-2 border-t min-h-[500px] max-h-[80vh] min-w-[900px] h-[550px] overflow-hidden",children:[(0,l.jsxs)("div",{className:(0,m.cn)("flex-none border-r p-4 min-w-[200px] flex flex-col overflow-y-auto scrollbar",(T||j)&&"opacity-50 pointer-events-none"),children:[(0,l.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,l.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:n("agent.recommend_templates")}),E?(0,l.jsxs)("section",{className:"space-y-3",children:[(0,l.jsx)(eu.X,{className:"rounded-lg w-full h-8"}),(0,l.jsx)(eu.X,{className:"rounded-lg w-full h-8"}),(0,l.jsx)(eu.X,{className:"rounded-lg w-full h-8"})]}):g.map(e=>e.id===e2?null:(0,l.jsxs)("div",{className:"flex items-center gap-2 rounded px-3 py-2 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600 ".concat(Z===e.id?"bg-gray-100 dark:bg-gray-600":""),onMouseEnter:()=>{R(!1),S(e.id),Z!==e.id&&(C(null),Q(),K())},children:[e.icon,(0,l.jsx)("span",{children:e.title})]},e.id))]}),(0,l.jsx)("div",{className:"flex-none",children:(0,l.jsxs)(p.z,{variant:"outline",className:(0,m.cn)("w-full flex items-center gap-2",Z===e2&&"bg-gray-100 dark:bg-gray-600"),onMouseEnter:()=>{R(!1),S(e2),Z!==e2&&(C(null),Q(),K())},children:[(0,l.jsx)(en.Z,{className:"h-4 w-4"}),(0,l.jsx)("span",{children:n("my_templates")})]})})]}),(0,l.jsxs)("div",{className:(0,m.cn)("flex-none p-4 space-y-2 border-r max-w-[30%] overflow-y-auto scrollbar",!(null==P?void 0:P.children.length)&&"hidden",(T||j)&&"opacity-50 pointer-events-none"),children:[Z===e2&&o&&(0,l.jsxs)(p.z,{variant:"outline",className:(0,m.cn)("w-full flex items-center gap-2",A&&"bg-gray-100 dark:bg-gray-600"),onMouseEnter:()=>{R(!0)},children:[(0,l.jsx)(er.Z,{className:"h-4 w-4"}),(0,l.jsx)("span",{children:n("agent.add_template")})]}),null==P?void 0:P.children.map(e=>(0,l.jsx)("div",{className:"rounded px-3 py-2 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600 ".concat(k!==e.id||A?"":"bg-gray-100 dark:bg-gray-600"),onClick:()=>{ee(e)},onMouseEnter:()=>{R(!1),$(e)},children:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("span",{className:"truncate",children:e.title}),!o&&!e.system&&(0,l.jsx)("span",{className:"px-1.5 py-0.5 text-xs rounded bg-gray-100 dark:bg-gray-700 text-gray-500 dark:text-gray-400 whitespace-nowrap",children:n("temp")})]})},e.id))]}),(0,l.jsx)("div",{className:"flex-1 relative flex flex-col overflow-y-auto scrollbar",children:Y||A||!z?(0,l.jsx)(eH,{loading:E,isCreating:j,setIsCreating:y,onCreate:et}):(0,l.jsx)("section",{className:"flex-1 h-full",children:[ed.W.CUSTOM,ed.W.DIRECT_DUTY].includes(z.template_type)?(0,l.jsx)(eG,{dafaultTemplate:z,onCreate:et,onDelete:el,onUpdate:es,onConfirm:ee,onCancel:()=>{}}):(0,l.jsx)(eL,{defaultItem:z,isUsing:!!(null==V?void 0:V.id),isEditing:T,setIsEditing:I,onSubmit:ea,tooltipOpen:U,callbacks:{onBack:Q,onConfirm:ee,onCreate:et,onDelete:el,onUpdate:es}},k)})}),z&&(0,l.jsx)(eK,{isOpen:M,handleEdit:()=>{I(!0),O()},onClose:O,onDelete:el,defaultItem:z})]})};s(79395);var e4=s(55994),e3=s(44509),e6=s(17436),e7=s(54047),e8=e=>{let{open:t,onOpenChange:s,onConfirm:a}=e,i=(0,b.useTranslations)(),{query:n,isReady:r}=(0,d.useRouter)();(0,eh.ZP)(e=>e.isLogin);let{tempTemplates:o,addTempTemplate:c}=(0,eQ.Z)(),{getList:m,inited:h}=(0,e6.Z)(),[p,x]=(0,u.useState)(void 0),g=(0,u.useRef)(null),{setShowAgentLimitModal:v,setShowLimitModalData:f}=(0,e7.Z)();return(0,u.useEffect)(()=>{!h&&t&&m()},[h,t]),(0,u.useEffect)(()=>{p&&sessionStorage.setItem(e4.o.AGENT_SHARE_TEMPLATE_ID,p.short_id)},[p]),(0,u.useEffect)(()=>{!t&&p&&x(void 0)},[t]),(0,l.jsx)($.Vq,{open:t,onOpenChange:s,children:(0,l.jsxs)($.cZ,{className:"max-w-5xl w-full max-h-full",ref:g,"aria-describedby":void 0,children:[(0,l.jsx)($.fK,{children:(0,l.jsx)($.$N,{children:i("extension.search_agent")})}),(0,l.jsx)(e5,{template:p,onOpenChange:s,onConfirm:e=>{if(!g.current)return;let t=E.Z.getState().isOpenThreadModal?"modal_search_form":"default_search_form";(0,e3.T)(g.current,t,()=>{null==a||a(e)})}})]})})},e9=s(37766),te=s(75963);let tt=[B.zA,B.xn,B.X7];var ts=e=>{var t;let{isDisalbedExtension:s}=e,a=(0,b.useTranslations)(),i=(0,te.useRouter)(),n=(0,te.usePathname)(),r=(0,u.useRef)(!0),[o,d]=(0,u.useState)(!1),[c,h]=(0,u.useState)(!1),{isMobile:p,isReady:g}=(0,y.Z)(),f=(0,v.Z)(e=>e.extensionEnable),_=(0,v.Z)(e=>e.extensionSelected),j=(0,eQ.Z)(e=>e.template),w=(0,eQ.Z)(e=>e.setTemplate);(0,v.Z)(e=>e.extensionSelectedLoading),(0,v.Z)(e=>e.extensionSelectedErrorMsg);let N=(0,v.Z)(e=>e.setExtensionEnable),Z=(0,v.Z)(e=>e.setExtensionSelectedLoading),S=()=>v.Z.getState().setExtensionError(void 0,""),{homeImages:C,homeFiles:D,setPreviousSearchCategory:T}=(0,e9.Z)(),[I,$]=(0,u.useState)(!1),Q=[{value:B.gl,title:a("extension.all"),desc:a("extension.all_desc"),icon:(0,l.jsx)(k.Z,{size:20}),visible:!0,disable:!1},{value:B.aI,title:a("extension.chat"),desc:a("extension.chat_desc"),icon:(0,l.jsx)(z.Z,{size:20}),visible:!0,disable:!1},{value:B.Wh,title:a("extension.search_agent"),desc:a("extension.search_agent_desc"),icon:(0,l.jsx)(F.Z,{size:20}),visible:!p,disable:!1,isBeta:!0,onClick:()=>{d(!1),h(!0),(0,X.fk)(G.U.AGENT_SEARCH_SELECTED,{value:1},!0)}},{value:B.pN,title:a("extension.social"),desc:a("extension.social_desc"),icon:(0,l.jsx)(L.Z,{size:20}),visible:!0,disable:!1},{value:B.Kp,title:a("extension.academic"),desc:a("extension.academic_desc"),icon:(0,l.jsx)(q.Od,{className:"w-5 h-5"}),visible:!0,disable:!1},{value:B.hs,title:a("extension.document"),desc:a("extension.document_desc"),icon:(0,l.jsx)(P.Z,{size:20}),visible:!0,disable:!1},{value:B.J5,title:a("extension.chat"),desc:a("extension.chat_desc"),icon:(0,l.jsx)(z.Z,{size:20}),visible:!1,disable:!1},{value:B.Ys,title:a("extension.chat"),desc:a("extension.chat_desc"),icon:(0,l.jsx)(z.Z,{size:20}),visible:!1,disable:!1}],K=[{value:B.zA,title:a("extension.xiaohongshu"),desc:s?a("extension.disable_to_topic"):a("extension.xiaohongshu_desc"),icon:(0,l.jsx)(M.Z,{size:20}),visible:!0,disable:!!s},{value:B.xn,title:a("extension.reddit"),desc:s?a("extension.disable_to_topic"):a("extension.reddit_desc"),icon:(0,l.jsx)(q.XQ,{className:"w-5 h-5"}),visible:!0,disable:!!s},{value:B.X7,title:a("extension.twitter"),desc:s?a("extension.disable_to_topic"):a("extension.twitter_desc"),icon:(0,l.jsx)(q.iB,{className:"w-5 h-5"}),visible:!0,disable:!!s}];(0,J.Eg)()&&(Q=Q.filter(e=>e.value!==B.hs),K=[]);let ee=[...Q,...K],et=e=>{let{setExtensionSelected:t,setExtensionError:s}=v.Z.getState();(0,V.ev)().then(l=>{(0,W.n4)(l,B.dP)>=0?e():(N(!1),t("google"),s(void 0,Y.e.AdvancedAssistantDisable))}).catch(e=>{N(!1),t("google"),s(void 0,Y.e.AdvancedAssistantDisable)})},es=async e=>{let{setExtensionError:t,setExtensionSelected:s}=v.Z.getState(),{searchErrorModalVisible:l,setSearchErrorModalVisible:a}=E.Z.getState();if(!tt.includes(e)){d(!1),l||t(void 0,"");return}if(!f){d(!1),s("google"),t(void 0,Y.e.AdvancedAssistantDisable),a(!0);return}Z(!0);let i=!1;switch(e){case B.zA:await (0,V.i9)().then(s=>{s?(i=!0,S()):et(()=>{let{extensionEnable:s}=v.Z.getState();s&&(i=!0,t(e,Y.e.LoginExpired))})});break;case B.xn:await new Promise(e=>{et(()=>{let{extensionEnable:t}=v.Z.getState();t&&(i=!0,S()),e(!0)})});break;case B.X7:await (0,V.lk)().then(s=>{let{extensionEnable:l}=v.Z.getState();s?(i=!0,S()):et(()=>{t(e,Y.e.LoginExpired),l&&(i=!0)})})}Z(!1),a(!i),d(!1),r.current=!1},el=async e=>{if(T(e),g&&p&&(e===B.zA||e===B.X7||e===B.xn)){H.Z.info(a("useInBrowser"));return}let{setExtensionSelected:t}=v.Z.getState();t(e),e!==B.Wh&&n.includes("/agents")&&i.push("/search")},ea=async e=>{h(!1);let t=await (0,ez.Y)(e.title),s=(0,eF.b)(t);i.push("/agents/".concat(s,"-").concat(e.short_id))};return(0,u.useEffect)(()=>{if(s){o&&d(!1);return}void 0!==f&&es(_)},[f,_]),(0,u.useEffect)(()=>{!j&&(n.includes("/agents")||el(Q[0].value))},[]),(0,u.useEffect)(()=>{(null==D?void 0:D.length)||(null==C?void 0:C.length)?$(!0):$(!1)},[D,C]),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(R.J2,{open:o,onOpenChange:d,children:[(0,l.jsx)(x.e,{delay:0,closeDelay:0,content:I?a("searchAddition.switch_search_mode_tip"):a("extension.search_range_desc"),classNames:{content:["text-white bg-gray-600 dark:bg-[#353535]"]},isDisabled:I,children:(0,l.jsx)("div",{className:"max-w-fit",children:(0,l.jsx)(R.xo,{asChild:!0,children:(0,l.jsxs)(A.A,{variant:"light",size:"sm",className:"text-inherit px-1.5 gap-1 text-sm",disabled:I,color:"default",isDisabled:I,children:[(0,l.jsx)("span",{className:"hidden lg:inline-block text-[12px] text-[#7F94B1] mr-2",children:a("extension.search_source")}),(0,l.jsx)("span",{className:"max-w-[150px] truncate",children:j?j.title:null===(t=ee.find(e=>e.value===_))||void 0===t?void 0:t.title}),o?(0,l.jsx)(U.Z,{className:"w-4 h-4"}):(0,l.jsx)(O.Z,{className:"w-4 h-4"})]})})})}),(0,l.jsx)(R.yk,{className:"w-auto p-0 rounded-xl shadow-lg",align:"start",children:(0,l.jsxs)("section",{className:"w-[40em] max-w-[90vw]",children:[(0,l.jsx)("h2",{className:"px-6 pt-4 text-xs font-semibold opacity-60",children:a("extension.search_range")}),(0,l.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-1 p-2 text-sm",children:ee.slice(0,(0,J.vU)()?Q.length:ee.length).map((e,t)=>{if(!e.visible)return;let s=e.disable;return(0,l.jsxs)("button",{className:(0,m.cn)("rounded-lg p-4 text-left",s?"text-gray-400":"hover:bg-content2 cursor-pointer",!s&&_===e.value&&"text-blue-500"),autoFocus:!s&&_===e.value,onClick:e.onClick?e.onClick:()=>{s||(j&&w(null),el(e.value))},children:[(0,l.jsxs)("span",{className:"flex items-center font-medium mb-1",children:[e.icon,(0,l.jsx)("span",{className:"ml-2",children:e.title}),e.isBeta&&(0,l.jsx)("span",{className:"ml-2 rounded text-gray-500 bg-gray-200 dark:bg-theme-bg-dark-300 px-2 py-0.5 text-xs",children:"Beta"})]}),(0,l.jsx)("span",{className:"opacity-50",children:e.desc})]},t)})})]})})]}),(0,l.jsx)(e8,{open:c,onOpenChange:h,onConfirm:ea})]})},tl=e=>{let{isDisalbedExtension:t}=e,s=(0,b.useTranslations)(),a=(0,v.Z)(e=>e.extensionSelected),i=[{value:B.gl,title:s("extension.all"),isDisabled:!1},{value:B.pN,title:s("extension.social"),isDisabled:!1},{value:B.zA,title:s("extension.xiaohongshu"),isDisabled:t},{value:B.xn,title:s("extension.reddit"),isDisabled:t},{value:B.X7,title:s("extension.twitter"),isDisabled:t},{value:B.Kp,title:s("extension.academic"),isDisabled:!1},{value:B.aI,title:s("extension.chat"),isDisabled:!1},{value:B.hs,title:s("extension.document"),isDisabled:!1}],n=(e,t)=>{e.preventDefault();let{setExtensionSelected:s}=v.Z.getState();s(t)};return(0,l.jsxs)("div",{className:"px-4 py-3 text-sm border-t border-[#dbe2e9] dark:border-zinc-700",children:[(0,l.jsxs)("span",{className:"mr-4",children:[s("extension.search_range"),":"]}),i.map(e=>(0,l.jsx)("a",{href:"",className:(0,C.Z)("mr-2",a===e.value?"text-blue-500":"text-zinc-400",e.isDisabled&&"cursor-not-allowed opacity-50"),onClick:t=>{if(e.isDisabled){t.preventDefault();return}n(t,e.value)},children:e.title},e.value))]})},ta=s(13263),ti=s(27585);let tn=(e,t)=>{let s=(0,ti.lx)(e);return Object.keys(t).forEach(e=>s.searchParams.append(e,t[e])),s.toString()};var tr=s(54259);let to=e=>{let{query:t}=e,s=(0,tr.a1)();return fetch(tn("".concat(_.XJ,"/official-website"),{query:t}),{method:"GET",headers:{Authorization:"".concat(s)}}).then(async e=>200!==e.status?Promise.reject([]):await e.json()).catch(e=>[])};var td=s(2240),tc=function(e){let{enable:t,value:s,debouncedValue:l,inputRef:a}=e;(0,b.useTranslations)();let[i,n]=(0,u.useState)([]),r=(0,td.Z)(),[o,d]=(0,u.useState)([]),[c,m]=(0,u.useState)(-1),h=o.length>0||i.length>0&&i[0],p=e=>{a.current&&(-1===e?a.current.value=s:a.current.value=x[e].title)};(0,u.useEffect)(()=>{var e,i;if(!s||!t||v.Z.getState().extensionSelected===B.aI||v.Z.getState().extensionSelected===B.J5||v.Z.getState().extensionSelected===B.Ys||(null===(e=e9.Z.getState().homeImages)||void 0===e?void 0:e.length)||(null===(i=e9.Z.getState().files)||void 0===i?void 0:i.length)){n([]);return}l&&to({query:s}).then(e=>{var t;(null===(t=a.current)||void 0===t?void 0:t.value)===s&&n(e)})},[l]),(0,u.useEffect)(()=>{var e,l;if(!s||!t||v.Z.getState().extensionSelected===B.aI||v.Z.getState().extensionSelected===B.J5||(null===(e=e9.Z.getState().files)||void 0===e?void 0:e.length)||v.Z.getState().extensionSelected===B.Ys||(null===(l=e9.Z.getState().homeImages)||void 0===l?void 0:l.length)){d([]);return}(0,ta.a5)({keywords:s}).then(e=>{var t;(null===(t=a.current)||void 0===t?void 0:t.value)===s&&d(e)}).catch(e=>{console.warn("getQuestion Error:",e)})},[l]),(0,u.useEffect)(()=>{m(-1)},[s]);let x=(0,u.useMemo)(()=>[{title:"traditionalSearch",type:"websearch"},...i.map(e=>({...e,type:"site"})),...o.map(e=>({title:e,type:"question"}))].splice(0,8),[o,i]);return{results:x,dropDownSelected:c,setDropDownSelected:m,showQueryDropdownMenu:h,reduceSearchResult:()=>{if(!r.current)return;let e=0;if(-1===c&&(e=x.length-1),c>-1&&(e=c-1),0===e){m(e);return}m(e),p(e)},addSearchResult:()=>{if(!r.current)return;let e=0;if(c===x.length-1&&(e=-1),c<x.length-1&&(e=c+1),0===e){m(e);return}m(e),p(e)}}},tu=s(52597),tm=s(65105),th=s(96156),tp=s(84706),tx=s(12490),tg=s(39496),tv=s(70262),tf=s(38058),tb=s(39109),t_=e=>{let{threadId:t}=e,s=(0,b.useTranslations)(),l=(0,tm.WI)(),a=(0,tb.Z)(),{setCurrentFileProgress:i,previousSearchCategory:n,setPreviousSearchCategory:r,setIsOpenFirstUseModal:o,isImageUploading:d,setIsImageUploading:c,homeImages:m,setHomeImages:h,setHomeImagesQustions:p,setNThUpload:x,removeHomeImageSById:g}=(0,e9.Z)(),f=(0,eh.ZP)(e=>e.isLogin),_=(0,tm.P2)(),j=(0,tm.Oi)("chatDocumentsUsage"),y=(0,u.useMemo)(()=>l?tv.sn:tv.w8,[l]),w=(0,u.useMemo)(()=>!1,[null==_?void 0:_.chatDocumentsUsage,j]),N=(0,u.useMemo)(()=>(null==m?void 0:m.length)>y,[y,null==m?void 0:m.length]),Z=()=>{let e=e9.Z.getState().homeImages,s=e9.Z.getState().threadImages;return t?(null==s?void 0:s.length)||0:(null==e?void 0:e.length)||0},S=()=>{let e=e9.Z.getState().homeImages,s=e9.Z.getState().threadImages;return Array.from(new Set([...(t?(null==e?void 0:e.filter(e=>(null==e?void 0:e.threadId)===t))||[]:(null==e?void 0:e.filter(e=>!(null==e?void 0:e.threadId)))||[]).map(e=>null==e?void 0:e.id),...(t&&(null==s?void 0:s.filter(e=>(null==e?void 0:e.threadId)===t))||[]).map(e=>null==e?void 0:e.id)]))},k=()=>{v.Z.getState().setExtensionSelected(n||B.gl),r(null)},C=e=>["image/jpeg","image/png","image/tiff","image/gif","image/webp"].includes(e.type)?e.size>26214400?(a.default(s("search_attached_image.size_limit_exceeded_tip",{size:25})),!1):!N||(a.default(s("search_attached_image.file_count_limit_exceeded_tip",{count:y})),!1):(a.default(s("search_attached_image.unsupported_image_type_tip")),!1),E=()=>{if(!d){if(!f){tp.$.publish("showLogin",void 0);return}if(w){tp.$.publish("showSubscriptionPlan",void 0);return}if(N){a.default(s("search_attached_image.file_count_limit_exceeded_tip",{count:y}));return}return!0}},D=e=>{var t;let s=null!==(t=e9.Z.getState().currentFileProgress)&&void 0!==t?t:0,l=setInterval(()=>{var t,a;let i=e9.Z.getState().homeImages;s=(null!==(a=null===(t=i.find(t=>t.id===e))||void 0===t?void 0:t.progress)&&void 0!==a?a:s)+(1.9*Math.random()+.1),h(i.map(t=>t.id===e?{...t,progress:Math.min(s,90),status:"analyzing"}:t)),s>=90&&clearInterval(l)},800);return l},T=async e=>{var l,n,r,d,u,m;if(!E())return;let f=null===(l=S())||void 0===l?void 0:l.length;if((null!==(n=null==e?void 0:e.length)&&void 0!==n?n:0)+f>y){a.default(s("search_attached_image.file_count_limit_exceeded_tip",{count:y}));return}x((null!==(r=e9.Z.getState().nThUpload)&&void 0!==r?r:0)+1);let b=Array.from(e);c(!0),v.Z.getState().setExtensionSelected(B.Ys);let _=[];for(let[e,s]of Array.from(b).entries()){_.push(e);let l=e9.Z.getState().homeImages,a=null!==(d=e9.Z.getState().nThUpload)&&void 0!==d?d:0,i=new FileReader,n="".concat(a,"_").concat(e),r=URL.createObjectURL(s),o=[{id:n,title:s.name,size:(0,tv.sS)(s.size),token:0,pages:0,progress:null!==(u=e9.Z.getState().currentFileProgress)&&void 0!==u?u:0,status:"uploading",type:s.type,created_at:new Date().toISOString(),modified_at:new Date().toISOString(),length:0,words:0,threadId:t||"",url:r,tempId:n}];console.log("reader",i,s),h([...o,...l])}let j=new Map;for(let[e,l]of Array.from(b).entries()){let n=null!==(m=e9.Z.getState().nThUpload)&&void 0!==m?m:0,r="".concat(n,"_").concat(e);c(!0),i(0),new FormData().append("file",l);let d="";if(!C(l)){c(!1),i(0);let e=e9.Z.getState().homeImages;h([...(0,tv._n)({files:e,tempId:r})]);continue}(0,X.fk)(G.U.CHAT_IMAGE,{fileName:l.name},!0),c(!0);let u=(0,tv.ct)(0,e=>{i(null!=e?e:0),h(e9.Z.getState().homeImages.map(t=>t.tempId===r?{...t,progress:e}:t))});"1"!==(0,tv.y6)()&&(o(!0),(0,tv.ny)());try{j.set(l.name,!0),await (0,eA.Vj)({file:l,threadId:t||"",onProgress:t=>{if(d||(d=t.file_id),!j.has(d)){var s;let t=null!==(s=e9.Z.getState().nThUpload)&&void 0!==s?s:0,a=e9.Z.getState().homeImages.map(s=>s.tempId==="".concat(t,"_").concat(e)?{...s,id:d}:s);h([...a]);let i=D(d);j.set(d,i),j.delete(l.name)}},onDone:async e=>{if(console.log("progress",e),u(),j.has(d),(null==e?void 0:e.status)==="SUCCESS"){let t=e9.Z.getState().homeImages,s=await (0,tf.S6)({id:d});c(!1),console.log("imageQustions",s),clearInterval(j.get(d)),j.delete(d),p([...s]),h(t.map(t=>t.id===d?{...t,progress:100,words:(null==e?void 0:e.words)||0,status:"completed"}:t));return}(null==e?void 0:e.status)==="PAGE_OVER_SIZE"?a.default(s("searchAddition.page_limit_exceeded_tip",{pages:"500"})):a.default(s("server.INTERNAL_SERVER_ERROR")),g([d]),c(!1),i(0)},onError:()=>{a.default(s("server.INTERNAL_SERVER_ERROR")),u(),j.delete(l.name),0===j.size&&c(!1),g([d])}})}catch(e){u(),a.default(s("server.INTERNAL_SERVER_ERROR")),c(!1),g([d]),i(0)}}Z()||(k(),i(0))};return{isInsufficientBalance:w,isFileCountLimitExceeded:N,isValidImageFile:C,simulateProgress:D,choiseFiles:e=>{var t;let{ref:s}=e;E()&&(null==s||null===(t=s.current)||void 0===t||t.click())},isValidPermission:E,fileInputChange:e=>{let{files:t}=e.target,s=v.Z.getState().extensionSelected;r(s===B.Ys?null:s),console.log("files",t),t&&T(t),e.target.value=""},uploadFiles:T}},tj=s(41223);let ty=(0,u.forwardRef)((e,t)=>{var s;let{isMini:a,threadId:i}=e,n=(0,b.useTranslations)(),r=(0,v.Z)(e=>e.loading),{isImageUploading:o,homeImages:d,isUploading:c,homeFiles:m}=(0,e9.Z)(),h=(0,tm.P2)(),p=(0,tm.Oi)("chatDocumentsUsage"),[g,f]=(0,u.useState)(!1),{choiseFiles:_,fileInputChange:j}=t_({threadId:i}),y=(0,u.useRef)(null);return(0,l.jsxs)(l.Fragment,{children:[(0,J.N0)()||(0,J.Eg)()?null:(0,l.jsxs)("div",{className:"max-w-fit relative z-20",children:[(0,l.jsx)("input",{type:"file",ref:y,className:"hidden",multiple:!1,accept:".jpg,.jpeg,.png,.tiff,.svg,.webp,.gif",onChange:j}),(0,l.jsx)(x.e,{delay:0,closeDelay:0,content:p?n("search_attached_image.add_image_tip"):n("search_attached_image.add_image_tip_free",{count:(null==h?void 0:null===(s=h.chatDocumentsUsage)||void 0===s?void 0:s.balance)||0}),classNames:{content:["text-white bg-gray-600 dark:bg-[#353535]"]},children:(0,l.jsx)(A.A,{variant:"light",size:"sm",className:(0,C.Z)("gap-1 mx-0 px-1","min-w-8","text-inherit"),isDisabled:o||c||r||(null==d?void 0:d.length)>0||(null==m?void 0:m.length)>0,startContent:(0,l.jsx)(tg.Z,{size:18}),onPress:()=>{if((0,tj.s2)()){f(!0);return}_({ref:y})},radius:a?"full":"sm"})})]}),(0,l.jsx)($.Vq,{open:g,onOpenChange:()=>{},children:(0,l.jsxs)($.cZ,{className:"w-2/3 rounded-lg overflow-hidden",hideCloseButton:!0,children:[(0,l.jsx)($.a7,{className:"text-gray-500 text-sm leading-6 text-center",children:(0,l.jsx)("p",{children:n("search_attached_image.to_app_use_image_search_tip")})}),(0,l.jsxs)("div",{className:"flex justify-center p-0 sm:flex-col border-t-1 border-gray-200 dark:border-[#27272A]",children:[(0,l.jsx)(A.A,{className:"w-1/2 rounded-none bg-transparent border-r-1 border-gray-200 dark:border-[#27272A]",onPress:()=>{f(!1)},children:n("search_attached_image.to_app_use_image_search_btn_cancel")}),(0,l.jsx)(A.A,{className:"w-1/2 rounded-none bg-transparent",color:"primary",variant:"light",onPress:()=>{(0,J.s)()?window.open("https://apps.apple.com/us/app/felo-search-the-world/id6598782546"):window.open("https://play.google.com/store/apps/details?id=ai.felo.search"),f(!1)},children:n("search_attached_image.to_app_use_image_search_btn")})]})]})})]})});ty.displayName="AddImage";var tw=s(51054),tN=s(72070),tZ=s.n(tN),tS=e=>{let{file:t}=e,{removeHomeImageSById:s}=(0,e9.Z)();return(0,l.jsxs)("div",{className:(0,C.Z)("relative group","items-center justify-between gap-1 text-xs  text-gray-500 rounded","p-0","border border-gray-100","hover:bg-[#EDFAFF] dark:hover:bg-[#3E536E]"),children:[(0,l.jsx)("div",{className:"flex items-center gap-1",children:(0,l.jsxs)("div",{className:"w-16 h-16 flex items-center justify-center relative",children:[(0,l.jsx)(tZ(),{className:(0,C.Z)("object-cover","rounded","!w-full !h-full"),src:t.url,alt:t.title,width:72,height:72}),(0,l.jsx)("div",{className:(0,C.Z)("absolute top-0 right-0","flex flex-col","w-full h-full","justify-center items-center","rounded","bg-gray-800/60","text-white text-xs",(null==t?void 0:t.status)!=="completed"?"flex":"hidden"),children:(null==t?void 0:t.status)=="error"?(0,l.jsx)(ef.Z,{className:"text-red-400"}):(null==t?void 0:t.progress)<=0?(0,l.jsx)(tw.Z,{size:"sm",classNames:{svg:"w-6 h-6",track:"stroke-white/80",label:"text-white"},"aria-label":"Loading..."}):(0,l.jsx)(tw.Z,{size:"sm",classNames:{svg:"w-6 h-6",track:"stroke-white/80",label:"text-white"},"aria-label":"Loading...",value:(null==t?void 0:t.progress)||0,showValueLabel:!0})})]})}),(null==t?void 0:t.status)==="completed"&&(0,l.jsx)("div",{className:(0,C.Z)("absolute -top-2 -right-2","group-hover:block"),children:(0,l.jsx)(A.A,{size:"sm",radius:"full",className:(0,C.Z)("p-0 m-0 h-4 w-4 min-w-0 min-h-0","border-0","bg-[#3D4C67] text-white/80","hover:bg-[#3D4C67] hover:opacity-100"),startContent:(0,l.jsx)(r.Z,{size:12,className:"rounded-full"}),onPress:()=>{s([null==t?void 0:t.id])}})})]})},tk=s(48518),tC=()=>{let e=(0,d.useRouter)(),t=(0,eQ.Z)(e=>e.template),s=(0,v.Z)(e=>e.isResearch),l=(0,v.Z)(e=>e.extensionSelected),a=(0,v.Z)(e=>e.proSelected),i=(0,u.useMemo)(()=>B.iu.find(e=>e===l)&&a,[l,a]);return{goToSearchDetailPage:l=>{var a,n,r;let{query:o,category:d,action:c}=l;if(!o&&!t)return;let u={query:o};if(i&&s||t){if((null==t?void 0:t.template_type)===ed.W.CUSTOM){tk.Z.getState().setTemplateData({templateQuery:o,template:t});let e=t.sub_topics[0].source_type;u.category=e,u.model=t.sub_topics[0].llm_model,e===B.RQ&&(u.topicId=t.sub_topics[0].source_id)}else{eQ.Z.getState().openAgentPlanModal(o);return}}if(!o)return;let m=(null===(a=e9.Z.getState().homeFiles)||void 0===a?void 0:a.filter(e=>!(null==e?void 0:e.threadId)))||[],p=null==m?void 0:m.filter(e=>(null==e?void 0:e.status)==="completed"),x=e9.Z.getState().homeImages||[],g=null==x?void 0:x.filter(e=>(null==e?void 0:e.status)==="completed");d===B.J5?(u.category=B.J5,u.documents=null==p?void 0:null===(n=p.map(e=>null==e?void 0:e.id))||void 0===n?void 0:n.join(",")):(u.category=B.Ys,u.documents=null==g?void 0:null===(r=g.map(e=>null==e?void 0:e.id))||void 0===r?void 0:r.join(",")),c&&(u.documentAction=c);let v=(0,h.M)(u);e.push(v,void 0,{scroll:!0})}}},tE=()=>{var e;let t=(0,b.useTranslations)(),{homeImages:s,homeImageSQustions:a,setIsGoToSearch:i,isGoToSearch:n}=(0,e9.Z)(),{goToSearchDetailPage:r}=tC(),{isOpenThreadModal:o,closeThreadModal:d}=(0,E.Z)(),{extensionSelected:c}=(0,v.Z)(),m=(0,v.Z)(e=>e.isResearch),h=e=>{let{query:t,action:s}=e;i(!0),!0===o&&d(),r({query:t,action:s})};return((0,u.useCallback)(()=>{i(!1)},[]),0===s.length)?null:(0,l.jsxs)("div",{className:(0,C.Z)("px-0 pb-4 mx-3","flex flex-wrap gap-2 items-end","border-b border-[#dbe2e9]/60 dark:border-zinc-700"," bg-white dark:bg-[#20232a]"),children:[s.map(e=>(0,l.jsx)(tS,{file:e},e.id)),c===B.Ys&&!m&&(null===(e=s.filter(e=>"completed"===e.status))||void 0===e?void 0:e.length)?(0,l.jsxs)("div",{className:"flex items-center gap-2 ml-2",children:[(0,l.jsx)(A.A,{color:"secondary",size:"sm",className:(0,C.Z)("px-1 py-1.5 min-h-0 h-auto text-[#596B87]","dark:bg-gray-700 dark:text-white/90"),onPress:()=>h({query:t(tv.Tp.answer),action:"explain"}),isDisabled:n,children:t(tv.Tp.answer)},"answer"),a.map(e=>(0,l.jsx)(A.A,{color:"secondary",size:"sm",className:(0,C.Z)("px-1 py-1.5 min-h-0 h-auto text-[#596B87]","dark:bg-gray-700 dark:text-white/90"),onPress:()=>h({query:t(tv.Tp[e.type]),action:e.type}),isDisabled:n,children:t(tv.Tp[e.type])},e.type))]}):null]})},tD=s(64412),tT=e=>{var t;let{file:s}=e,a=(0,b.useTranslations)(),{removeHomeFilesById:i}=(0,e9.Z)();return(0,l.jsxs)("div",{className:(0,C.Z)("relative group","items-center justify-between gap-1 text-xs  text-gray-500 rounded","p-0","bg-gray-50 dark:bg-gray-700"),children:[(0,l.jsx)("div",{className:"flex items-center",children:(0,l.jsxs)("div",{className:"max-w-52 flex items-center justify-start relative p-2 ",children:[(0,l.jsx)("div",{className:"w-5",children:(0,l.jsx)(tD.Z,{fileName:s.title,w:5,h:5})}),(0,l.jsxs)("div",{className:"ml-2",children:[(0,l.jsx)("div",{className:"text-sm truncate w-36 dark:text-white/90",children:s.title}),(0,l.jsxs)("div",{className:"text-[12px] text-gray-400 ",children:[(null==s?void 0:s.type)?"".concat(null===tv.Sj||void 0===tv.Sj?void 0:null===(t=tv.Sj[s.type])||void 0===t?void 0:t.toLocaleUpperCase()," / "):"",(0,tv.cn)(s.size)," ",(null==s?void 0:s.pages)?"/ ".concat(a("searchAddition.file_pages",{pages:s.pages})):""]})]}),(0,l.jsx)("div",{className:(0,C.Z)("absolute top-0 right-0","flex flex-col","w-full h-full","justify-center items-center","rounded","bg-gray-800/60","text-white text-xs",(null==s?void 0:s.status)!=="completed"?"flex":"hidden"),children:(null==s?void 0:s.status)=="error"?(0,l.jsx)(ef.Z,{className:"text-red-400"}):(null==s?void 0:s.progress)<=0?(0,l.jsx)(tw.Z,{size:"sm",classNames:{svg:"w-6 h-6",track:"stroke-white/80",label:"text-white"},"aria-label":"Loading..."}):(0,l.jsx)(tw.Z,{size:"sm",classNames:{svg:"w-6 h-6",track:"stroke-white/80",label:"text-white"},"aria-label":"Loading...",value:(null==s?void 0:s.progress)||0,showValueLabel:!0})})]})}),(null==s?void 0:s.status)==="completed"&&(0,l.jsx)("div",{className:(0,C.Z)("absolute -top-2 -right-2","group-hover:block"),children:(0,l.jsx)(A.A,{size:"sm",radius:"full",className:(0,C.Z)("p-0 m-0 h-4 w-4 min-w-0 min-h-0","border-0","bg-[#3D4C67] text-white/80","hover:bg-[#3D4C67] hover:opacity-100"),startContent:(0,l.jsx)(r.Z,{size:12,className:"rounded-full"}),onPress:()=>{i([null==s?void 0:s.id])}})})]})},tI=()=>{var e;let t=(0,b.useTranslations)(),{homeFiles:s,setIsGoToSearch:a,isGoToSearch:i,isUploading:n}=(0,e9.Z)(),{goToSearchDetailPage:r}=tC(),{isOpenThreadModal:o,closeThreadModal:d}=(0,E.Z)(),{extensionSelected:c}=(0,v.Z)(),m=(0,v.Z)(e=>e.isResearch),h=(0,eQ.Z)(e=>e.template),p=e=>{let{query:t}=e;a(!0),!0===o&&d(),r({query:t,category:B.J5,action:"summary"})};return((0,u.useEffect)(()=>{a(!1)},[]),0===s.length)?null:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:(0,C.Z)("px-0 pt-2 pb-4 mx-3","flex flex-nowrap gap-3 items-end w-[calc(100%-30px)] overflow-x-auto"," bg-white dark:bg-[#20232a] ","scrollbar"),children:[s.map(e=>(0,l.jsx)(tT,{file:e},e.id)),c===B.J5&&(null==h?void 0:h.template_type)!==ed.W.DIRECT_DUTY&&!m&&(null===(e=s.filter(e=>"completed"===e.status))||void 0===e?void 0:e.length)>0&&(0,l.jsx)("div",{className:"flex items-center gap-2 ml-2",children:(0,l.jsx)(A.A,{color:"secondary",size:"sm",className:(0,C.Z)("px-1 py-1.5 min-h-0 h-auto text-[#596B87]","dark:bg-gray-700 dark:text-white/90"),onPress:()=>p({query:t("searchAddition.summary_file")}),isDisabled:i||n,children:t("searchAddition.summary_file")},"answer")})]}),(0,l.jsx)("hr",{className:(0,C.Z)("mt-0 mx-3 border-0","h-[1px] overflow-hidden","bg-[#dbe2e9]/60 dark:bg-zinc-700")})]})},tA=s(26894),tR=s(88708),tz=s(31510),tF=s(13366),tL=s(83737),tP=()=>{let{isDark:e}=(0,j.Z)(),[t,s]=(0,u.useState)(!0),a=(0,eh.ZP)(e=>e.userInfo),i=(0,v.Z)(e=>e.setProSelected),n=(0,eQ.Z)(e=>e.template),r=(0,b.useTranslations)(),d=[{target:"#proSelect",content:r("step.pro_search_power"),disableBeacon:!0,disableOverlayClose:!0,disableOverlay:!0,placement:"left",offset:-8},{target:"#modelSelect",content:r("step.select_advanced_models"),disableBeacon:!0,disableOverlayClose:!0,disableOverlay:!0,placement:"top",offset:-8},{target:"#mode-discovery",content:r("step.help_deep_answer"),disableBeacon:!0,disableOverlayClose:!0,disableOverlay:!0,placement:"top",offset:-8}];return(0,l.jsx)(tL.ZP,{steps:d,run:t,continuous:!0,showProgress:!0,disableOverlayClose:!0,hideCloseButton:!0,spotlightClicks:!0,disableOverlay:!0,showSkipButton:!1,tooltipComponent:e=>{let{continuous:t,index:s,step:a,primaryProps:i,tooltipProps:d,size:c}=e;return(0,l.jsxs)("div",{...d,className:"max-w-[300px] flex p-2 flex-col bg-white dark:bg-[#434955] rounded-lg",children:[(0,l.jsxs)("div",{className:"flex",children:[(0,l.jsx)(tu.SV,{className:"w-5 h-5 mr-2"}),(0,l.jsx)("div",{className:"mb-2 text-sm dark:text-white",children:a.content})]}),(0,l.jsx)("div",{className:"flex justify-end",children:(0,l.jsxs)("div",{...i,className:"text-[#0080ff] text-sm flex items-center",onMouseDown:e=>{i.onClick&&i.onClick(e)},children:[s===(n?c-2:c-1)?r("step.complete"):r("enterprise.create_next_step"),s!==(n?c-2:c-1)&&(0,l.jsx)(o.Z,{className:"w-4 h-4 ml-2 text-black dark:text-white"})]})})]})},floaterProps:{offset:-10,styles:{arrow:{length:8,spread:8,color:e?"#434955":"#fff"}}},styles:{options:{arrowColor:"#fff",backgroundColor:"#fff",overlayColor:"transparent",primaryColor:"#0080ff",textColor:"#333",zIndex:-70,width:"auto"},tooltipContainer:{padding:"0px"},tooltipContent:{padding:"0px"},tooltip:{borderRadius:"8px",padding:"0px"},buttonBack:{display:"none"},buttonSkip:{color:"#666",fontSize:"14px",cursor:"default",pointerEvents:"none",marginRight:"10px"}},callback:e=>{let{action:t,index:l,size:n,status:r,type:o}=e;if("step:after"===o&&"next"===t)switch(l){case 0:i(!0);break;case 1:case 2:localStorage.setItem(B.VB+a.email,"true")}("finished"===r||"skipped"===r)&&s(!1)}})},tM=s(26949),tU=e=>{let{value:t,label:s,icon:a}=e;return(0,l.jsxs)(tM.SP,{value:t,className:(0,C.Z)("gap-1 px-2","rounded-full text-xs h-6 font-normal","data-[state=active]:bg-background data-[state=active]:shadow-none data-[state=active]:text-primary data-[state=active]:bg-[#EDFBFF]","dark:data-[state=active]:bg-[#29374C]"),children:[a,s]})},tO=s(20724),tB=s(94032),tV=s(25568),tY=s(98692),tq=s(78236),tW=e=>{var t;let{file:s}=e,a=(0,b.useTranslations)(),{removeHomeFilesById:i}=(0,tq.Z)();return(0,l.jsxs)("div",{className:(0,C.Z)("relative group","items-center justify-between gap-1 text-xs  text-gray-500 rounded","p-0","bg-[#F7F7F9] dark:bg-[#374251]"),children:[(0,l.jsx)("div",{className:"flex items-center",children:(0,l.jsxs)("div",{className:"max-w-52 flex items-center justify-start relative p-2 h-14",children:[(0,l.jsx)("div",{className:"w-5",children:(0,l.jsx)(tD.Z,{fileName:s.title,w:5,h:5})}),(0,l.jsxs)("div",{className:"ml-2",children:[(0,l.jsx)("div",{className:(0,C.Z)("text-sm truncate dark:text-white/90","sm:w-36 w-20"),children:s.title}),(0,l.jsxs)("div",{className:"text-[12px] text-gray-400 ",children:[(null==s?void 0:s.type)?"".concat(null===tv.Sj||void 0===tv.Sj?void 0:null===(t=tv.Sj[s.type])||void 0===t?void 0:t.toLocaleUpperCase()," / "):"",(0,tv.cn)(s.size)," ",(null==s?void 0:s.pages)?"/ ".concat(a("searchAddition.file_pages",{pages:s.pages})):""]})]}),(0,l.jsx)("div",{className:(0,C.Z)("absolute top-0 right-0","flex flex-col","w-full h-full","justify-center items-center","rounded","bg-gray-800/60","text-white text-xs",(null==s?void 0:s.status)!=="completed"?"flex":"hidden"),children:(null==s?void 0:s.status)=="error"?(0,l.jsx)(ef.Z,{className:"text-red-400"}):(null==s?void 0:s.progress)<=0?(0,l.jsx)(tw.Z,{size:"sm",classNames:{svg:"w-6 h-6",track:"stroke-white/80",label:"text-white"},"aria-label":"Loading..."}):(0,l.jsx)(tw.Z,{size:"sm",classNames:{svg:"w-6 h-6",track:"stroke-white/80",label:"text-white"},"aria-label":"Loading...",value:(null==s?void 0:s.progress)||0,showValueLabel:!0})})]})}),(null==s?void 0:s.status)==="completed"&&(0,l.jsx)("div",{className:(0,C.Z)("absolute -top-2 -right-2","group-hover:block"),children:(0,l.jsx)(A.A,{size:"sm",radius:"full",className:(0,C.Z)("p-0 m-0 h-4 w-4 min-w-0 min-h-0","border-0","bg-[#3D4C67] text-white/80","hover:bg-[#3D4C67] hover:opacity-100"),startContent:(0,l.jsx)(r.Z,{size:12,className:"rounded-full"}),onPress:()=>{i([null==s?void 0:s.id])}})})]})},tJ=()=>{let e=(0,tq.Z)(e=>e.homeFiles);return 0===e.length?null:(0,l.jsx)(l.Fragment,{children:(0,l.jsx)("div",{className:(0,C.Z)("p-0 m-0 pt-2"," relative z-10","flex flex-nowrap gap-3 items-end w-[calc(100%-30px)] overflow-x-auto"," bg-white dark:bg-[#20232a] ","scrollbar"),children:e.map(e=>(0,l.jsx)(tW,{file:e},e.id))})})};let tX=e=>{let{type:t="home",threadId:s}=e,l=(0,b.useTranslations)(),a=(0,tb.Z)(),i=(0,tm.WI)(),n=(0,tm.P2)(),r=(0,tm.Oi)("chatDocumentsUsage"),{homeFiles:o,files:d,threadFiles:c,setHomeFiles:m,setFiles:h,setIsUploading:p,setCurrentFileProgress:x,setNThUpload:g}=(0,tq.Z)(),v=()=>"home"===t?tq.Z.getState().homeFiles:tq.Z.getState().files,f=(0,u.useMemo)(()=>r?tv.Mr:tv.CD,[r]),_=(0,u.useMemo)(()=>{if(!r){var e,t;return(null!==(t=null==n?void 0:null===(e=n.chatDocumentsUsage)||void 0===e?void 0:e.balance)&&void 0!==t?t:0)<=0}return!1},[null==n?void 0:n.chatDocumentsUsage,r]),j=()=>{var e,s;return"home"===t?(null===(e=tq.Z.getState().homeFiles)||void 0===e?void 0:e.length)||0:(null===(s=tq.Z.getState().files)||void 0===s?void 0:s.length)||0},y=e=>{let{type:t}=e,l="home"===t?tq.Z.getState().homeFiles:tq.Z.getState().files,a=tq.Z.getState().threadFiles;return Array.from(new Set([...(s?(null==l?void 0:l.filter(e=>(null==e?void 0:e.threadId)===s))||[]:(null==l?void 0:l.filter(e=>!(null==e?void 0:e.threadId)))||[]).map(e=>null==e?void 0:e.id),...(s&&(null==a?void 0:a.filter(e=>(null==e?void 0:e.threadId)===s))||[]).map(e=>null==e?void 0:e.id)]))},w=(0,u.useMemo)(()=>{var e;return(null===(e=y({type:t}))||void 0===e?void 0:e.length)>f},[f]),N=(0,u.useMemo)(()=>i?tv.fc:tv.r0,[i]),Z=(0,u.useMemo)(()=>{let e="home"===t?o||[]:d||[],l=s&&(null==c?void 0:c.filter(e=>(null==e?void 0:e.threadId)===s))||[];return Array.from(new Set([...e,...l].map(e=>e.id))).map(t=>[...e,...l].find(e=>e.id===t)).reduce((e,t)=>{var s;return e+(null!==(s=null==t?void 0:t.words)&&void 0!==s?s:0)},0)>N},[t,o,d,s,c,N]),S=(0,u.useMemo)(()=>i?l("searchAddition.max_words"):l("searchAddition.max_words_free"),[i]),k=e=>["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","text/plain"].includes(e.type)?e.size>26214400?(a.default(l("searchAddition.size_limit_exceeded_tip",{size:25,pages:500})),!1):Z?(a.default(l("searchAddition.thread_words_limit_exceeded_tip",{words:S})),!1):!w||(i||tp.$.publish("showSubscriptionPlan",void 0),a.default(l("searchAddition.thread_upload_limit_exceeded_tip",{count:f})),!1):(a.default(l("topic.error_file_type_not_supported")),!1),C=e=>{var s;let l=null!==(s=tq.Z.getState().currentFileProgress)&&void 0!==s?s:0,a=setInterval(()=>{var s,i;let n=v();l=(null!==(i=null===(s=n.find(t=>t.id===e))||void 0===s?void 0:s.progress)&&void 0!==i?i:l)+(1.9*Math.random()+.1),"home"===t?m(n.map(t=>t.id===e?{...t,progress:Math.min(l,95),status:"analyzing"}:t)):h(n.map(t=>t.id===e?{...t,progress:Math.min(l,95),status:"analyzing"}:t)),l>=95&&clearInterval(a)},800);return a};return{handleFiles:async e=>{var n,r,o,d,c;if(tq.Z.getState().isUploading)return;if(_){a.default(l("searchAddition.upload_limit_exceeded_tip")),tp.$.publish("showSubscriptionPlan",void 0);return}if(w)return;let u=null===(n=y({type:t}))||void 0===n?void 0:n.length;if((null!==(r=null==e?void 0:e.length)&&void 0!==r?r:0)+u>f){if(!i){tp.$.publish("showSubscriptionPlan",void 0);return}a.default(l("searchAddition.thread_upload_limit_exceeded_tip",{count:f}));return}g((null!==(o=tq.Z.getState().nThUpload)&&void 0!==o?o:0)+1);let b=Array.from(e);for(let[e,l]of(p(!0),Array.from(b).entries())){let a=v(),i=null!==(d=tq.Z.getState().nThUpload)&&void 0!==d?d:0,n="".concat(i,"_").concat(e),r=[{id:n,title:l.name,size:(0,tv.sS)(l.size),token:0,pages:0,progress:0,status:"uploading",type:l.type,created_at:new Date().toISOString(),modified_at:new Date().toISOString(),length:0,words:0,threadId:s||"",tempId:n}];"home"===t&&m([...r,...a])}let E=new Map;for(let[e,n]of Array.from(b).entries()){let r=null!==(c=tq.Z.getState().nThUpload)&&void 0!==c?c:0,o="".concat(r,"_").concat(e);p(!0),x(0);try{if(await (0,tf.Wl)()){if(i?a.default(l("searchAddition.upload_limit_exceeded_tip")):tp.$.publish("showSubscriptionPlan",void 0),p(!1),x(0),"home"===t){let e=v();m((0,tv._n)({files:e,tempId:o}))}continue}}catch(e){if(a.default(l("server.INTERNAL_SERVER_ERROR")),p(!1),x(0),"home"===t){let e=v();m((0,tv._n)({files:e,tempId:o}))}continue}let d="";if(!k(n)){if("home"===t){let e=v();m((0,tv._n)({files:e,tempId:o}))}p(!1),x(0);continue}(0,X.fk)(G.U.SEAECH_FILE,{fileName:n.name},!0),p(!0);let u=(0,tv.ct)(0,e=>{if(x(null!=e?e:0),"home"===t){let t=v();m((0,tv._n)({files:t,tempId:o})),m(t.map(t=>t.tempId===o?{...t,progress:e}:t))}});"1"!==(0,tv.y6)()&&(0,tv.ny)();try{E.set(n.name,!0),await (0,eA.Vj)({file:n,threadId:s||"",onProgress:l=>{if(d||(d=l.file_id),!E.has(d)){var a,i;let r=null!==(a=tq.Z.getState().nThUpload)&&void 0!==a?a:0,o=v(),c="home"===t?o.map(t=>t.tempId==="".concat(r,"_").concat(e)?{...t,id:d}:t):[{id:d,title:n.name,size:(0,tv.sS)(n.size),token:0,pages:0,progress:null!==(i=tq.Z.getState().currentFileProgress)&&void 0!==i?i:0,status:"uploading",type:n.type,created_at:new Date().toISOString(),modified_at:new Date().toISOString(),length:(null==l?void 0:l.length)||0,words:(null==l?void 0:l.words)||0,threadId:s||""}];"home"===t?m([...c]):h([...c,...o]);let u=C(d);E.set(d,u),E.delete(n.name)}},onDone:e=>{if(u(),E.has(d)&&(clearInterval(E.get(d)),E.delete(d)),(null==e?void 0:e.status)==="SUCCESS"){var s,i;null===(s=tm.ZP.getState())||void 0===s||s.reduceSubscriptioUsageTimes({featureName:"chatDocumentsUsage"});let n=v(),r=n.reduce((e,t)=>{var s;return e+(null!==(s=null==t?void 0:t.words)&&void 0!==s?s:0)},0);if(Z||r+(null!==(i=null==e?void 0:e.words)&&void 0!==i?i:0)>N){if(a.default(l("searchAddition.thread_words_limit_exceeded_tip",{words:S})),"home"===t){let e=v();m((0,tv.mF)({files:e,id:d}))}else h([...(0,tv.mF)({files:n,id:d})]);p(!1);return}"home"===t?m(n.map(t=>t.id===d?{...t,progress:100,words:(null==e?void 0:e.words)||0,pages:(null==e?void 0:e.page_count)||0,status:"completed"}:t)):h(n.map(t=>t.id===d?{...t,progress:100,words:(null==e?void 0:e.words)||0,pages:(null==e?void 0:e.page_count)||0,status:"completed"}:t)),p(!1);return}(null==e?void 0:e.status)==="PAGE_OVER_SIZE"?a.default(l("searchAddition.page_limit_exceeded_tip",{pages:"500"})):a.default(l("server.INTERNAL_SERVER_ERROR"));let n=v();"home"===t?m((0,tv.mF)({files:n,id:d})):h([...(0,tv.mF)({files:n,id:d})]),p(!1),x(0)},onError:()=>{a.default(l("server.INTERNAL_SERVER_ERROR")),u(),E.delete(n.name),0===E.size&&p(!1);let e=v();"home"===t?m((0,tv.mF)({files:e,id:d})):h([...(0,tv.mF)({files:e,id:d})]),x(0)}})}catch(s){u(),a.default(l("server.INTERNAL_SERVER_ERROR")),p(!1),x(0);let e=v();"home"===t?m((0,tv.mF)({files:e,id:d})):h([...(0,tv.mF)({files:e,id:d})])}}j()||x(0)},validateFile:k,currentFilesList:v,isInsufficientBalance:_,isDraggingDisabled:w,MAX_FILE_COUNT:f,isLimitExceeded:Z}},tG=(0,u.forwardRef)((e,t)=>{let{value:s,threadId:a,type:i="home",hiddenButton:n}=e,r=(0,b.useTranslations)(),o=(0,tm.WI)(),d=(0,tb.Z)(),{homeFiles:c}=(0,tq.Z)(),m=(0,eh.ZP)(e=>e.isLogin),[h,x]=(0,u.useState)(!1),[g,v]=(0,u.useState)(!1),f=(0,u.useRef)(null),{handleFiles:_,isInsufficientBalance:j,isDraggingDisabled:y,MAX_FILE_COUNT:w}=tX({type:i,threadId:a});return(0,u.useImperativeHandle)(t,()=>({handleFiles:_})),(0,l.jsx)(tM.nU,{value:s,children:(0,l.jsxs)("div",{className:"ml-3 flex gap-3",children:[!n&&(0,l.jsxs)("div",{className:"max-w-fit relative pt-2",children:[(0,l.jsx)("input",{type:"file",ref:f,className:"hidden",multiple:!0,accept:".pdf,.doc,.docx,.txt",onChange:e=>{let{files:t}=e.target;t&&_(t),e.target.value=""}}),(0,l.jsxs)(p.z,{variant:"secondary",size:"lg",className:(0,C.Z)("sm:px-6 px-3",(null==c?void 0:c.length)?"h-14":"h-10","bg-[#F7F7F9] dark:bg-[#374251]"),onClick:e=>{var t;if(e.preventDefault(),(0,tj.s2)()){v(!0);return}if(!m){E.Z.getState().setLoginModalVisible(!0);return}if(j){tp.$.publish("showSubscriptionPlan",void 0);return}if(y){o||tp.$.publish("showSubscriptionPlan",void 0),d.default(r("searchAddition.thread_upload_limit_exceeded_tip",{count:w}));return}null===(t=f.current)||void 0===t||t.click()},children:[(0,l.jsx)(tY.Z,{}),r("agentConfig.add_file")]})]}),(0,l.jsx)(tJ,{})]})})});var tH=e=>{var t,s;let{topTabType:a,setTopTabType:i}=e,n=(0,b.useTranslations)(),r=(0,eQ.Z)(e=>e.template),o=(0,eQ.Z)(e=>e.setCategory),d=(0,u.useRef)(null),c=(0,u.useMemo)(()=>{var e,t;return(null==r?void 0:null===(t=r.tool_config)||void 0===t?void 0:null===(e=t.top_bar)||void 0===e?void 0:e.top_bar_list)||[]},[null==r?void 0:null===(s=r.tool_config)||void 0===s?void 0:null===(t=s.top_bar)||void 0===t?void 0:t.top_bar_list]),m=(0,u.useCallback)(e=>c.find(t=>t.type===e),[c]);return(0,u.useEffect)(()=>{o(a)},[a]),(0,l.jsxs)(tM.mQ,{value:a,onValueChange:e=>{console.log("onValueChange",e),i(e),o(e)},children:[(0,l.jsx)("div",{className:"group -mx-3 -mt-5 flex justify-between items-center rounded-t-xl  pt-2 pb-0  border-b-1 border-[#EBEEF3] dark:border-[#333B4D]/60",children:(0,l.jsx)("div",{className:(0,C.Z)("w-full flex items-center text-sm text-gray-400 overflow-hidden gap-2","overflow-x-auto scrollbar"),children:(0,l.jsxs)(tM.dr,{className:"bg-transparent gap-2 relative z-0",children:[m(B.gl)?(0,l.jsx)("div",{onClick:()=>i(B.gl),children:(0,l.jsx)(tU,{value:B.gl,label:n("agentConfig.ask_anything"),icon:(0,l.jsx)(tO.Z,{className:"w-4"})})}):null,m(B.J5)?(0,l.jsx)("div",{onClick:()=>i(B.J5),children:(0,l.jsx)(tU,{value:B.J5,label:n("agentConfig.upload_file"),icon:(0,l.jsx)(tV.nr,{className:(0,C.Z)("w-4")})})}):null,m("long_text")?(0,l.jsx)("div",{onClick:()=>i("long_text"),children:(0,l.jsx)(tU,{value:"long_text",label:n("agentConfig.long_text"),icon:(0,l.jsx)(P.Z,{className:"w-4"})})}):null,m(B.V9)?(0,l.jsx)("div",{onClick:()=>i(B.V9),children:(0,l.jsx)(tU,{value:B.V9,label:n("agentConfig.webpage"),icon:(0,l.jsx)(S.Z,{className:"w-4"})})}):null,m(B.rN)?(0,l.jsxs)("div",{onClick:()=>i(B.rN),children:[(0,l.jsx)(tU,{value:B.rN,label:n("agentConfig.youtube"),icon:(0,l.jsx)(tB.Z,{className:"w-5"})})," "]}):null]})})}),(0,l.jsx)(tG,{value:B.J5}),(0,l.jsx)(tG,{value:B.SH,hiddenButton:!0,ref:d})]})},t$=s(32700);let tQ=e=>(/^https?:\/\//i.test(e)||(e="https://"+e),e);var tK=u.memo(e=>{var t,s,c,w,N;let{className:Z,autoFocus:S,query:k,mode:C="default",isModal:T=!1,isFresh:A=!1,topicId:R,isMyTopic:z,onModeBarChange:F,needLogin:L=!1}=e,P=(0,b.useTranslations)(),M=(0,d.useRouter)(),U="default"===C,{proUsageQuota:O}=(0,t$.I)(),{isDark:V}=(0,j.Z)(),{isMobile:Y}=(0,y.Z)(),{homeFiles:q,isUploading:$,isImageUploading:Q,homeImages:K,setHomeFiles:ee}=(0,e9.Z)(),et=(0,tm.Oi)("chatDocumentsUsage"),{homeFiles:es,isUploading:el,setHomeFiles:ea}=(0,tq.Z)(),ei=(0,v.Z)(e=>e.searchValue),en=(0,v.Z)(e=>e.setSearchValue),{handleFiles:er}=tX({type:"home",threadId:""}),[eo]=function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{leading:!1},[l,a]=(0,u.useState)(e),i=(0,u.useRef)(!1),n=(0,u.useRef)(null),r=(0,u.useRef)(!1),o=()=>window.clearTimeout(n.current);return(0,u.useEffect)(()=>{i.current&&(!r.current&&s.leading?(r.current=!0,a(e)):(o(),n.current=window.setTimeout(()=>{r.current=!1,a(e)},t)))},[e,s.leading,t]),(0,u.useEffect)(()=>(i.current=!0,o),[]),[l,o]}(ei,200),[ec,eu]=(0,u.useState)(!0),[em,ep]=(0,u.useState)(!1),[ex,eg]=(0,u.useState)(!1),ev=(0,u.useRef)(null),ef=(0,u.useRef)(null),eb=(0,u.useRef)(0),e_=(0,u.useRef)(null),{language:ej,setLanguage:ey}=(0,tF.Z)(),ew=(0,v.Z)(e=>e.isBeginAnswer),{uploadFiles:eN}=t_({}),eZ=e=>{var t,s;"/"!==e.key&&""!==e.key||["INPUT","TEXTAREA"].includes((null===(t=document.activeElement)||void 0===t?void 0:t.tagName)||"")||document.activeElement instanceof HTMLElement&&document.activeElement.isContentEditable||(e.preventDefault(),null===(s=ef.current)||void 0===s||s.focus(),ep(!0))};(0,u.useEffect)(()=>T?T?(document.addEventListener("keydown",eZ),()=>document.removeEventListener("keydown",eZ)):void 0:(window.addEventListener("keydown",eZ),()=>window.removeEventListener("keydown",eZ)),[T]),(0,u.useEffect)(()=>{let e=e=>{var t;!e.target||(null===(t=ev.current)||void 0===t?void 0:t.contains(e.target))||ep(!1)};return window.addEventListener("mousedown",e),()=>{window.removeEventListener("mousedown",e)}},[]);let eS=(0,eh.ZP)(e=>e.isLogin),ek=(0,v.Z)(e=>e.loading),eC=(0,v.Z)(e=>e.setLoading),eE=(0,v.Z)(e=>e.startSearch),eD=(0,v.Z)(e=>e.extensionSelected),eT=(0,v.Z)(e=>e.proSelected),eI=(0,v.Z)(e=>e.isDiscovery),eA=(0,v.Z)(e=>e.isResearch),eR=(0,v.Z)(e=>e.setIsDiscovery),ez=(0,v.Z)(e=>e.setIsResearch),eF=(0,eQ.Z)(e=>e.template),eL=(0,u.useMemo)(()=>{var e,t;return(null==eF?void 0:null===(t=eF.tool_config)||void 0===t?void 0:null===(e=t.top_bar)||void 0===e?void 0:e.top_bar_list)||[]},[null==eF?void 0:null===(t=eF.toolsConfig)||void 0===t?void 0:t.topBar]),[eM,eU]=(0,u.useState)((null===(s=eL.find(e=>e.defaultSelected))||void 0===s?void 0:s.type)||"google"),{selectModelValueList:eO}=(0,tz.Z)(),eB=(0,tb.Z)(),{isOpenThreadModal:eV,closeThreadModal:eY}=(0,E.Z)(),[eW,eJ]=(0,u.useState)(!1),eX=(0,eh.ZP)(e=>e.userInfo),[eG,eH]=(0,u.useState)(!1),e$=(0,tm.WI)(),eK=(0,eQ.Z)(e=>e.category),{isTopicSearchNetwork:e0,isFreshSearch:e1,setIsFreshSearch:e2,setIsTopicReply:e5,isTopicReply:e4,setWillBindTopicId:e3,isSingleAgentCanUse:e6,isFirstDeepCoerceR1:e7,setIsFirstDeepCoerceR1:e8,setSelectedModel:te,setIsShowDeepTooltip:tt,selectedModel:ta}=(0,v.Z)();(0,u.useEffect)(()=>{!localStorage.getItem(B.VB+eX.email)&&eS&&eX.email&&!T&&(!eF||(null==eF?void 0:eF.template_type)!==ed.W.CUSTOM)&&(!eS||!eX.email||e$||eX.chat_model||eT||(0,J.N0)()?(localStorage.setItem(B.VB+eX.email,"true"),eH(!1)):(console.log("novice_guide"),eH(!0)))},[eS,eX]),(0,u.useEffect)(()=>{R?(e3(R),eQ.Z.getState().clearTemplate(),e5(!0)):(e3(""),e5(!1))},[R]);let ti=(0,u.useMemo)(()=>ei.includes("\n"),[ei]),{results:tn,dropDownSelected:tr,showQueryDropdownMenu:to,reduceSearchResult:td,addSearchResult:tg}=tc({enable:!eF&&!ti,value:ei,debouncedValue:eo,inputRef:ef}),tv=B.N2,tf=(0,u.useMemo)(()=>B.iu.find(e=>e===eD)&&eT,[eD,eT]);(0,u.useEffect)(()=>{void 0===eS||tf||tG(!1,!0)},[tf,eS]);let tj=(0,u.useMemo)(()=>!1,[eD]),tw=(0,u.useMemo)(()=>!!eF&&(0,tR.LQ)(eF),[eF]),tN=(0,u.useMemo)(()=>!!eF&&(0,tR.el)(eF),[eF]),tZ=(0,u.useMemo)(()=>!!eF&&(0,tR.u1)(eF),[eF]),tS=(0,u.useMemo)(()=>{var e;return!!eF&&(null===(e=eF.params)||void 0===e?void 0:e.some(e=>(0,tR.Sc)(e.type)))},[eF]),tC=(0,u.useMemo)(()=>ei.length>tv,[ei]),tD=(0,u.useMemo)(()=>{let e=eF&&(0,tR.Ye)(eF);return!((!e||(null==q?void 0:q.length))&&((null==eF?void 0:eF.template_type)!==ed.W.CUSTOM&&(null==eF?void 0:eF.template_type)!==ed.W.DIRECT_DUTY||e||ei.trim()))||!eF&&!ei.trim()},[ei,eF,q]),tT=(0,u.useMemo)(()=>{var e,t;return(null==q||!q.length)&&(null==K||!K.length)||!!((null==q?void 0:q.length)&&(null==q?void 0:null===(e=q.filter(e=>(null==e?void 0:e.status)==="completed"))||void 0===e?void 0:e.length)||(null==K?void 0:K.length)&&(null==K?void 0:null===(t=K.filter(e=>(null==e?void 0:e.status)==="completed"))||void 0===t?void 0:t.length))},[q,K]),tL=(0,u.useMemo)(()=>{var e;return null==es?void 0:null===(e=es.filter(e=>(null==e?void 0:e.status)==="completed"))||void 0===e?void 0:e.length},[es]),tM=(0,u.useMemo)(()=>tL&&!el,[tL,el]),tU=(0,u.useMemo)(()=>!tM&&(eM===B.J5&&!tL||tD||ek||tC||$||el||!tT),[tD,ek,tC,$,tT,el,tM]),tO=()=>{ef.current&&M.push("/websearch?q=".concat(ef.current.value))},tB=()=>{var e,t,s,l,a,i,n,r,o,d,c,u;if(!ef.current)return;let m=ef.current.value.trim();if(-1!==tr&&(m=tn[tr].title),!m&&!eF)return;let p={query:m};if((tf&&eA||eF)&&!R){if((null==eF?void 0:eF.template_type)===ed.W.CUSTOM||(null==eF?void 0:eF.template_type)===ed.W.DIRECT_DUTY){let e=eF;tN&&(e={...eF,params:null===(l=eF.params)||void 0===l?void 0:l.map(e=>(0,tR.YX)(e.type)?{...e,value:ej}:e)}),tk.Z.getState().setTemplateData({templateQuery:m,template:e}),eQ.Z.getState().setTemplate(e);let t=eF.sub_topics[0].source_type;p.category=t,p.model=eF.sub_topics[0].llm_model,t===B.RQ&&(p.topicId=eF.sub_topics[0].source_id)}else{eQ.Z.getState().openAgentPlanModal(m);return}}if(eF){let e=null==eF?void 0:null===(a=eF.params)||void 0===a?void 0:a.some(e=>"file"===e.type),t=null==es?void 0:null===(i=es.filter(e=>(null==e?void 0:e.status)==="completed"))||void 0===i?void 0:i.length;if(!e&&!m&&!t)return}let x=(null==eF?void 0:eF.template_type)===ed.W.CUSTOM;!R&&((null==q?void 0:null===(e=q.filter(e=>(null==e?void 0:e.status)==="completed"))||void 0===e?void 0:e.length)||(null==es?void 0:null===(t=es.filter(e=>(null==e?void 0:e.status)==="completed"))||void 0===t?void 0:t.length))&&(x||(p.category=B.J5),o=[...q,...es],p.documents=void 0===o?void 0:null===(r=o.filter(e=>(null==e?void 0:e.status)==="completed"))||void 0===r?void 0:null===(n=r.map(e=>null==e?void 0:e.id))||void 0===n?void 0:n.join(","),(null==es?void 0:null===(d=es.filter(e=>(null==e?void 0:e.status)==="completed"))||void 0===d?void 0:d.length)&&(p.documentAction="summary",p.query=P("searchAddition.summary_file"))),!R&&(null==K?void 0:null===(s=K.filter(e=>(null==e?void 0:e.status)==="completed"))||void 0===s?void 0:s.length)&&(x||(p.category=B.Ys),p.documents=null==K?void 0:null===(u=K.filter(e=>(null==e?void 0:e.status)==="completed"))||void 0===u?void 0:null===(c=u.map(e=>null==e?void 0:e.id))||void 0===c?void 0:c.join(",")),e4&&(p.topicSource="topic"),R&&(p.category=B.gl,p.topicSource="topic",p.topicId=R),eF&&(p.templateId=eF.id,p.category="long_text"===eK&&tL?B.J5:eK);let g=(0,h.M)(p);M.push(g,void 0,{scroll:!0})},tV=()=>{tp.$.publish("showSubscriptionPlan",void 0)},tY=()=>{tp.$.publish("showLogin",void 0)},tW=async e=>{var t,s,a,i;if(e.preventDefault(),L&&!eS){tY();return}if(!tU){if(eF&&(null==eF?void 0:eF.template_type)!==ed.W.DEFAULT&&!tZ&&(e6||0===O)&&!R){eB.custom(eS?P.rich("search_limit_tip_five",{highlight:e=>(0,l.jsx)("span",{onClick:e=>{e.preventDefault(),eB.dismiss(),tV()},className:"text-[#0080FF] cursor-pointer font-medium mx-1 dark:text-[#2F95FB]",children:e})}):P.rich("search_limit_tip_six",{highlight:e=>(0,l.jsx)("span",{onClick:e=>{e.preventDefault(),eB.dismiss(),tY()},className:"text-[#0080FF] cursor-pointer font-medium mx-1 dark:text-[#2F95FB]",children:e})}));return}if(((null==eF?void 0:eF.template_type)===ed.W.CUSTOM||R||null==q||!q.filter(e=>"completed"===e.status).length||(v.Z.getState().setExtensionSelected(B.J5),await tK()))&&(R&&eQ.Z.getState().clearTemplate(),await (0,D.f)({query:null===(s=ef.current)||void 0===s?void 0:null===(t=s.value)||void 0===t?void 0:t.trim(),setLoading:eC}))){if(-1===tr)eE("form"),tB();else{let e=tn[tr];if("site"===e.type){let t=tQ(e.domain);window.open(t,"_blank")}else eE("form"),tB()}!0===eV&&eY(),R&&(0,X.fk)(z?G.U.COLLECTION_THREAD_SUBMIT:G.U.COLLECTION_SHARE_THREAD_SUBMIT,{query:null===(i=ef.current)||void 0===i?void 0:i.value,webSearch:e0},!0),(0,X.fk)(U?G.U.SEARCH_SUBMIT:G.U.THREAD_NEW,{query:null===(a=ef.current)||void 0===a?void 0:a.value},!0),tJ()}}},tJ=()=>{en(""),ef.current&&(ef.current.value="",ef.current.focus())};(0,u.useEffect)(()=>(eu(!1),()=>{e1&&e2(!1)}),[]),(0,u.useEffect)(()=>{(0,W.f8)(()=>{if(ef.current&&S){ef.current.focus();let e=(k||"").length;ef.current.setSelectionRange(e,e)}})},[]);let tG=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];eR(e),ez(!1),t&&e&&(0,X.fk)(G.U.PRO_DISCOVERY_SEARCH,{},!0)},tK=async()=>{var e;let{subscriptionInfo:t}=tm.ZP.getState();return console.log("subscriptionInfo",t),!!t&&(!!et||!(0>=((null==t?void 0:null===(e=t.chatDocumentsUsage)||void 0===e?void 0:e.balance)||0))||(tp.$.publish("showSubscriptionPlan",void 0),!1))};(0,u.useEffect)(()=>{void 0!==eS&&(eT?B.Wh:tG(!1))},[eT,eS]),(0,u.useEffect)(()=>{k&&en(k)},[k]),(0,u.useEffect)(()=>{},[ew]),(0,u.useEffect)(()=>{F&&F(!!(tf&&!R))},[tf,R]),(0,u.useEffect)(()=>{if(eF&&eF.params){var e;(null==eF?void 0:null===(e=eF.params)||void 0===e?void 0:e.some(e=>"file"===e.type))&&!R&&H.Z.info(P("error.must_has_file"))}},[eF]);let t0=[{id:"quick",icon:(0,l.jsx)(tu.RK,{className:"w-4 h-4"}),label:P("quick_search"),isActive:!eI&&!eA,display:!0,onClick:()=>tG(!1,!0),disabled:!1},{id:"discovery",icon:(0,l.jsx)(a.Z,{size:16}),label:P("study_search"),isActive:eI&&!eA,display:!0,onClick:()=>{tG(!0,!0)},disabled:!1,tooltipLable:P("deep_research_desc")},{id:"research",icon:(0,l.jsx)(i.Z,{className:"w-4 h-4"}),label:P("extension.search_agent"),isActive:eA,display:!1,onClick:()=>ez(!0),disabled:!1}],t1=e=>{let{mode:t,isFirst:s,isLast:a,disabled:i,id:n}=e,r=(0,m.cn)("flex items-center gap-1 border px-2 py-1 cursor-pointer","text-[#98A2B3] border-[#E4E7EC] dark:border-[#434955] dark:text-[#797E8D]",t.isActive&&"text-[#0080FF] dark:text-[#0080FF]",i&&"cursor-default opacity-50",s&&"rounded-s-lg",!s&&"border-l-0",a&&"rounded-e-lg");return(0,l.jsx)(l.Fragment,{children:t.tooltipLable?(0,l.jsx)(x.e,{delay:0,closeDelay:0,content:t.tooltipLable,classNames:{content:["text-white bg-gray-600 dark:bg-[#353535]"]},children:(0,l.jsxs)("div",{className:r,id:"mode-".concat(n),onClick:()=>!i&&t.onClick(),children:[t.icon,t.label]})}):(0,l.jsxs)("div",{className:r,id:"mode-".concat(n),onClick:()=>!i&&t.onClick(),children:[t.icon,t.label]})})};(0,u.useEffect)(()=>(eJ(!0),()=>{eJ(!1)}),[]);let t2=(0,u.useMemo)(()=>eW?"long_text"===eM?P("agentConfig.paste_text_here"):"chat_with_document"===eM?P("agentConfig.supports_PDF_Doc_TXT"):"web_summary"==eM?P("agentConfig.paste_url_here"):"video_summary"===eM?P("agentConfig.paste_video_link_here"):eF?eF.placeholder||P("search_placeholder"):R?P("search_placeholder"):eA?P("agent.input_research_question"):P("search_placeholder"):P("search_placeholder"),[eF,eA,eW,P,R,eM]),t5=e=>{let t=new Date,s=new File([e],e.slice(0,20)+".txt",{type:"text/plain",lastModified:t.getTime()});Object.defineProperty(s,"lastModifiedDate",{value:t}),Object.defineProperty(s,"webkitRelativePath",{value:""});let l=new DataTransfer;l.items.add(s),er(l.files)},t4=(0,u.useCallback)(e=>{var t;let s=e.clipboardData.getData("text");if(s.length>4e3&&"long_text"===eM){t5(s),e.preventDefault();return}if(eF&&!(0,tR.Ye)(eF)||R||(null==q?void 0:q.length))return;let l=null===(t=e.clipboardData)||void 0===t?void 0:t.items,a=null==l?void 0:l[0];if(!a||!a.type.startsWith("image"))return;let i=a.getAsFile();if(i){e.preventDefault(),eN([i]);return}},[eM,eS]);return(0,l.jsxs)(l.Fragment,{children:[eG&&(0,l.jsx)(tP,{}),(0,l.jsx)("form",{ref:ev,className:(0,m.cn)("flex justify-center",Z),onSubmit:tW,children:(0,l.jsx)("div",{className:"rounded-xl w-full",children:(0,l.jsx)("div",{className:(0,m.cn)("rounded-xl w-full gap-2 relative","gap-2 shadow-sm",!T&&"border-1 border-[#dbe2e9] dark:border-[#343b4d] dark:bg-[#20232a]",tf&&!R?"mt-[0px]":R||T?"mt-[0px]":"mt-[42px]"),children:(0,l.jsxs)("div",{className:(0,m.cn)("py-4 px-3","h-full w-full rounded-xl relative  border-2 border-dashed border-transparent",!$&&eD===B.J5&&ex?"border-primary  bg-sky-50/80":""),onDragEnter:e=>{e.preventDefault(),e.stopPropagation(),eb.current+=1,1===eb.current&&eg(!0)},onDragLeave:e=>{e.preventDefault(),e.stopPropagation(),eb.current-=1,0===eb.current&&eg(!1)},onDragOver:e=>{e.preventDefault(),e.stopPropagation()},onDrop:e=>{var t;if(e.preventDefault(),e.stopPropagation(),eg(!1),eb.current=0,e9.Z.getState().isUploading)return;let{files:s}=e.dataTransfer;console.log("files",s),(null==s?void 0:s.length)&&(null===(t=e_.current)||void 0===t||t.handleFiles(s))},style:{boxShadow:"0px 16px 20px -3px rgba(16, 24, 40, 0.06), 0px 4px 6px -2px rgba(16, 24, 40, 0.03)"},children:[(0,l.jsxs)("div",{className:(0,m.cn)("flex items-center justify-center rounded-xl h-full absolute top-0 left-0 right-0 bottom-0 gap-1 pointer-events-none z-50  text-primary bg-white/70 dark:bg-black/70",!$&&eD===B.J5&&ex?"":"hidden"),children:[(0,l.jsx)(n.Z,{size:22}),P("searchAddition.drop_your_file_here")]}),(R||tf)&&eT&&(0,l.jsx)("div",{className:"group -mx-3 -mt-4 h-[50px] flex justify-between items-center rounded-t-xl px-3 py-3 bg-[#F9FAFB] dark:bg-[#2F333C] min-h-10 mb-2",children:(0,l.jsxs)("div",{className:"w-full flex items-center text-sm text-gray-400 overflow-hidden gap-3",children:[(0,l.jsx)("div",{className:"flex items-center dark:bg-[#2d313a]",children:t0.map((e,t)=>e.display?(0,l.jsx)(t1,{mode:e,isFirst:0===t,id:e.id,isLast:t===t0.filter(e=>e.display).length-1,disabled:e.disabled||tj},e.id):null)}),(0,l.jsx)("span",{className:"flex-1 line-clamp-1 text-[#98A2B3] dark:text-[#797E8D]",children:eA?P("research_desc"):eI?P("deep_search_desc_placeholder"):P("quick_search_desc")})]})}),(null==eF?void 0:null===(N=eF.tool_config)||void 0===N?void 0:null===(w=N.top_bar)||void 0===w?void 0:null===(c=w.top_bar_list)||void 0===c?void 0:c.length)&&(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(tH,{topTabType:eM,setTopTabType:e=>{e!==eM&&(ee([]),ea([]),eU(e))}})}),!R&&(0,l.jsx)(tE,{}),!R&&(0,l.jsx)(tI,{}),(0,l.jsxs)("div",{className:"flex relative",children:[(0,l.jsx)("span",{id:"modal"===C?"modal_search_form":"default_search_form",className:"invisible"}),(0,l.jsx)(g.Z,{ref:ef,className:(0,m.cn)(!U&&"max-h-[40vh] overflow-y-auto scrollbar","m-3 mr-0 w-full bg-inherit outline-none resize-none transition-height",ei.length>tv&&"text-red-500","custom-scrollbar"),disabled:ec,value:ei,onChange:e=>{e.target.value.length>4e3&&"long_text"===eM?t5(e.target.value):en(e.target.value)},onKeyDown:e=>{if(13===e.keyCode&&e.ctrlKey){e.preventDefault(),tO();return}if(13==e.keyCode&&!1==e.shiftKey&&!Y){var t;if(e.preventDefault(),0===tr){tO();return}null===(t=e.target.form)||void 0===t||t.requestSubmit()}"Escape"===e.key&&eV&&(e.preventDefault(),eY()),"ArrowUp"===e.key&&tn.length>1&&(e.preventDefault(),td()),"ArrowDown"===e.key&&tn.length>1&&(e.preventDefault(),tg())},onFocus:()=>ep(!0),minRows:3,maxRows:8,placeholder:t2,spellCheck:!1,rows:3,onPaste:t4}),(0,l.jsx)("div",{className:ei?"opacity-100":"opacity-0",children:(0,l.jsx)(x.e,{delay:0,closeDelay:0,content:P("clear_search_tip"),isDisabled:!ei,children:(0,l.jsx)(p.z,{size:"icon",disabled:ek||!ei,variant:"ghost",className:"h-8 w-8 rounded-full text-gray-600 dark:text-white hover:scale-105 hover:text-black","aria-label":P("clear_search_tip"),tabIndex:ei?0:-1,onClick:tJ,children:(0,l.jsx)(r.Z,{className:"h-4 w-4"})})})})]}),(0,l.jsxs)("div",{className:"flex flex-wrap w-full items-end justify-between gap-2",children:[(0,l.jsxs)("div",{className:"flex flex-wrap text-[#1d3c6d] dark:text-[#edf3fc]",children:[!R&&(0,l.jsx)(ts,{isDisalbedExtension:A}),tN&&!R?(0,l.jsx)("div",{className:"ml-3",children:(0,l.jsx)(tA.Z,{hideAutoDetect:tS,language:ej,onChangeLanguage:ey,template:eF})}):(0,l.jsx)(l.Fragment,{children:!R&&(!eF||tw)&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(th.Z,{ref:e_,type:"home",mode:C}),(0,l.jsx)(ty,{ref:e_})]})}),R&&(0,l.jsx)(tx.Z,{isReply:!1}),_.r8&&(0,l.jsx)(f.Z,{})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[ei.length>tv&&(0,l.jsx)("div",{className:"text-sm text-red-600",children:tv-ei.length}),!tZ&&(0,l.jsx)(eq.Z,{agentTemplate:null,isTopic:!!R}),ek?(0,l.jsx)(eP.c,{className:"px-2 h-8",classNames:{circle1:"".concat(V?"border-b-white":"border-b-[#b3bcca]"),circle2:"".concat(V?"border-b-white":"border-b-[#b3bcca]")},size:"sm"}):(0,l.jsx)(p.z,{size:"icon",type:"submit",className:(0,m.cn)("h-8 w-8 rounded-full hover:scale-105 transition-all",(tD||tC||$||Q||el||!tT)&&!tM?"bg-[#f3f4f6] dark:bg-[#7e7e7e]":"bg-[#2b70f2] dark:bg-[#0080ff] hover:bg-[#2b70f2]/90"),disabled:tU,children:(0,l.jsx)(o.Z,{className:(0,m.cn)("h-4 w-4",(tD||tC||$||Q||el||!tT)&&!tM?"text-gray-400 dark:text-[#170F49]":"text-white")})})]})]}),(0,l.jsxs)("div",{className:(0,m.cn)("absolute -left-px -right-px  z-10","hidden",!R&&!eF&&em&&ei&&eD!==B.J5&&eD!==B.Ys&&"block","mt-1.5","border border-[#dbe2e9] dark:border-zinc-700","rounded-b-xl bg-white dark:bg-[#20232a]"),children:[(0,l.jsx)("div",{className:"max-h-[19em] px-4 py-2 overflow-auto",children:tn.map((e,t)=>(0,l.jsx)(I,{data:e,selected:tr===t,goToTraditionalSearch:tO},e.title))}),eD!==B.aI&&eD!==B.J5&&eD!==B.Ys&&em&&to&&tn.length>1&&!Y&&(0,l.jsx)(tl,{isDisalbedExtension:A})]})]})})})})]})})},5588:function(e,t,s){s.d(t,{I:function(){return n}});var l=s(52676),a=s(75271),i=s(37481);let n=a.forwardRef((e,t)=>{let{className:s,type:a,...n}=e;return(0,l.jsx)("input",{type:a,className:(0,i.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:t,...n})});n.displayName="Input"},26949:function(e,t,s){s.d(t,{SP:function(){return d},dr:function(){return o},mQ:function(){return r},nU:function(){return c}});var l=s(52676),a=s(75271),i=s(1262),n=s(37481);let r=i.fC,o=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,l.jsx)(i.aV,{ref:t,className:(0,n.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",s),...a})});o.displayName=i.aV.displayName;let d=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,l.jsx)(i.xz,{ref:t,className:(0,n.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",s),...a})});d.displayName=i.xz.displayName;let c=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,l.jsx)(i.VY,{ref:t,className:(0,n.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...a})});c.displayName=i.VY.displayName},78017:function(e,t,s){s.d(t,{_:function(){return l}});let l="claude-3-7-sonnet"},35525:function(e,t,s){var l=s(75910),a=s(65819);let i=(0,l.Ue)(e=>({isOpen:!1,callback:()=>{},setIsOpen:t=>e({isOpen:t}),getDataRetentionEnabled:()=>{var e,t;return null===(t=null===(e=a.ZP.getState().userInfo.settings)||void 0===e?void 0:e.ai_data_retention)||void 0===t||t},setCallback:t=>e({callback:t})}));t.Z=i},54047:function(e,t,s){let l=(0,s(75910).Ue)(e=>({showAgentLimitModal:!1,setShowAgentLimitModal:t=>e({showAgentLimitModal:t}),showLimitModalData:null,setShowLimitModalData:t=>e({showLimitModalData:t}),shareStep:1,setShareStep:t=>e({shareStep:t}),showAgentStatus:"PRIVATE",setShowAgentStatus:t=>e({showAgentStatus:t}),sharePermission:null,setSharePermission:t=>e({sharePermission:t}),updateSharePermission:t=>e(e=>({sharePermission:e.sharePermission?{...e.sharePermission,...t}:null}))}));t.Z=l}}]);