(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3706],{35279:function(e,t,r){"use strict";var a=r(52676),l=r(75271),o=r(72135),n=r.n(o),i=r(351),s=r(59427);r(13963),r(33685),r(87518);var d=r(97571),c=r(72070),u=r.n(c),p=r(7717),h=r(62033),g=r(72881),m=r(30674),f=r(4460),v=r(69194),x=r(29871),b=r(18881);let w=n()(()=>Promise.resolve().then(r.t.bind(r,4460,19)).then(e=>e.Viewer),{loadableGenerated:{webpack:()=>[4460]},ssr:!1}),C=n()(()=>Promise.resolve().then(r.t.bind(r,4460,19)).then(e=>e.Worker),{loadableGenerated:{webpack:()=>[4460]},ssr:!1});t.Z=e=>{let{fileUrl:t,fileType:r,pdfFileUrl:o}=e,{isMobile:n}=(0,x.Z)(),{setIsPdfLoaded:c}=(0,b.Z)(),y=(0,s.toolbarPlugin)(),{renderDefaultToolbar:j,Toolbar:F}=y,[_,S]=(0,l.useState)(""),[k,T]=(0,l.useState)(""),[I,N]=(0,l.useState)(""),P=e=>({...e,Download:()=>(0,a.jsx)(a.Fragment,{}),EnterFullScreen:()=>(0,a.jsx)(a.Fragment,{}),SwitchTheme:()=>(0,a.jsx)(a.Fragment,{}),Open:()=>(0,a.jsx)(a.Fragment,{}),Print:()=>(0,a.jsx)(a.Fragment,{}),ShowSearchPopover:()=>(0,a.jsx)(a.Fragment,{})}),D=(0,i.defaultLayoutPlugin)({renderToolbar:()=>(0,a.jsx)(F,{children:j(P)}),sidebarTabs:e=>n?[]:[e[0]]}),E=()=>{let{activateTab:e}=D;e(0),c(!0)},O=(0,l.useRef)(null),{isDark:B}=(0,d.Z)(),L=(0,p.useTranslations)(),Z=(0,p.useLocale)(),A=(0,g.b)(r);(0,l.useEffect)(()=>{if(o){S(o),T(o||t);return}let e=async()=>{try{let e=encodeURIComponent(btoa(t)),r=await (0,v.D)({fileUrl:e});if(500===r)return N("error"),null;return S(r.data),r.data}catch(e){return console.error("Error fetching data:",e),null}};if("PDF"===r){let r=new Promise(e=>{setTimeout(()=>e(null),1e3)});Promise.race([e(),r]).then(e=>{T(e||t)})}else e()},[t,r,o]),(0,l.useEffect)(()=>{O.current&&O.current.scrollTo(0,0)},[k]);let z=e=>{if(_)return U(_);{let t="";switch(e.name){case"InvalidPDFException":t="The document is invalid or corrupted";break;case"MissingPDFException":t="The document is missing";break;case"UnexpectedResponseException":t="Unexpected server response";break;default:t="Cannot load the document"}return(0,a.jsx)("div",{style:{alignItems:"center",display:"flex",height:"100%",justifyContent:"center"},children:(0,a.jsx)("div",{style:{backgroundColor:"#e53e3e",borderRadius:"0.25rem",color:"#fff",padding:"0.5rem"},children:t})})}},U=e=>(0,a.jsx)(C,{workerUrl:"https://unpkg.com/pdfjs-dist@3.4.120/build/pdf.worker.min.js",children:(0,a.jsx)("div",{ref:O,className:"w-full h-[60vh] max-h-[calc(80vh-144px)]",children:(0,a.jsx)(w,{defaultScale:f.SpecialZoomLevel.PageFit,theme:B?"dark":"light",fileUrl:"/api/fetchFile?url=".concat(encodeURIComponent(e)),plugins:[D,y],onDocumentLoad:E,localization:h.f[Z],renderError:z})})}),R=e=>(0,a.jsx)("div",{className:"max-h-[calc(80vh-144px)]",children:(0,a.jsx)("iframe",{src:"https://view.officeapps.live.com/op/view.aspx?src=".concat(encodeURIComponent(e)),className:"w-full h-[60vh] max-h-[calc(80vh-144px)]",frameBorder:"0"})}),M=()=>(0,a.jsxs)("div",{className:"h-full p-4 h-[60vh] max-h-[calc(80vh-144px)] text-center pt-32",children:[(0,a.jsx)("div",{className:"flex justify-center mb-4",children:(0,a.jsx)(u(),{src:A,alt:r,width:80,height:80})}),(0,a.jsxs)("div",{className:"break-words text-[#0A1C38] dark:text-[#FFF] text-lg mb-8",children:[t.split("/").pop(),".",r]}),(0,a.jsx)("div",{className:"text-[#0A1C38] dark:text-[#FFF] text-base",children:L("file_preview_notification")})]}),V=()=>(0,a.jsx)("div",{className:"h-full p-4 h-[60vh] max-h-[calc(80vh-144px)] text-center pt-32",children:(0,a.jsx)(m.c,{label:L("topic.loading")})});return(0,a.jsx)("div",{children:(()=>{if("PDF"===r)return k?U(k):V();if(I)switch(r){case"PPTX":case"PPT":case"DOC":case"DOCX":case"XLS":case"XLSX":return R(t);default:return M()}return _?["XLSX","XLS","CSV","HTML"].includes(r)?(0,a.jsx)("div",{className:"max-h-[calc(80vh-144px)]",children:(0,a.jsx)("iframe",{src:_,className:"w-full h-[60vh] max-h-[calc(80vh-144px)]",frameBorder:"0"})}):U(_):V()})()})}},57527:function(e,t,r){"use strict";r.d(t,{C:function(){return b}});var a=r(52676),l=r(75271),o=r(7717),n=r(43378),i=r(97571),s=r(25794),d=r(5311),c=r(65819),u=r(60635),p=r(19527),h=r(70017),g=r(19583),m=r(4814),f=r(79057),v=r(34097);let x=async(e,t)=>{let r=await fetch(t);return fetch(e,{method:"PUT",body:await r.blob()})},b=e=>{let{type:t="thread",onNoteAddGraphic:r,onNoteUpdateGraphic:b}=e,w=(0,o.useTranslations)(),C=(0,o.useLocale)(),{isDark:y}=(0,i.Z)(),j=(0,l.useRef)(null),F=(0,l.useRef)(null),{isMyThread:_}=(0,d.Z)();(0,c.gQ)();let S=(0,h.V)(),{showGraphicModel:k,setShowGraphicModel:T,graphicQueryData:I,allGraphicData:N,setAllGraphicData:P}=(0,f.Z)(),D=(0,l.useRef)(void 0),E=()=>{T(!1)},O=(0,l.useCallback)(()=>{let e=window.location.href.split("?")[0];if(history.replaceState({},"",e),!_){T(!1);return}B()},[_]);(0,l.useEffect)(()=>{let e=e=>{var r,a,l,o,n,i;if(e.data.type){if("graphic:init"===e.data.type){let{anonymousToken:e}=c.ZP.getState();null===(a=F.current)||void 0===a||null===(r=a.contentWindow)||void 0===r||r.postMessage({type:"graphic:init",value:{tokens:{login:(0,s.Nh)(),anonymous:e,visitor:(0,s.Kd)()},options:{canEdit:I.canEdit,mode:(null==I?void 0:I.mode)||t,thread_id:null==I?void 0:I.threadId,message_id:null==I?void 0:I.messageId,language:null==I?void 0:I.language,inputText:null==I?void 0:I.inputText,smart_art_id:null==I?void 0:I.smart_art_id,note_id:null==I?void 0:I.note_id}}},"*")}if("graphic:data"===e.data.type)D.current=e.data.value;else if("graphic:save"===e.data.type){if(D.current=e.data.value,!e.data.value.canEdit)return;"note"===e.data.value.mode?L(!1):B(!1)}else if("graphic:insertData"===e.data.type){if(!e.data.value.canEdit)return;"note"===e.data.value.mode?L(!0):B(!0)}else if("graphic:retry"===e.data.type);else if("graphic:download"===e.data.type){let{currentData:t}=g.Z.getState();(0,u.DB)({type:"image/png",filename:"".concat(null==t?void 0:t.query,".png"),data:e.data.value.replace("data:image/png;base64,","")})}else if("graphic:share"===e.data.type){null===(o=F.current)||void 0===o||null===(l=o.contentWindow)||void 0===l||l.postMessage({type:"graphic:shareSucceed"},"*");let t="".concat(window.location.origin,"/search/").concat(e.data.value.thread_id,"?showGraphic=1&message_id=").concat(e.data.value.message_id);S.copy(t),p.Z.getState().setShareStatus("PUBLIC"),B(!1)}else if("graphic:status"===e.data.type){let{currentData:t}=g.Z.getState();console.log("graphic:status",e.data),t&&g.Z.getState().setCurrentData({...t,status:null==e?void 0:null===(i=e.data)||void 0===i?void 0:null===(n=i.value)||void 0===n?void 0:n.status})}}};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}},[I]);let B=(0,l.useCallback)(function(){var e,t;let r=!(arguments.length>0)||void 0===arguments[0]||arguments[0];null===(t=F.current)||void 0===t||null===(e=t.contentWindow)||void 0===e||e.postMessage({type:"graphic:requestData"},"*");let a=window.setTimeout(()=>{if(console.log("getted graphic close data",D.current),D.current&&D.current.content&&D.current.canEdit){var e;(0,v.NK)({message_id:(null===(e=D.current)||void 0===e?void 0:e.message_id)||"",suffix:["png","svg"]}).then(e=>{let t=e.data.files;200===e.status&&Promise.all(t.map(e=>D.current?x(e.path,D.current[e.type]):void 0)).then(e=>{var r,a,l,o,n,i,s,d,c,u,p,h,g,m,x;let b=f.Z.getState().allGraphicData,w={content:(null===(r=D.current)||void 0===r?void 0:r.content)||[],smart_art_id:(null===(a=D.current)||void 0===a?void 0:a.smart_art_id)||(null===(l=b[(null===(o=D.current)||void 0===o?void 0:o.message_id)||""])||void 0===l?void 0:l.smart_art_id)||"",current_template:(null===(n=D.current)||void 0===n?void 0:n.current_template)||"",images:t,theme:(null===(i=D.current)||void 0===i?void 0:i.theme)||"",summary:null===(s=D.current)||void 0===s?void 0:s.inputText,svg:null===(d=D.current)||void 0===d?void 0:d.svgString,language:null===(c=D.current)||void 0===c?void 0:c.language,ratio:null===(u=D.current)||void 0===u?void 0:u.ratio};(null===(p=D.current)||void 0===p?void 0:p.smart_art_id)||(null===(h=b[(null===(g=D.current)||void 0===g?void 0:g.message_id)||""])||void 0===h?void 0:h.smart_art_id)?(0,v.KX)(w).then(e=>{if(200===e.status){var t;P({...b,[(null===(t=D.current)||void 0===t?void 0:t.message_id)||""]:{...w,...e.data}})}}):(delete w.smart_art_id,w={...w,thread_id:(null===(m=D.current)||void 0===m?void 0:m.thread_id)||"",message_id:(null===(x=D.current)||void 0===x?void 0:x.message_id)||""},(0,v.Vd)(w).then(e=>{if(200===e.status){var t;P({...b,[(null===(t=D.current)||void 0===t?void 0:t.message_id)||""]:{...w,...e.data}})}}))})})}r&&E(),window.clearTimeout(a)},400)},[_,N]),L=(0,l.useCallback)(function(){var e,t;let a=!(arguments.length>0)||void 0===arguments[0]||arguments[0];null===(t=F.current)||void 0===t||null===(e=t.contentWindow)||void 0===e||e.postMessage({type:"graphic:requestData"},"*");let l=window.setTimeout(()=>{if(console.log("getted graphic close data",D.current),D.current&&D.current.content){var e,t;let a;(null===(e=D.current)||void 0===e?void 0:e.smart_art_id)||(a="template"+Date.now().toString(),null==r||r(a,"",!0)),(0,v.NK)({message_id:(null===(t=D.current)||void 0===t?void 0:t.note_id)||"",suffix:["png","svg"]}).then(e=>{let t=e.data.files;200===e.status&&Promise.all(t.map(e=>D.current?x(e.path,D.current[e.type]):void 0)).then(e=>{var r,l,o,n,i,s,d,c,u,p,h,g,m,x,w;let C=f.Z.getState().allGraphicData,y={content:(null===(r=D.current)||void 0===r?void 0:r.content)||[],smart_art_id:(null===(l=D.current)||void 0===l?void 0:l.smart_art_id)||(null===(o=C[(null===(n=D.current)||void 0===n?void 0:n.message_id)||""])||void 0===o?void 0:o.smart_art_id)||"",current_template:(null===(i=D.current)||void 0===i?void 0:i.current_template)||"",images:t,theme:(null===(s=D.current)||void 0===s?void 0:s.theme)||"",summary:null===(d=D.current)||void 0===d?void 0:d.inputText,svg:null===(c=D.current)||void 0===c?void 0:c.svgString,language:null===(u=D.current)||void 0===u?void 0:u.language,ratio:null===(p=D.current)||void 0===p?void 0:p.ratio};(null===(h=D.current)||void 0===h?void 0:h.smart_art_id)?(null==b||b(null===(g=D.current)||void 0===g?void 0:g.smart_art_id,(null===(x=t[0])||void 0===x?void 0:null===(m=x.path)||void 0===m?void 0:m.split("?")[0])||"",null===(w=D.current)||void 0===w?void 0:w.smart_art_id),(0,v.KX)(y)):(delete y.smart_art_id,y={...y},(0,v.Vd)(y).then(e=>{if(200===e.status){var t;null==b||b(a,null===(t=e.data.images[0])||void 0===t?void 0:t.path,e.data.smart_art_id)}}))})})}a&&E(),window.clearTimeout(l)},400)},[_,N]);return(0,a.jsx)(n.Vq,{open:k,onOpenChange:O,children:(0,a.jsxs)(n.cZ,{className:"max-w-screen-2xl overflow-hidden z-[9999999]",ref:j,onOpenAutoFocus:e=>e.preventDefault(),"aria-describedby":void 0,children:[(0,a.jsx)(n.fK,{className:"relative z-10 pointer-events-none",children:(0,a.jsx)(n.$N,{children:w(I.smart_art_id?"graphic.edit_graphic":"graphic.title")})}),(0,a.jsx)("iframe",{ref:F,allow:"clipboard-write",className:(0,m.Z)("-mt-[3.75rem] flex-1 min-h-[90vh] w-full"),src:(()=>{let e=new URL("https://smartart.felo.ai");return e.searchParams.append("locale",C),e.searchParams.append("theme",y?"dark":"light"),e.toString()})(),style:{visibility:"hidden"},onLoad:()=>F.current&&(F.current.style.visibility="visible")})]})})}},24213:function(e,t,r){"use strict";r.d(t,{$U:function(){return l},RM:function(){return i},e8:function(){return o},y_:function(){return n}});var a=r(52676);let l=e=>(0,a.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 18 18",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e,children:[(0,a.jsxs)("g",{clipPath:"url(#clip0_2552_84059)",children:[(0,a.jsx)("path",{d:"M2.24 2.784l9-1.284v15l-9-1.33V2.784zM12.844 3.047h2.86V15h-2.86",stroke:"currentColor",strokeWidth:"1.5",strokeLinejoin:"round"}),(0,a.jsx)("path",{d:"M6.787 9.714H5.53v1.918c0 .274-.065.482-.194.624a.635.635 0 0 1-.49.213.643.643 0 0 1-.5-.208c-.126-.142-.189-.348-.189-.62V6.42c0-.302.07-.517.208-.647.139-.13.36-.194.661-.194h1.76c.522 0 .922.04 1.202.12.278.077.516.205.717.384.203.179.357.397.462.656.105.259.157.55.157.874 0 .69-.213 1.213-.638 1.57-.425.355-1.058.532-1.9.532zM6.454 6.61H5.53v2.07h.924c.324 0 .593-.034.809-.102a.946.946 0 0 0 .499-.332c.114-.154.171-.356.171-.606 0-.299-.088-.542-.263-.73-.198-.2-.603-.3-1.216-.3z",fill:"currentColor"})]}),(0,a.jsx)("defs",{children:(0,a.jsx)("clipPath",{id:"clip0_2552_84059",children:(0,a.jsx)("path",{fill:"#fff",d:"M0 0h18v18H0z"})})})]}),o=e=>(0,a.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e,children:(0,a.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M17.7929 1.79312C19.0118 0.574168 20.9882 0.57417 22.2071 1.79312C23.4261 3.01207 23.4261 4.98838 22.2071 6.20733L12.6444 15.7701C12.6246 15.7899 12.605 15.8095 12.5855 15.829C12.2981 16.117 12.0446 16.3709 11.7391 16.5581C11.4707 16.7226 11.178 16.8438 10.8719 16.9173C10.5235 17.001 10.1647 17.0007 9.75781 17.0003C9.73027 17.0003 9.70251 17.0002 9.67452 17.0002H7.99997C7.44769 17.0002 6.99997 16.5525 6.99997 16.0002V14.3257C6.99997 14.2977 6.99995 14.27 6.99992 14.2424C6.99954 13.8355 6.99921 13.4768 7.08286 13.1283C7.15636 12.8222 7.27757 12.5296 7.44206 12.2612C7.62929 11.9556 7.8832 11.7022 8.17119 11.4147C8.19068 11.3953 8.21033 11.3757 8.23013 11.3559L17.7929 1.79312ZM20.7929 3.20733C20.355 2.76943 19.645 2.76943 19.2071 3.20733L9.64434 12.7701C9.26478 13.1496 9.19479 13.2287 9.14733 13.3062C9.0925 13.3956 9.0521 13.4932 9.0276 13.5952C9.0064 13.6835 8.99997 13.7889 8.99997 14.3257V15.0002H9.67452C10.2113 15.0002 10.3167 14.9938 10.405 14.9726C10.5071 14.9481 10.6046 14.9077 10.6941 14.8529C10.7715 14.8054 10.8506 14.7354 11.2302 14.3559L20.7929 4.79312C21.2308 4.35522 21.2308 3.64524 20.7929 3.20733ZM6.7587 3.00023L11 3.00023C11.5523 3.00023 12 3.44794 12 4.00023C12 4.55251 11.5523 5.00023 11 5.00023H6.8C5.94342 5.00023 5.36113 5.00101 4.91104 5.03778C4.47262 5.0736 4.24842 5.13853 4.09202 5.21821C3.7157 5.40996 3.40973 5.71592 3.21799 6.09225C3.1383 6.24865 3.07337 6.47285 3.03755 6.91127C3.00078 7.36135 3 7.94365 3 8.80023V17.2002C3 18.0568 3.00078 18.6391 3.03755 19.0892C3.07337 19.5276 3.1383 19.7518 3.21799 19.9082C3.40973 20.2845 3.7157 20.5905 4.09202 20.7822C4.24842 20.8619 4.47262 20.9269 4.91104 20.9627C5.36113 20.9994 5.94342 21.0002 6.8 21.0002H15.2C16.0566 21.0002 16.6389 20.9994 17.089 20.9627C17.5274 20.9269 17.7516 20.8619 17.908 20.7822C18.2843 20.5905 18.5903 20.2845 18.782 19.9082C18.8617 19.7518 18.9266 19.5276 18.9624 19.0892C18.9992 18.6391 19 18.0568 19 17.2002V13.0002C19 12.4479 19.4477 12.0002 20 12.0002C20.5523 12.0002 21 12.4479 21 13.0002V17.2416C21 18.0465 21 18.7109 20.9558 19.2521C20.9099 19.8141 20.8113 20.3309 20.564 20.8162C20.1805 21.5688 19.5686 22.1808 18.816 22.5643C18.3306 22.8115 17.8139 22.9101 17.2518 22.956C16.7106 23.0002 16.0463 23.0002 15.2413 23.0002H6.75868C5.95372 23.0002 5.28936 23.0002 4.74817 22.956C4.18608 22.9101 3.66937 22.8115 3.18404 22.5643C2.43139 22.1808 1.81947 21.5688 1.43598 20.8162C1.18868 20.3309 1.09012 19.8141 1.04419 19.2521C0.999977 18.7109 0.999988 18.0465 1 17.2415V8.75893C0.999988 7.95396 0.999977 7.2896 1.04419 6.7484C1.09012 6.1863 1.18868 5.6696 1.43597 5.18427C1.81947 4.43162 2.43139 3.8197 3.18404 3.4362C3.66937 3.18891 4.18608 3.09035 4.74817 3.04442C5.28937 3.0002 5.95373 3.00021 6.7587 3.00023Z",fill:"currentColor"})}),n=e=>(0,a.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e,children:(0,a.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M16.2929 2.29319C17.788 0.798101 20.212 0.798103 21.7071 2.2932C23.2022 3.78829 23.2022 6.21232 21.7071 7.70741L18.7098 10.7048L18.7071 10.7074L18.7045 10.71L8.50084 20.9137L8.45099 20.9636C8.20609 21.2089 7.99007 21.4252 7.7334 21.5945C7.50774 21.7433 7.26301 21.8609 7.00584 21.9442C6.71333 22.0389 6.40942 22.0724 6.06489 22.1104L5.99481 22.1181L2.61044 22.4942C2.30851 22.5277 2.00771 22.4222 1.7929 22.2074C1.57809 21.9926 1.47258 21.6918 1.50612 21.3899L1.88216 18.0055L1.88992 17.9354C1.92792 17.5909 1.96144 17.287 2.05613 16.9945C2.13938 16.7373 2.25701 16.4926 2.40582 16.2669C2.57507 16.0102 2.79143 15.7942 3.03672 15.5493L3.03673 15.5493L3.08663 15.4995L16.2929 2.29319ZM14 7.41451L4.50084 16.9137C4.17834 17.2362 4.11846 17.3027 4.07547 17.3679C4.02587 17.4431 3.98666 17.5247 3.95891 17.6104C3.93486 17.6847 3.9203 17.7731 3.86993 18.2264L3.63193 20.3684L5.77394 20.1304C6.22724 20.08 6.31556 20.0655 6.38986 20.0414C6.47559 20.0136 6.55717 19.9744 6.63238 19.9248C6.69758 19.8818 6.76412 19.822 7.08663 19.4995L16.5858 10.0003L14 7.41451ZM18 8.58609L15.4142 6.0003L17.7071 3.70741C18.4212 2.99336 19.5789 2.99336 20.2929 3.70741C21.007 4.42145 21.007 5.57915 20.2929 6.2932L18 8.58609ZM5.29912 6.92207C5.32553 6.94753 5.3567 6.96754 5.39085 6.98095C5.42501 6.99435 5.46147 7.00089 5.49815 7.00019C5.5353 7.00126 5.57228 6.99491 5.60694 6.98149C5.6416 6.96808 5.67322 6.94787 5.69997 6.92207C5.75708 6.87164 5.79407 6.80229 5.80413 6.72676C5.85063 6.42109 5.8993 6.16317 5.95015 5.95298C6.00223 5.74466 6.06857 5.57322 6.14917 5.43868C6.23102 5.30413 6.33735 5.19687 6.46818 5.11689C6.60086 5.03815 6.76827 4.97584 6.9704 4.92995C7.21585 4.875 7.46427 4.83432 7.71443 4.80812C7.79271 4.80311 7.86606 4.76814 7.91923 4.71046C7.9724 4.65279 8.00131 4.57685 7.99995 4.49842C8.00066 4.46108 7.99386 4.42398 7.97996 4.38931C7.96606 4.35464 7.94534 4.32312 7.91904 4.29661C7.86652 4.23806 7.79507 4.19987 7.71722 4.18872C7.46827 4.15554 7.22094 4.11116 6.97598 4.05573C6.80358 4.0184 6.63816 3.95405 6.48585 3.86508C6.35629 3.78696 6.24775 3.67842 6.16964 3.54887C6.07701 3.39149 6.00807 3.22133 5.96503 3.04386C5.91171 2.83554 5.85807 2.57885 5.80413 2.2738C5.79276 2.19782 5.75487 2.12831 5.69718 2.07757C5.64369 2.02647 5.5721 1.99871 5.49815 2.00038C5.42358 1.99992 5.35156 2.02746 5.29633 2.07757C5.2397 2.12852 5.20338 2.1982 5.19403 2.2738C5.1578 2.53355 5.10938 2.79145 5.04894 3.04665C5.00773 3.2275 4.93971 3.40117 4.84712 3.56189C4.76765 3.69256 4.65832 3.80252 4.52812 3.88275C4.39791 3.96211 4.23144 4.02473 4.02869 4.07061C3.78222 4.12258 3.53327 4.162 3.2828 4.18872C3.20462 4.19703 3.13233 4.23417 3.08005 4.29289C3.0272 4.34809 2.99843 4.42202 3.00007 4.49842C2.9989 4.57395 3.02649 4.64709 3.07726 4.70303C3.13058 4.76131 3.19785 4.79634 3.27908 4.80812C3.57421 4.85152 3.82129 4.89709 4.02032 4.94483C4.22059 4.99258 4.38489 5.05582 4.51324 5.13456C4.64344 5.21454 4.74761 5.31994 4.82573 5.45077C4.90757 5.58097 4.97578 5.7493 5.03034 5.95577C5.08614 6.1641 5.14101 6.42078 5.19496 6.72583C5.20703 6.80096 5.24366 6.86997 5.29912 6.92207ZM19.2197 21.8926C19.2951 21.9623 19.3941 22.0008 19.4968 22.0002C19.6013 22.0021 19.7035 21.9636 19.7803 21.8926C19.8603 21.8213 19.9121 21.7238 19.9263 21.6176C19.9902 21.1898 20.0584 20.8288 20.1309 20.5346C20.1881 20.2822 20.2818 20.0394 20.4091 19.814C20.5178 19.629 20.6714 19.4743 20.8556 19.3642C21.0752 19.2412 21.3125 19.1528 21.559 19.102C21.9024 19.0261 22.2496 18.9692 22.5992 18.9314C22.7091 18.9249 22.8121 18.876 22.8868 18.7952C22.9615 18.7143 23.002 18.6077 22.9999 18.4976C22.9992 18.3896 22.9616 18.2951 22.887 18.2141C22.8152 18.1338 22.7207 18.084 22.6035 18.0649C22.1935 18.0066 21.8482 17.944 21.5675 17.8773C21.2897 17.8105 21.0606 17.7216 20.8801 17.6108C20.6997 17.4999 20.5526 17.3528 20.4389 17.1695C20.3252 16.9861 20.2293 16.7502 20.1511 16.4617C20.0758 16.1704 20.0009 15.8108 19.9263 15.383C19.9112 15.2764 19.8583 15.1787 19.7771 15.108C19.6989 15.0362 19.6058 15.0003 19.4978 15.0003C19.3932 14.9992 19.2919 15.0377 19.2143 15.108C19.1343 15.1787 19.0838 15.2768 19.0726 15.383C19.0094 15.8108 18.9415 16.1718 18.869 16.466C18.7973 16.7573 18.7028 16.9975 18.5855 17.1865C18.4719 17.3727 18.3234 17.5227 18.1401 17.6364C17.9575 17.7472 17.7241 17.8346 17.4399 17.8986C17.1571 17.9625 16.8089 18.018 16.3954 18.0649C16.2861 18.075 16.185 18.1269 16.113 18.2098C16.0377 18.2908 16 18.3868 16 18.4976C15.9992 18.6037 16.0379 18.7064 16.1087 18.7854C16.183 18.8655 16.2829 18.9171 16.3911 18.9314C16.8054 18.9918 17.151 19.0558 17.4281 19.1233C17.671 19.175 17.9041 19.265 18.1187 19.3898C18.2984 19.4988 18.4485 19.6503 18.5557 19.8311C18.6851 20.052 18.782 20.2903 18.8435 20.5389C18.9216 20.8302 18.998 21.1898 19.0726 21.6176C19.0896 21.7231 19.1414 21.8199 19.2197 21.8926Z",fill:"currentColor"})}),i=e=>(0,a.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e,children:(0,a.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8.7587 23H15.2413H15.2414C16.0463 23 16.7107 23 17.2518 22.9558C17.8139 22.9099 18.3306 22.8113 18.816 22.564C19.5686 22.1805 20.1805 21.5686 20.564 20.816C20.8113 20.3306 20.9099 19.8139 20.9558 19.2518C21 18.7106 21 18.0463 21 17.2413V13.5C21 12.9477 20.5523 12.5 20 12.5C19.4477 12.5 19 12.9477 19 13.5V17.2C19 18.0566 18.9992 18.6389 18.9624 19.089C18.9266 19.5274 18.8617 19.7516 18.782 19.908C18.5903 20.2843 18.2843 20.5903 17.908 20.782C17.7516 20.8617 17.5274 20.9266 17.089 20.9624C16.6389 20.9992 16.0566 21 15.2 21H8.8C7.94342 21 7.36113 20.9992 6.91104 20.9624C6.47262 20.9266 6.24842 20.8617 6.09202 20.782C5.7157 20.5903 5.40973 20.2843 5.21799 19.908C5.1383 19.7516 5.07337 19.5274 5.03755 19.089C5.00078 18.6389 5 18.0566 5 17.2V6.8C5 5.94342 5.00078 5.36113 5.03755 4.91104C5.07337 4.47262 5.1383 4.24842 5.21799 4.09202C5.40973 3.7157 5.7157 3.40974 6.09202 3.21799C6.24842 3.1383 6.47262 3.07337 6.91104 3.03755C7.36113 3.00078 7.94342 3 8.8 3H11.5C12.0523 3 12.5 2.55228 12.5 2C12.5 1.44772 12.0523 1 11.5 1H8.75868C7.95372 0.999987 7.28937 0.999978 6.74818 1.04419C6.18608 1.09012 5.66937 1.18868 5.18404 1.43597C4.43139 1.81947 3.81947 2.43139 3.43598 3.18404C3.18868 3.66937 3.09012 4.18608 3.04419 4.74818C2.99998 5.28937 2.99999 5.95372 3 6.75869V6.7587V17.2413V17.2413C2.99999 18.0463 2.99998 18.7106 3.04419 19.2518C3.09012 19.8139 3.18868 20.3306 3.43598 20.816C3.81947 21.5686 4.43139 22.1805 5.18404 22.564C5.66937 22.8113 6.18608 22.9099 6.74818 22.9558C7.28935 23 7.95367 23 8.75859 23H8.7587ZM12.0062 14.515H10.3301V17.0722C10.3301 17.4378 10.2438 17.7151 10.0713 17.904C9.89877 18.093 9.68105 18.1875 9.41813 18.1875C9.1429 18.1875 8.92107 18.0951 8.75264 17.9102C8.58421 17.7212 8.5 17.446 8.5 17.0845V10.1215C8.5 9.7189 8.59243 9.43134 8.77729 9.2588C8.96215 9.08627 9.25587 9 9.65845 9H12.0062C12.7004 9 13.2344 9.0534 13.6083 9.16021C13.978 9.26291 14.2964 9.43339 14.5634 9.67165C14.8345 9.90992 15.0399 10.2016 15.1796 10.5467C15.3192 10.8917 15.3891 11.2799 15.3891 11.7113C15.3891 12.6315 15.1056 13.3298 14.5387 13.8063C13.9718 14.2788 13.1276 14.515 12.0062 14.515ZM11.5625 10.3741H10.3301V13.1347H11.5625C11.9938 13.1347 12.3533 13.0895 12.6408 12.9991C12.9325 12.9087 13.1543 12.7609 13.3063 12.5555C13.4583 12.3501 13.5343 12.081 13.5343 11.7482C13.5343 11.3498 13.4173 11.0252 13.1831 10.7746C12.9202 10.5076 12.38 10.3741 11.5625 10.3741ZM17.9972 10.9998C17.8458 10.9998 17.7129 10.9484 17.5986 10.8456V10.8442C17.4872 10.7404 17.4182 10.6094 17.3915 10.4514C17.2829 9.84099 17.1734 9.32727 17.0629 8.9102C16.9525 8.49884 16.8158 8.16176 16.6529 7.89894C16.4939 7.63708 16.2858 7.42712 16.0287 7.26905C15.7696 7.11098 15.4401 6.98434 15.0401 6.88912C14.6439 6.79294 14.1501 6.70153 13.5587 6.61488C13.3968 6.59107 13.2621 6.52156 13.1544 6.40634C13.0516 6.29208 13.0002 6.15544 13.0002 5.99641C12.9984 5.9209 13.0116 5.84579 13.0391 5.77543C13.0666 5.70507 13.1077 5.64085 13.1602 5.58648C13.2645 5.46863 13.4093 5.39421 13.5659 5.37795C14.1573 5.31034 14.6544 5.23083 15.0573 5.13942C15.4081 5.06766 15.7455 4.94139 16.0572 4.7652C16.3176 4.60452 16.536 4.3842 16.6944 4.12245C16.8817 3.8027 17.0181 3.45575 17.0986 3.09406C17.2194 2.58317 17.3167 2.067 17.3901 1.54718C17.4079 1.39601 17.48 1.25644 17.5929 1.15439C17.7019 1.05232 17.8465 0.996949 17.9958 1.00013C18.1441 0.997697 18.2875 1.05301 18.3958 1.15439C18.5119 1.25544 18.588 1.39482 18.61 1.54718C18.7177 2.1585 18.8248 2.67222 18.9315 3.08834C19.0195 3.44315 19.1575 3.78365 19.3414 4.0996C19.499 4.35618 19.7148 4.57199 19.9714 4.72949C20.2771 4.90588 20.6081 5.03403 20.9528 5.10942C21.3547 5.2056 21.8485 5.29511 22.4342 5.37795C22.5904 5.39952 22.7341 5.47536 22.8399 5.5922C22.9445 5.70059 23.002 5.84586 22.9999 5.99641C23.0021 6.15308 22.944 6.30459 22.8377 6.41968C22.7314 6.53477 22.5849 6.60464 22.4285 6.61488C21.9284 6.66762 21.4319 6.74965 20.9414 6.86055C20.5376 6.95196 20.2024 7.0767 19.9357 7.23477C19.6738 7.39284 19.4619 7.60709 19.3 7.87752C19.1167 8.19857 18.9824 8.54519 18.9015 8.90591C18.7986 9.32584 18.7015 9.84147 18.61 10.4528C18.5895 10.6044 18.5155 10.7436 18.4015 10.8456C18.2921 10.948 18.147 11.0034 17.9972 10.9998Z",fill:"currentColor"})})},40141:function(e,t,r){"use strict";var a=r(52676),l=r(75271),o=r(46571),n=r(13005),i=r(81943),s=r(57546),d=r(44342),c=r(27378),u=r(60635),p=r(5311),h=r(43378),g=r(25010),m=r(7717);t.Z=e=>{let{className:t,hideAppCloseButton:r,children:f}=e,v=(0,m.useTranslations)(),{isApp:x}=(0,d.b)(),b=(0,c.Z)(e=>e.features),{pendingQueries:w}=(0,p.Z)(),[C,y]=(0,l.useState)(!1);return x&&b.includes("topBar")?null:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("header",{className:(0,o.cn)("sticky top-0 z-20","flex items-center gap-1 md:gap-3 px-2 md:px-6 py-3 h-16","bg-background border-b border-theme-border-100 dark:border-theme-border-dark-100",!f&&"md:hidden",t),children:[x?(0,a.jsx)("button",{className:(0,o.cn)("block h-8 w-8 px-1 mr-2 z-30 rounded-3xl cursor-pointer","bg-[#f6f7f9] dark:bg-[#454e5d]",r&&"hidden"),onClick:()=>{if(w.length>0){y(!0);return}(0,u.WU)()},children:(0,a.jsx)(n.Z,{size:24,className:"text-[#5f7698] dark:text-white"})}):(0,a.jsx)("button",{className:"block md:hidden px-2 mr-2 z-30 cursor-pointer",onClick:()=>{let{sidebarVisible:e,setSidebarVisible:t}=s.Z.getState();t(!e)},children:(0,a.jsx)(i.Z,{size:24})}),f]}),(0,a.jsx)(h.Vq,{open:C,onOpenChange:y,children:(0,a.jsxs)(h.cZ,{className:"sm:max-w-[425px] rounded-lg w-[calc(100%-4rem)] dark:bg-[#454e5d]",hideCloseButton:!0,children:[(0,a.jsxs)(h.fK,{className:"text-center",children:[(0,a.jsx)(h.$N,{className:"text-lg font-medium mb-4",children:v("agent.exit_confirm.title")}),(0,a.jsx)(h.Be,{className:"text-base text-left",children:v("agent.exit_confirm.description")})]}),(0,a.jsxs)(h.cN,{className:"flex flex-row gap-3 mt-4",children:[(0,a.jsx)(g.z,{variant:"outline",className:"flex-1 rounded-md text-base py-6 dark:bg-[#202531]",onClick:()=>y(!1),tabIndex:-1,children:v("agent.exit_confirm.cancel")}),(0,a.jsx)(g.z,{className:"flex-1 rounded-md bg-[#e04e2e] hover:bg-[#c23b1e] dark:bg-[#d14625] dark:hover:bg-[#d14625] text-white text-base py-6",onClick:()=>{y(!1),(0,u.WU)()},tabIndex:-1,children:v("agent.exit_confirm.confirm")})]})]})})]})}},35030:function(e,t,r){"use strict";let a;var l=r(52676),o=r(9455),n=r(64657),i=r(5687),s=r(55383),d=r(93650),c=r(26595),u=r(93071),p=r(7717),h=r(18881),g=r(64787),m=r(75271),f=r(40341),v=r(94572),x=r(72070),b=r.n(x),w=r(39344),C=r(27934),y=r(31063),j=r(60161),F=r(39109);let _=0;async function S(e){let{threadId:t,jobId:r,time:l,businessType:o}=e;return new Promise(e=>{a=setInterval(async()=>{++_>=10&&(clearInterval(a),e({editUrl:"",thumbnailUrl:""}));let l=await (0,f.IQ)({threadId:t,jobId:r,businessType:o});console.log("\uD83D\uDE80 ~ interval=setInterval ~ res:",l),(null==l?void 0:l.status)==="success"?(e({editUrl:null==l?void 0:l.editUrl,thumbnailUrl:null==l?void 0:l.thumbnailUrl}),clearInterval(a)):(null==l?void 0:l.status)==="failed"?(e({editUrl:"",thumbnailUrl:""}),clearInterval(a)):console.log("未获取继续轮询...")},l||5e3)})}let k=(0,m.forwardRef)((e,t)=>{let{threadId:r,businessType:a}=e,x=(0,p.useTranslations)(),{isCanvaAuthorized:_,setIsCanvaAuthorized:k,isCanvaConnectedLoading:T,setIsCanvaConnectedLoading:I,isOpenCanvaEditorLoading:N,setIsOpenCanvaEditorLoading:P,setIsReauthorized:D,isShowCanvaModal:E,setIsShowCanvaModal:O,isImportLoading:B,setIsImportLoading:L,design:Z,setDesign:A}=(0,h.Z)(),z=(0,F.Z)(),{isOpen:U,onClose:R,onOpen:M,onOpenChange:V}=(0,o.q)(),q=async e=>{let{threadId:t,businessType:r}=e;try{let{status:e}=await (0,g.Es)({threadId:t,businessType:r});return k(e),e}catch(e){return console.error("Error checking authorization:",e),k(!1),!1}},H=async()=>{T||(I(!0),await (0,g.Iv)({threadId:r,businessType:a})?(k(!1),z.default(x("ppt.canva_disconnected")),R()):z.default(x("ppt.canva_disconnect_failed")),I(!1))},W=async()=>{I(!0);try{if(await (0,g.qf)({threadId:r,businessType:a}))return k(!0),z.default(x("ppt.canva_connected")),!0;return k(!1),z.default(x("ppt.canva_connect_failed")),!1}catch(e){return console.error(e),k(!1),z.default(x("ppt.canva_connect_failed")),!1}finally{I(!1)}},G=async()=>{L(!0),P(!0);try{let e=await (0,f.$E)({threadId:r,businessType:a});if(!e)return z.default(x("ppt.import_ppt_failed")),!1;let t=await S({time:5e3,jobId:e,threadId:r,businessType:a}),l=null==t?void 0:t.editUrl;if(!l)return z.default(x("ppt.import_ppt_failed")),!1;return(0,v.bs)({threadId:r,canvaEditUrl:l,canvaThumbnailUrl:null==t?void 0:t.thumbnailUrl}),A(t),window.open(l),M(),!0}catch(e){if(console.error(e,null==e?void 0:e.message),!h.Z.getState().isReauthorized&&(null==e?void 0:e.message)==="CANVA_GET_TOKEN_FAIL")return R(),P(!0),k(!1),D(!0),X(!0),!1;return z.default(x("ppt.import_ppt_failed")),!1}finally{L(!1)}},X=async e=>{P(!0);let t=await q({threadId:r,businessType:a});if(!0!==e&&t){let{canvaEditUrl:e,canvaThumbnailUrl:t}=(0,v.OW)({threadId:r});if(M(),!e){if(!await G()){P(!1),R();return}P(!1);return}A({editUrl:e,thumbnailUrl:t}),(0,y.fk)(j.U.THREAD_CANVA_EDIT,{id:r},!0),window.open(e),P(!1);return}if((0,y.fk)(j.U.THREAD_CONNECT_CANVA,{id:r},!0),!await W()){P(!1);return}if(M(),!await G()){P(!1),R();return}P(!1)};return(0,m.useImperativeHandle)(t,()=>({openCanvaEditor:X,revokeCanva:H})),(0,m.useEffect)(()=>{U?O(!0):O(!1)},[U]),(0,m.useEffect)(()=>{E?M():R()},[E]),(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(n.R,{isOpen:U,isDismissable:!1,onOpenChange:V,classNames:{base:"max-w-lg max-h-[80dvh] min-h-[300px]",body:"justify-center items-center",footer:"justify-center"},children:(0,l.jsxs)(i.A,{children:[(0,l.jsx)(s.k,{className:"flex flex-col gap-1"}),(0,l.jsxs)(d.I,{children:[(0,l.jsxs)("div",{className:"flex justify-between items-center w-[300px] relative mb-4",children:[(0,l.jsx)(b(),{src:"/icon.svg",alt:"check",width:80,height:80,className:"shadow-lg rounded-full relative z-10"}),(0,l.jsx)("div",{className:"relative z-10 bg-white rounded-full dark:bg-slate-800",children:N?(0,l.jsx)(C.Z,{className:"text-primary animate-spin"}):(0,l.jsx)(w.NhS,{color:"#4ba570",className:"w-[26px] h-[26px]"})}),(0,l.jsx)("div",{className:"w-[80px] h-[80px] border border-gray-200 rounded-full flex justify-center items-center shadow-lg relative z-10 bg-white dark:bg-slate-800 dark:border-slate-400",children:(0,l.jsx)(b(),{src:"/canva.svg",width:50,height:50,alt:"Canva"})}),(0,l.jsx)("hr",{className:"border-dashed border w-full absolute left-0 top-1/2 -translate-y-1/2 z-0 dark:bg-slate-600"})]}),N?(0,l.jsxs)("div",{children:[(0,l.jsx)("h4",{className:"text-lg mb-2 text-center",children:x("ppt.please_wait")}),(0,l.jsx)("p",{className:"text-center text-sm opacity-60",children:x("ppt.canva_import_loading")})]}):(0,l.jsxs)("div",{className:"max-w-xs mx-auto",children:[(0,l.jsx)(c.A,{className:"w-full bg-purple-500 mb-4",color:"primary",as:u.O,href:null==Z?void 0:Z.editUrl,target:"_blank",onClick:()=>{(0,y.fk)(j.U.THREAD_CANVA_EDIT,{id:r},!0)},children:x("ppt.edit_in_canva")}),(0,l.jsx)("p",{className:"text-sm opacity-60 text-center",children:x.rich("canva.cancel_connected",{link:e=>(0,l.jsx)("a",{href:"javascript:void(0)",className:"text-primary",onClick:H,children:e})})})]})]})]})})})});k.displayName="ConnectCanva",t.Z=k},7363:function(e,t,r){"use strict";r.d(t,{Z:function(){return Q}});var a=r(52676),l=r(75271),o=r(9455),n=r(26595),i=r(33935),s=r(64657),d=r(5687),c=r(55383),u=r(93650),p=r(49983),h=r(69863),g=r(13005),m=r(7717),f=r(18881),v=r(45360),x=r(77998),b=r(94572),w=r(31063),C=r(60161),y=r(30674),j=r(44417),F=r(72932),_=r(41426),S=r(4814),k=r(78467),T=r(86386),I=r.n(T);let N=e=>{let{templateColourId:t,setTemplateColourId:r,templateStyleId:l,setTemplateStyleId:o,templateColourOptions:i,templateStyleOptions:s}=e,d=(0,m.useTranslations)();return(0,a.jsxs)("div",{className:"p-2 m-2 mt-0 border border-gray-200 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("div",{className:"w-[60px]  text-gray-700 text-sm pt-0 md:pt-1.5 font-medium dark:text-gray-400",children:d("ppt.select_colour")}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-1 md:gap-2 w-[calc(100%-60px)]",children:[(0,a.jsx)(n.A,{className:(0,S.Z)("rounded-full p-0 h-[24px] w-[24px] min-w-0 border relative before:absolute before:left-0 before:top-0 before:rounded-full  before:border before:border-white dark:before:border-[#18181B]","h-[19px] w-[19px] before:h-[17px] before:w-[17px]","md:h-[24px] md:w-[24px] md:before:h-[22px] md:before:w-[22px]",I()["bg--colors"],t?"":"border-primary"),onPress:()=>{r("")}}),i.map(e=>(0,a.jsx)(n.A,{onPress:()=>{r(String(e.id))},className:(0,S.Z)("rounded-full p-0 min-w-0 border relative before:absolute before:left-0 before:top-0 before:rounded-fullbefore:border before:border-white hover:border-primary dark:before:border-[#18181B]","h-[20px] w-[20px] before:h-[18px] before:w-[18px]","md:h-[24px] md:w-[24px] md:before:h-[22px] md:before:w-[22px]",t===String(e.id)?"border-primary":"inherit"),style:{backgroundColor:e.code}},e.id))]})]}),(0,a.jsxs)("div",{className:"flex mt-3 md:mt-4",children:[(0,a.jsx)("div",{className:"w-[60px] text-gray-700 text-sm pt-0 md:pt-1.5 font-medium dark:text-gray-400",children:d("ppt.select_style")}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-1 md:gap-2 w-[calc(100%-60px)]",children:[(0,a.jsx)(n.A,{onPress:()=>{o("")},className:(0,S.Z)("rounded-full px-3 py-0 gap-1 border min-w-0 dark:border-0","px-2 md:px-3 py-0 h-6 md:h-8",l?"text-gray-500":""),size:"sm",color:l?void 0:"primary",variant:l?"bordered":void 0,children:d("ppt.all_option")}),s.map(e=>(0,a.jsx)(n.A,{onPress:()=>{o(String(e.id))},className:(0,S.Z)("rounded-full gap-1 border min-w-0 dark:border-0","px-2 md:px-3 py-0 h-6 md:h-8",l===String(e.id)?"":"text-gray-500 "),size:"sm",variant:l===String(e.id)?void 0:"ghost",color:l===String(e.id)?"primary":void 0,children:e.title},e.id))]})]})]})};var P=e=>{let{templateList:t,templateId:r,setTemplateId:l}=e;return(0,a.jsx)("ul",{className:(0,S.Z)("grid overflow-y-auto grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 md:pr-2"),children:t.map(e=>(0,a.jsx)("li",{className:(0,S.Z)("rounded cursor-pointer",{"border-[#0370EF] border-2":r===e.id},I()["bg--ppt"],"bg--ppt"),onClick:()=>{l(e.id)},children:(0,a.jsx)("div",{className:(0,S.Z)("rounded border",I()["bg--ppt__img"],"dark:border-gray-500"),children:(0,a.jsx)("img",{src:e.cover_img,alt:e.id.toString()})})},e.id))})},D=r(82180),E=r(81501),O=r(11122),B=r(65550);let L=()=>(0,a.jsx)("div",{className:"flex justify-center items-center min-h-[calc(60dvh)] md:min-h-[calc(77vh-200px)]",children:(0,a.jsx)(O.w,{className:"space-y-10 p-4 border-0",fullWidth:!0,radius:"none",shadow:"none",children:(0,a.jsx)("div",{className:"space-y-6",children:[1,2,3,4,5].map((e,t)=>(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)(B.X,{className:"w-3/5 rounded-lg",children:(0,a.jsx)("div",{className:"h-3 w-3/5 rounded-lg bg-default-200"})}),(0,a.jsx)(B.X,{className:"w-4/5 rounded-lg",children:(0,a.jsx)("div",{className:"h-3 w-4/5 rounded-lg bg-default-200"})}),(0,a.jsx)(B.X,{className:"w-2/5 rounded-lg",children:(0,a.jsx)("div",{className:"h-3 w-2/5 rounded-lg bg-default-300"})})]},"".concat(e,"_").concat(t)))})})});var Z=e=>{let{handleRegenerateOutline:t}=e,r=(0,l.useRef)(null),{outlineLoading:o,outlineStatus:n,outline:i}=(0,x.Z)(),s=async()=>{await (0,b.gw)(4e3),r.current&&r.current.scrollIntoView(!1)};return(0,l.useEffect)(()=>{s()},[i]),(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("div",{className:"h-[calc(70dvh+76px)] py-2 text-gray-700 mx-2 dark:text-gray-400 relative md:h-[calc(80dvh)] overflow-hidden",children:o?(0,a.jsx)(L,{}):"error"===n?(0,a.jsx)(k.Z,{type:"error",message:i,handleOpen:t}):(0,a.jsx)("div",{className:(0,S.Z)("prose prose-md dark:prose-invert max-w-full","h-[calc(70dvh+60px)] md:h-[calc(80dvh-30px)]"," felo--scrollbar overflow-y-auto","border border-gray-200 rounded-lg dark:border-gray-800"),children:(0,a.jsx)("div",{ref:r,className:(0,S.Z)("mx-4 my-5"),children:(0,a.jsx)(E.Z,{children:i})})})})})},A=r(35063),z=r(84706),U=r(65105),R=r(97247),M=r(65819),V=r(24213),q=r(39109);let H=(0,l.forwardRef)((e,t)=>{let{templateLoading:r,templateOptionsStatus:o,templateSceneOptions:i,handleOpen:s,showMoreTemplateOptions:d,setShowMoreTemplateOptions:c,templateStyleOptions:u,templateStyleId:p,setTemplateStyleId:h,templateColourOptions:g,setTemplateColourId:v,templateColourId:w,templateStatus:C,templateList:T,templateId:I,setTemplateId:E,templateListLoading:O,hasNextPage:B,loaderMoreRef:L,currentPage:H,templateEmptyRef:W,isOpenRetry:G,handleDownload:X,shortId:K}=e,J=(0,m.useTranslations)(),Q=(0,m.useLocale)(),{pptStatus:$,setPptStatus:Y,setOutlineLoading:ee,setOutline:et,setOutlineStatus:er,setGeneratePptProgress:ea,updateGeneratePptProgress:el,clearUpdateGeneratePptProgress:eo,setPptDetail:en,pptDetail:ei,isPptLoading:es,setIsPptLoading:ed,setTemplateStatus:ec,isLoadingButton:eu,getOutline:ep}=(0,x.Z)(),{isPdfLoaded:eh,setIsRegenerate:eg,setCoverUrl:em,coverUrl:ef}=(0,f.Z)(),ev=(0,q.Z)(),{mergedSources:ex}=(0,A.Z)(),eb=(0,M.ZP)(e=>{var t;return null===(t=e.userInfo)||void 0===t?void 0:t.language}),ew=async e=>{e=null==e||e,Y("generate"),ee(!0),er("init"),ec("init"),ea(0),em(""),A.Z.getState().setMergedSourcesPptCover("");let t=(0,b.NV)({lang:eb||"",locale:Q});console.log("\uD83D\uDE80 ~ handleGenerateOutline ~ outputLang:",t);try{var r,a,l,o,n;let{templateId:i}=(0,b.OW)({threadId:K}),s=I||i;(0,b.bs)({threadId:K,isProgress:!0}),en({status:b.nV.OUTLINE}),ea(1),el({maxProgress:70,increment:2,interval:2e3,threadId:K});let d=await ep({thread_id:K,template_id:String(s),stream:e,language:t});if((null==d?void 0:null===(r=d.data)||void 0===r?void 0:r.status)===402){eo(),ee(!1),et(""),Y("init"),er("init"),ec("init"),ea(0),en({status:b.nV.TIMEOUT}),z.$.publish("showSubscriptionPlan",void 0);return}if((null==d?void 0:null===(a=d.data)||void 0===a?void 0:a.status)===507){eo(),ee(!1),et(""),Y("init"),er("init"),ec("init"),ea(0),en({status:b.nV.TIMEOUT}),ev.default(J("ppt.generate_warn_tip"));return}if(!(null==d?void 0:null===(l=d.data)||void 0===l?void 0:l.outline)){eo(),Y("init"),ea(0),ee(!1),et(""),er("error");return}U.ZP.getState().reduceSubscriptioUsageTimes({featureName:"pptUsage"}),ea(70),eo(),e||et(null===(n=d.data.outline)||void 0===n?void 0:null===(o=n.replace("```markdown",""))||void 0===o?void 0:o.replaceAll("```","")),ee(!1),(0,b.bs)({threadId:K,status:b.nV.OUTLINE}),en({status:b.nV.OUTLINE}),el({maxProgress:95,increment:1,interval:1e3,threadId:K});let c=await (0,b.TT)({threadId:K});if(eo(),Y("preview"),!c){er("error");return}ed(!0),console.log("newPptDetail",c),(0,b.bs)({threadId:K,expiryTime:Date.now()+348e4,pptUrl:null==c?void 0:c.ppt_url,templateId:s,pdfUrl:null==c?void 0:c.pdf_url,isProgress:!1}),en({cover_url:null==c?void 0:c.cover_url,ppt_url:null==c?void 0:c.ppt_url,pdf_url:null==c?void 0:c.pdf_url,status:b.nV.SUCCESS}),ed(!1)}catch(e){console.log("handleGenerateOutline error",e),ee(!1),er("error")}},eC=async()=>{eg(!0),ew(!1)};return((0,l.useImperativeHandle)(t,()=>({handleRegenerateOutline:eC})),!(0,R.N0)()&&eu)?null:(0,a.jsxs)("div",{className:"flex flex-col h-full",children:["init"===$?r?(0,a.jsx)("div",{className:"flex justify-center items-center h-[70dvh] md:h-[calc(80dvh-1rem)]",children:(0,a.jsx)(y.c,{size:"sm",label:J("ppt.loading_template")})}):"error"!==o||(null==i?void 0:i.length)?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"flex p-2 gap-2 justify-between",children:(0,a.jsx)("div",{className:"flex gap-2 items-center",children:(0,a.jsx)(n.A,{className:"rounded-full px-3 py-0 gap-1 border text-gray-500",size:"sm",variant:"bordered",startContent:(0,a.jsx)(j.Z,{size:12}),endContent:d?(0,a.jsx)(F.Z,{size:12}):(0,a.jsx)(_.Z,{size:12}),onPress:()=>{c(!d)},children:J("ppt.all_filter")})})}),d?(0,a.jsx)(N,{templateColourOptions:g,templateStyleOptions:u,setTemplateColourId:v,setTemplateStyleId:h,templateColourId:w,templateStyleId:p}):null,"error"===C?(0,a.jsx)(k.Z,{type:"error",handleOpen:s}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:(0,S.Z)("overflow-y-auto","relative","felo--scrollbar","p-2 pt-0"),children:[(null==T?void 0:T.length)?(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(P,{templateList:T,templateId:I,setTemplateId:E})}):O?null:(0,a.jsx)("div",{ref:W,className:"hidden",children:(0,a.jsx)(k.Z,{handleOpen:s,type:"empty"})}),(O||B)&&(0,a.jsx)("div",{ref:L,className:(0,S.Z)("flex justify-center items-center w-full ",H<=1?"h-[calc(70dvh-300px)] md:h-[calc(80dvh-220px)]]":"my-4"),children:(0,a.jsx)(y.c,{size:"sm",label:J("ppt.loading_template")})})]}),(null==T?void 0:T.length)?(0,a.jsx)("div",{className:"flex justify-center p-2 w-full",children:(0,a.jsx)(n.A,{className:"rounded-full gap-1 border-1 dark:border-0 w-full",color:"primary",size:"md",startContent:(0,a.jsx)(V.$U,{className:"w-[24px]"}),isDisabled:!I,onPress:()=>{console.log("\uD83D\uDE80 ~ handleGenerateOutline"),ew()},children:J("ppt.generate_ppt_btn")})}):null]})]}):(0,a.jsx)(k.Z,{type:"error",handleOpen:s}):null,"generate"===$?(0,a.jsx)(Z,{handleRegenerateOutline:eC}):null,(0,a.jsxs)("div",{className:(0,S.Z)("relative flex flex-col h-full","preview"===$?"":"hidden"),children:[(0,a.jsxs)("div",{className:(0,S.Z)("flex flex-1 justify-center items-center absolue z-[-1] inset-0",es?"":"hidden"),children:[(0,a.jsx)(y.c,{size:"sm",className:"mr-2"}),J("ppt.generate_outline_loading")]}),(0,a.jsx)("div",{className:(0,S.Z)("flex flex-wrap justify-between","mx-[-24px]",es?"opacity-0":"opacity-100"),children:(0,a.jsx)("div",{className:(0,S.Z)("flex flex-col flex-grow h-full w-full justify-center m-[20px] mt-0 overflow-hidden rounded-lg felo--pdfviewer felo--mobile__pdfviewer"),children:(null==ei?void 0:ei.pdf_url)&&"error"!==$?(0,a.jsx)(D.Z,{fileUrl:(null==ei?void 0:ei.ppt_url)||"",shortId:K,isOpenRetry:G,handleGeneratePpt:eC,handleDownload:X,pdfFileUrl:null==ei?void 0:ei.pdf_url}):es||!ei?null:(0,a.jsx)(k.Z,{type:"error",handleOpen:eC})})}),eh?null:(0,a.jsx)("div",{className:(0,S.Z)("absolute left-0 right-0 top-0 z-40","h-[calc(80dvh-80px)] mt-2","bg-contain bg-center bg-no-repeat","opacity-50 pointer-events-none"),style:{backgroundImage:"url(".concat((null==ei?void 0:ei.cover_url)?null==ei?void 0:ei.cover_url:"",")")}})]})]})});H.displayName="MobileView";var W=r(44342),G=r(60635),X=r(41223),K=r(99178),J=r.n(K),Q=e=>{let{shortId:t}=e,r=(0,m.useTranslations)(),y=(0,m.useLocale)(),{isShowPptModal:j,setIsShowPptModal:F,isRegenerate:_,setIsRegenerate:k,isMyThread:T,setShowPpt:I}=(0,f.Z)(),N=(0,q.Z)(),{generatePptProgress:P,pptStatus:D,pptModalType:E,templateStatus:O,setTemplateStatus:B,updatePptGenerateStatusList:L,setPptStatus:Z,setGeneratePptProgress:A,isHiddenModal:z,pptDetail:U}=(0,x.Z)(),{isApp:M}=(0,W.b)(),{isOpen:K,onOpen:Q,onClose:$}=(0,o.q)(),Y=(0,l.useRef)(null),ee=(0,l.useRef)(null),et=(0,l.useRef)(null),er=(0,l.useRef)(null),ea=(0,l.useRef)(null),[el,eo]=(0,l.useState)(!0),[en,ei]=(0,l.useState)(!0),[es,ed]=(0,l.useState)([]),[ec,eu]=(0,l.useState)([]),[ep,eh]=(0,l.useState)([]),[eg,em]=(0,l.useState)([]),[ef,ev]=(0,l.useState)("init"),[ex,eb]=(0,l.useState)(),[ew,eC]=(0,l.useState)(""),[ey,ej]=(0,l.useState)(""),[eF,e_]=(0,l.useState)(""),[eS,ek]=(0,l.useState)(1),[eT,eI]=(0,l.useState)(!1),[eN,eP]=(0,l.useState)({templateColourId:"",templateStyleId:"",templateSceneId:""}),[eD,eE]=(0,l.useState)(!0),[eO,eB]=(0,l.useState)(!1),eL=()=>{$(),console.log("modal handleClose"),I("0"),k(!1),L();let e=t?"".concat(location.origin,"/search/").concat(t):location.href;history.replaceState({},"",e),F(!1)},eZ=(0,l.useCallback)(async()=>{var e,r;eo(!0),eE(!0),ei(!1),B("init");let a=await (0,v.RM)({thread_id:t,scene_id:eF,style_id:ey,colour_id:ew,page:String(eS),page_size:"24"});if((null==a?void 0:a.status)!==200){B("error"),eE(!1);return}let l=(null==a?void 0:null===(e=a.data)||void 0===e?void 0:e.list)||[],o=(null==a?void 0:null===(r=a.data)||void 0===r?void 0:r.pagination)||{},n=Math.ceil((null==o?void 0:o.total)/(null==o?void 0:o.page_size)),i=o.current_page<n;ed(e=>[...e,...l]),eo(i),ek(e=>e+1),eE(!1)},[eF,eS,ew,ey,eD]),eA=async e=>{let{type:r}=e;if(Q(),!(null==eg?void 0:eg.length)){let e=await (0,v.ax)({thread_id:t});if(!e){ei(!1),ev("error");return}em((null==e?void 0:e.suit_scene)||[]),eh((null==e?void 0:e.suit_style)||[]),eu((null==e?void 0:e.colour)||[])}ei(!1),await eZ()},ez=e=>{if((0,w.fk)(T?C.U.AUTHOR_DOWNLOAD_PPT:C.U.DOWNLOAD_PPT,{value:t},!0),M){e.preventDefault(),e.stopPropagation(),(0,G.vE)({url:(null==U?void 0:U.ppt_url)||""});return}if((0,R.s)()&&!(0,X.G6)()){e.preventDefault(),e.stopPropagation(),N.default(r("ppt.download_ppt_tip")),J()(()=>{window.open((null==U?void 0:U.ppt_url)||"","_blank")},3e3);return}},eU=()=>{(0,w.fk)(C.U.REGENERATE_PPT,{value:"generate"},!0),k(!0),Z("init"),A(0),eA({})},eR=async()=>{console.log("ppt mobile modal init"),j&&(Q(),"generate"===E&&await eA({}))};return(0,l.useEffect)(()=>{eR()},[j]),(0,l.useEffect)(()=>{!eD&&et.current&&setTimeout(()=>{var e;null===(e=et.current)||void 0===e||e.classList.remove("hidden")},1e3)},[eD]),(0,l.useEffect)(()=>{ea.current&&ea.current.disconnect();let{expiryTime:e,pptUrl:r}=(0,b.OW)({threadId:t}),a=(0,b.XQ)({expiryTime:e});if(!r||a||_)return((null==eN?void 0:eN.templateColourId)!==ew||(null==eN?void 0:eN.templateStyleId)!==ey)&&(ed([]),ek(1),ei(!1),eE(!0),eo(!0)),"error"===O&&(ed([]),eE(!0),B("init")),ea.current=new IntersectionObserver(e=>{e[0].isIntersecting&&setTimeout(async()=>{await eZ(),eP({templateColourId:ew,templateStyleId:ey,templateSceneId:eF})},300)}),er.current&&ea.current.observe(er.current),()=>{ea.current&&ea.current.disconnect()}},[er.current,eF,eS,ew,ey]),(0,l.useEffect)(()=>{z&&(0,b.F_)()},[z]),(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(s.R,{ref:Y,isOpen:K,isDismissable:!1,scrollBehavior:"inside",backdrop:"opaque",classNames:{header:"block p-0 py-1 bg-[#F5F7F9] rounded-t-xl dark:bg-gray-800",base:(0,S.Z)("min-w-[80dvw] h-[calc(80dvh+60px)] max-h-[calc(80dvh+60px)] mb-0 mx-2"),footer:"py-0",wrapper:(0,S.Z)(z?"!opacity-0 !pointer-events-none !hidden":""),backdrop:(0,S.Z)(z?"!opacity-0 !pointer-events-none !hidden":"")},closeButton:(0,a.jsx)(a.Fragment,{}),children:(0,a.jsx)(d.A,{children:()=>(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(c.k,{children:[(0,a.jsxs)("div",{className:"flex justify-between items-center py-0 px-1",children:[(0,a.jsxs)("div",{className:"flex justify-start items-center w-full pl-4 text-sm font-bold ",children:["init"===D?r("ppt.select_template"):"generate"===D?P>=75?r("ppt.generating_ppt"):r("ppt.generate_ppt"):"preview"===D?r("ppt.download_ppt"):r("ppt.select_template"),"preview"===D&&(T||M)&&["en","ja","ko","zh-hant"].includes(null==y?void 0:y.toLocaleLowerCase())&&(0,a.jsx)(n.A,{color:"primary",variant:"bordered",className:"rounded-full ml-2 border-1 border-inherit px-3 py-0 h-7 font-normal dark:border-gray-600",size:"sm",onPress:eU,startContent:(0,a.jsx)(V.$U,{className:"w-[24px]"}),children:r("ppt.regenerate")})]}),(0,a.jsx)(n.A,{className:"rounded-full text-[#98A2B3]",isIconOnly:!0,variant:"light",onPress:eL,children:P>0&&P<100?(0,a.jsx)(h.Z,{size:18}):(0,a.jsx)(g.Z,{size:18})})]}),P>0&&P<100&&(0,a.jsx)("div",{className:"w-full flex justify-center items-center",children:(0,a.jsx)(i.W,{size:"sm",radius:"none","aria-label":"Loading...",value:P})})]}),(0,a.jsx)(u.I,{className:"relative h-[72dvh] min-h-[72dvh] p-0 overflow-hidden",children:(0,a.jsx)(H,{ref:ee,templateLoading:en,templateOptionsStatus:ef,templateSceneOptions:eg,handleOpen:eA,showMoreTemplateOptions:eT,setShowMoreTemplateOptions:eI,templateStyleOptions:ep,templateStyleId:ey,setTemplateStyleId:ej,templateColourOptions:ec,setTemplateColourId:eC,templateColourId:ew,templateStatus:O,templateList:es,templateId:null!=ex?ex:0,setTemplateId:eb,templateListLoading:eD,hasNextPage:el,loaderMoreRef:er,currentPage:eS,templateEmptyRef:et,shortId:t,isOpenRetry:eO,handleDownload:ez})}),(0,a.jsx)(p.R,{})]})})})})}},22313:function(e,t,r){"use strict";r.d(t,{Z:function(){return N}});var a=r(52676),l=r(9455),o=r(26595),n=r(64657),i=r(5687),s=r(55383),d=r(93650),c=r(49983),u=r(13005),p=r(75271),h=r(4814),g=r(18881),m=r(31063),f=r(60161),v=r(45360),x=r(30674),b=r(7717),w=r(94572),C=r(78467),y=r(65819),j=r(82180),F=r(65105),_=r(50403),S=r(39109),k=r(50802),T=e=>{let{shortId:t,businessType:r}=e,o=(0,b.useTranslations)(),s=(0,b.useLocale)(),{isOpen:c,onOpen:u,onOpenChange:T}=(0,l.q)(),{isMyThread:I,isPdfLoaded:N,setIsRegenerateLoading:P,setIsShowPptModal:D,setIsPptGenerated:E,uiModalType:O,setSelectedOptionValue:B,setSelectedOptionKey:L,setSelectedOption:Z,setPptBtnKey:A,setPptDetailCache:z,setCoverUrl:U,generateType:R,isGeneratedSuccess:M,setIsGeneratedSuccess:V,agentOutline:q,previewPPTData:H,setPreviewPPTData:W,pptGenerateStep:G,pptLanguage:X}=(0,g.Z)(),{setThreadPptBtnEntrance:K}=(0,k.Z)(),J=(0,S.Z)();(0,y.ZP)(e=>e.isLogin);let Q=(0,y.ZP)(e=>{var t;return null===(t=e.userInfo)||void 0===t?void 0:t.language}),$=(0,p.useRef)(null),[Y,ee]=(0,p.useState)(!1),[et,er]=(0,p.useState)(!1),[ea,el]=(0,p.useState)(),[eo,en]=(0,p.useState)(!1),ei=async()=>{let e=t||(0,w.qR)()||"",a=await (0,v.OQ)({thread_id:e,businessType:r});if(!a)return ee(!0),er(!0),{cacheStatus:null,pptId:0};let{ppt_url:l,pdf_url:o,status:n,id:i}=a;return(W({...H,...a}),!I&&w.Wx.includes(n))?(el("wait"),u(),{cacheStatus:n,pptId:i}):2===n?{pptUrl:l,pdfUrl:o,pptId:i,cacheStatus:n}:{cacheStatus:n,pptId:i}},es=async()=>{P(!0),await ei(),P(!1),en(!1)},ed=async e=>{let{type:a,answers:l,pptId:o}=e;er(!1),ee(!1);let n=(0,w.uN)(s),i=(0,w.BN)({lang:Q||"",locale:s});console.log("\uD83D\uDE80 ~ initAipptIframe ~ lang:",n,i);try{var d,c;let e={fc_plate:[2024,2014,2012,2013],download_mode:2,language_list:[n],output_language:i,custom_generate:{content:"",type:11}},s={list:["generate","editor"],editor:{id:0},generate:{step:1}};if(("regenerate"===a||"generate"===a)&&(e={...e,custom_generate:{content:l||"",type:11}}),"agent"===a&&(e={...e,output_language:1===G?X:i,custom_generate:{content:l||"",type:1===G?11:7,step:G||1}}),"edit"===a){if(!o){ee(!0),er(!0);return}delete e.custom_generate,s={...s,editor:{id:o}}}if(!$.current){ee(!0),er(!0);return}let u=await (0,v.TH)({thread_id:t,businessType:r});if(!u){ee(!0),er(!0);return}await (null===(c=window)||void 0===c?void 0:null===(d=c.AipptIframe)||void 0===d?void 0:d.show({appkey:"66d02c9660652",channel:"",code:u,editorModel:!0,container:$.current,options:e,routerOptions:s,async onMessage(e,a){switch(console.log(e,a),e){case"START":(null==a?void 0:a.status)&&ee(!0),await (0,w.gw)(1e3);break;case"AI_SMART_COMPLETE":(null==a?void 0:a.markdown)&&(0,v.uO)({thread_id:t,outline:null==a?void 0:a.markdown,businessType:r});break;case"OUTLINE_DOWNLOAD":break;case"GENERATE_PPT_SUCCESS":{E(!0),B("ppt.edit_ppt_btn"),L("edit"),A("edit"),Z(new Set(["edit"]));let{id:e}=a;if(e){let a=await (0,v.Cl)({thread_id:t,id:e,businessType:r});if(!(null==a?void 0:a.data)||M)return;V(!0)}break}case"PPT_DOWNLOAD":{(0,m.fk)(I?f.U.AUTHOR_DOWNLOAD_PPT:f.U.DOWNLOAD_PPT,{value:t},!0);let{id:e}=a;e&&(0,v.X3)({thread_id:t,id:e,businessType:r});break}case"TOKEN_EXPIRE":eh();break;case"CHARGING":(0,v.f0)({threadId:t,businessType:r}).then(e=>{e&&F.ZP.getState().reduceSubscriptioUsageTimes({featureName:"pptUsage"})})}}}))}catch(e){console.log("\uD83D\uDE80 ~ initAipptIframe ~ e:",e),ee(!0),er(!0)}},ec=async()=>{try{console.log("generateType",R);let a="";if("answer"===R&&r===w.LB.THREAD){let e=await (0,v.aL)({thread_id:t});a=null==e?void 0:e.map(e=>{var t,r;return(w.OA.includes(null==e?void 0:e.category)?null==e?void 0:null===(r=e.recall_contexts)||void 0===r?void 0:null===(t=r[0])||void 0===t?void 0:t.snippet:null==e?void 0:e.answer)||""}).join("")}if("file"===R){let e=await (0,v.LK)({threadId:t});if((null==e?void 0:e.status)==="SUCCESS"&&(a=(null==e?void 0:e.summary)||""),(null==e?void 0:e.status)==="LENGTH_OVER_SIZE"){ee(!0),D(!1),J.default(o("searchAddition.word_limit_exceeded_tip",{word:"200万"}));return}if((null==e?void 0:e.status)===500){ee(!0),er(!0);return}}if(r===w.LB.MESSAGE){a=q,await ed({type:"agent",answers:a});return}if(r===w.LB.NOTE){var e;let r=await (0,_.kL)(t);console.log("\uD83D\uDE80 ~ generatePpt ~ notes:",r),a=null==r?void 0:null===(e=r.data)||void 0===e?void 0:e.content}if(!(null==a?void 0:a.length)){ee(!0),er(!0);return}await ed({type:"generate",answers:a})}catch(e){ee(!0),er(!0)}},eu=async e=>{let{pptId:t}=e;await ed({type:"edit",pptId:t})},ep=async()=>{let e="";if("answer"===R&&r===w.LB.THREAD){let r=await (0,v.aL)({thread_id:t});e=null==r?void 0:r.map(e=>{var t,r;return(w.OA.includes(null==e?void 0:e.category)?null==e?void 0:null===(r=e.recall_contexts)||void 0===r?void 0:null===(t=r[0])||void 0===t?void 0:t.snippet:null==e?void 0:e.answer)||""}).join("")}if("file"===R){let r=await (0,v.LK)({threadId:t});if((null==r?void 0:r.status)==="SUCCESS"&&(e=(null==r?void 0:r.summary)||""),(null==r?void 0:r.status)==="LENGTH_OVER_SIZE"){ee(!0),D(!1),J.default(o("searchAddition.word_limit_exceeded_tip",{words:o("searchAddition.max_words")}));return}if((null==r?void 0:r.status)===500){ee(!0),er(!0);return}}if(r===w.LB.MESSAGE){e=q,await ed({type:"agent",answers:e});return}if(r===w.LB.NOTE){var a;let r=await (0,_.kL)(t);e=null==r?void 0:null===(a=r.data)||void 0===a?void 0:a.content}if(!(null==e?void 0:e.length)){ee(!0),er(!0);return}await ed({type:"regenerate",answers:e})},eh=async()=>{eg()},eg=async()=>{switch(er(!1),ee(!1),O){case"regenerate":ep();break;case"generate":ec();break;case"edit":{let{cacheStatus:e,pptId:t=0}=await ei();if(!e||!t){J.default(o("ppt.generating_ppt_tip"));return}(I||r===w.LB.NOTE||r===w.LB.MESSAGE)&&t&&(el("editPpt"),eu({pptId:t}));break}case"preview":{let{cacheStatus:e}=await ei();if(!e||w.Wx.includes(e)){J.default(o("ppt.generating_ppt_tip"));return}2===e&&el("showPdf")}}};return((0,p.useEffect)(()=>{eg()},[O,I]),"showPdf"===ea)?(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:(0,h.Z)("flex flex-wrap w-full justify-between items-center relative","h-[calc(90dvh)] w-full overflow-hidden rounded-lg","felo--pdfviewer"),children:[(0,a.jsx)(j.Z,{fileUrl:(null==H?void 0:H.ppt_url)||"",shortId:t,isOpenRetry:eo,handleGeneratePpt:es,handleDownload:e=>{(0,m.fk)(I?f.U.AUTHOR_DOWNLOAD_PPT:f.U.DOWNLOAD_PPT,{value:t},!0);let{expiryTime:r}=(0,w.OW)({threadId:t});if((0,w.XQ)({expiryTime:r})){e.preventDefault(),e.stopPropagation(),en(!0);return}},pdfFileUrl:(null==H?void 0:H.pdf_url)||"",businessType:r}),N?null:(0,a.jsx)("div",{className:(0,h.Z)("absolute left-0 right-0 top-0 z-40","h-[calc(90dvh)] mt-2","bg-contain bg-center bg-no-repeat","opacity-50 pointer-events-none"),style:{backgroundImage:"url(".concat((null==H?void 0:H.cover_url)?null==H?void 0:H.cover_url:"",")")}})]})}):"wait"===ea?(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(n.R,{isOpen:c,onOpenChange:T,onClose:()=>{D(!1)},backdrop:"opaque",placement:"center",classNames:{base:"text-white bg-gray-800"},children:(0,a.jsx)(i.A,{children:()=>(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(d.I,{children:(0,a.jsx)("p",{children:o("ppt.generating_ppt_tip")})})})})})}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:(0,h.Z)("h-[calc(90dvh)] justify-center items-center w-full",Y?"hidden":"flex"),children:(0,a.jsx)(x.c,{})}),(0,a.jsx)("div",{className:(0,h.Z)("h-[calc(90dvh)] w-full overflow-hidden rounded-lg ",Y&&!et?"block":"hidden"),ref:$}),(0,a.jsx)("div",{className:(0,h.Z)("h-[calc(90dvh)] justify-center items-center w-full overflow-hidden rounded-lg ",et?"flex":"hidden"),children:(0,a.jsx)(C.Z,{handleOpen:eh})})]})},I=r(44509),N=e=>{let{shortId:t,businessType:r}=e,{isOpen:h,onOpen:m}=(0,l.q)(),{isShowPptModal:f,setIsShowPptModal:x,setIsShowPptBtnAnimate:b,setShowPpt:C,pptDetailCahce:y,uiModalType:j,previewPPTData:F,setIsGeneratedSuccess:_}=(0,g.Z)(),S=(0,p.useRef)(null),k=()=>{var e,a,l;if(null===(l=window)||void 0===l||null===(a=l.AipptIframe)||void 0===a||null===(e=a.deleteIframe)||void 0===e||e.call(a),C("0"),(null==S?void 0:S.current)&&(0,I.Y)(S.current,"pptGenerate",()=>{x(!1),null==b||b(!0)}),"edit"===j&&(null==y?void 0:y.id)&&((0,v.X3)({thread_id:t,id:String(null==y?void 0:y.id),businessType:r}),r!==w.LB.MESSAGE)){let e=t?"".concat(location.origin,"/").concat(r===w.LB.NOTE?"docs":"search","/").concat(t):location.href;history.replaceState({},"",e)}let o=g.Z.getState().previewPPTData;"edit"===j&&(null==o?void 0:o.id)&&((0,v.X3)({thread_id:t,id:(null==o?void 0:o.id)||"",businessType:r}),_(!0))},N=async()=>{m()},P=async()=>{f&&(m(),await N())};return(0,p.useEffect)(()=>{P()},[f]),(0,a.jsx)(n.R,{ref:S,isOpen:h,isDismissable:!1,scrollBehavior:"inside",backdrop:"opaque",classNames:{wrapper:"z-[100001]",header:"relative p-0 m-0 h-[1px]",base:"min-w-[90dvw] h-[calc(90dvh)] max-h-[calc(90dvh)]",footer:"py-0"},closeButton:(0,a.jsx)(a.Fragment,{}),children:(0,a.jsx)(i.A,{children:()=>(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s.k,{children:(0,a.jsx)(o.A,{className:"rounded-full absolute top-[-36px] right-0 z-50 md:top-[-28px] md:right-[-28px]",isIconOnly:!0,radius:"full",size:"sm",onPress:k,children:(0,a.jsx)(u.Z,{})})}),(0,a.jsx)(d.I,{className:"relative h-[90dvh] min-h-[90dvh] md:h-[90dvh] p-0 justify-between overflow-hidden",children:(0,a.jsx)(T,{shortId:t,businessType:r})}),(0,a.jsx)(c.R,{})]})})})}},82180:function(e,t,r){"use strict";var a=r(52676),l=r(26595),o=r(93071),n=r(3488),i=r(6286),s=r(40736),d=r(84997),c=r(71887),u=r(7717);r(75271);var p=r(4814),h=r(70017),g=r(35279),m=r(18881),f=r(31063),v=r(60161),x=r(77844),b=r(44342),w=r(19527),C=r(94572),y=r(65819);t.Z=e=>{let{fileUrl:t,shortId:r,isOpenRetry:j,handleGeneratePpt:F,handleDownload:_,pdfFileUrl:S,businessType:k}=e,{isMobile:T}=(0,b.b)(),{isRegenerateLoading:I,isMyThread:N}=(0,m.Z)(),P=(0,u.useTranslations)(),D=(0,y.gQ)(),E=(0,h.V)();return(0,a.jsxs)(a.Fragment,{children:[S?(0,a.jsx)(g.Z,{fileUrl:t,pdfFileUrl:S,fileType:"PDF",fileName:"PPT"}):(0,a.jsx)("iframe",{src:"https://view.officeapps.live.com/op/view.aspx?src=".concat(encodeURIComponent(t)),loading:"eager",className:(0,p.Z)("w-full  mt-[-100px] ","h-[calc(80vh+20px)]","border-1 border-gray-200 rounded-lg overflow-hidden dark:border-gray-600"),title:"PPT"}),(0,a.jsx)("div",{className:(0,p.Z)("flex  w-full items-center px-3 py-2 absolute bottom-0 left-0 right-0 bg-white min-h-10 dark:bg-gray-800 rounded-b-lg",T?"justify-center":"justify-end"),children:j?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("span",{className:"mr-2 text-sm inline-flex items-center text-yellow-400",children:[(0,a.jsx)(n.Z,{size:20,className:"mr-1"}),P("ppt.regenerate_tip")]}),(0,a.jsx)(l.A,{color:"primary",size:T?"md":"sm",startContent:I?null:(0,a.jsx)(i.Z,{size:20}),onPress:()=>{F("getUrl"),(0,f.fk)(v.U.TIMEOUT_REGENERATE_PPT,{value:r},!0)},className:"shadow rounded-full",isLoading:I,children:P("ppt.regenerate")})]}):(0,a.jsxs)(a.Fragment,{children:[k!==C.LB.NOTE?(0,a.jsx)(l.A,{size:"md",color:"primary",startContent:E.copied?(0,a.jsx)(s.Z,{size:20}):(0,a.jsx)(d.Z,{size:20}),className:(0,p.Z)("shadow rounded-full mr-3",T?"w-full":""),onPress:()=>{let e=x.Z.getState().current,t=new URL("".concat(location.origin,"/search/").concat(r));t.searchParams.append("showppt","1"),e&&t.searchParams.append("invite",e),E.copy(t.toString()),(0,f.fk)(N?v.U.AUTHOR_SHARE_PPT:v.U.SHARE_PPT,{value:r},!0),D?w.Z.getState().setShareStatus("PARTIAL_PUBLIC"):w.Z.getState().setShareStatus("PUBLIC")},children:P("ppt.share_url")}):null,(0,a.jsx)(l.A,{size:"md",color:"primary",as:o.O,startContent:(0,a.jsx)(c.Z,{size:20}),href:t,target:"_blank",onClick:_,download:!0,className:(0,p.Z)("shadow rounded-full",T?"w-full":""),children:P("ppt.download_ppt_btn")})]})})]})}},78467:function(e,t,r){"use strict";var a=r(52676),l=r(26595),o=r(3488),n=r(47841),i=r(7717);t.Z=e=>{let{message:t,handleOpen:r,type:s}=e,d=(0,i.useTranslations)();return(0,a.jsx)("div",{className:"flex justify-center items-center h-[calc(77dvh-270px)] felo--ppt__result",children:(0,a.jsxs)("div",{className:"flex flex-wrap",children:[(0,a.jsx)("div",{className:"w-full flex justify-center items-center my-2",children:(0,a.jsx)(o.Z,{size:30})}),(0,a.jsx)("div",{className:"w-full flex justify-center items-center text-base",children:d("empty"===s?"ppt.empty_ppt_tip":"ppt.failed_generate")}),t&&(0,a.jsx)("div",{className:"w-full flex justify-center items-center text-sm mt-2",children:(0,a.jsx)("p",{children:t})}),"empty"===s?null:(0,a.jsx)("div",{className:"w-full my-10 flex justify-center items-center",children:(0,a.jsx)(l.A,{size:"sm",radius:"full",color:"primary",startContent:(0,a.jsx)(n.Z,{size:14}),onPress:()=>{r({type:"retry"})},children:d("ppt.retry_generate")})})]})})}},40341:function(e,t,r){"use strict";r.d(t,{$E:function(){return l},IQ:function(){return o}});var a=r(45360);r(94572);let l=async e=>{let{threadId:t,businessType:r}=e,l=await (0,a.gi)({threadId:t,businessType:r});return console.log("getImportJob",l),l},o=async e=>{let{threadId:t,jobId:r,businessType:l}=e;return await (0,a.B0)({threadId:t,jobId:r,businessType:l})}},64787:function(e,t,r){"use strict";r.d(t,{Es:function(){return n},Iv:function(){return o},TW:function(){return i},qf:function(){return l}});var a=r(45360);r(94572);let l=async e=>{let{threadId:t,businessType:r}=e;return new Promise(async(e,l)=>{try{let o=await (0,a.N)({threadId:t,businessType:r});if(console.log("\uD83D\uDE80 ~ returnnewPromise<boolean> ~ redirectUrl:",o),!o)return l(null),null;let i=Math.max(0,(window.innerWidth-800)/2),s=Math.max(0,(window.innerHeight-800)/2),d=window.open(o,"",["popup","width=".concat(800),"height=".concat(800),"left=".concat(i),"top=".concat(s)].join(","));window.addEventListener("message",t=>{"authorization_success"===t.data?(e(!0),null==d||d.close()):"authorization_error"===t.data&&(l(null),null==d||d.close())});let c=async()=>{try{let a=await n({threadId:t,businessType:r});e(a.status)}catch(e){l(null)}},u=setInterval(()=>{(null==d?void 0:d.closed)&&(clearInterval(u),c())},1e3)}catch(e){console.error("Authorization failed",e),l(null)}})},o=async e=>{let{threadId:t,businessType:r}=e;return await (0,a.Wd)({threadId:t,businessType:r})},n=async e=>{let{threadId:t,businessType:r}=e;return await (0,a.sR)({threadId:t,businessType:r})},i=async()=>{let e=localStorage.getItem("CANVA_CALLBACK_REDIRECT_URL");return new Promise(t=>{t(e||"")})}},40176:function(e,t,r){"use strict";r.d(t,{O:function(){return o}});var a=r(52676),l=r(46571);function o(e){let{className:t,...r}=e;return(0,a.jsx)("div",{className:(0,l.cn)("animate-pulse rounded-md",t),...r})}},31049:function(e,t,r){"use strict";var a=r(52676),l=r(97571),o=r(75271),n=r(13005);t.Z=e=>{let{visible:t,closeDrawer:r,children:i}=e,s=(0,o.useRef)(null),d=(0,o.useRef)(null),{isDark:c}=(0,l.Z)();return((0,o.useEffect)(()=>{function e(){let e=window.innerHeight;s.current&&(s.current.style.height="".concat(e,"px"))}return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[]),(0,o.useEffect)(()=>{let e=e=>{let t=e.target;!s.current||s.current.contains(e.target)||t.closest('[data-tooltip="true"]')||r()};return t?document.addEventListener("mousedown",e):document.removeEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[t,r]),(0,o.useEffect)(()=>{if(t){document.body.style.overflow="hidden";let e=setTimeout(()=>{var e;null===(e=d.current)||void 0===e||e.focus()},100);return()=>clearTimeout(e)}document.body.style.overflow=""},[t]),t)?(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40 backdrop-saturate-150 backdrop-blur-md",onClick:r}),(0,a.jsxs)("div",{ref:s,className:"fixed z-50 top-0 right-0 bg-content1 md:w-[50vw] h-full flex flex-col ".concat(c?"dark":""," transition-all ").concat(t?"":" opacity-0 invisible"),children:[(0,a.jsx)("button",{onClick:r,ref:d,className:"absolute top-4 right-4 text-gray-600 hover:text-gray-800",children:(0,a.jsx)(n.Z,{color:c?"white":"gray",className:"cursor-pointer",size:18})}),i]})]}):null}},84915:function(e,t,r){"use strict";r.d(t,{F:function(){return A}});var a=r(52676),l=r(92823),o=r(43378),n=r(26152),i=r(40176),s=r(39696),d=r(13005),c=r(41426),u=r(75271),p=r(27585),h=r(25568),g=r(75154),m=r(90488),f=r(7717),v=r(97571),x=r(13003),b=r(31022),w=r(29871),C=r(4590),y=r(97247),j=r(60635),F=r(57606),_=r(31063),S=r(60161),k=r(49905),T=r(3295),I=r(34180),N=r(46571),P=r(36551),D=r(64412),E=r(4814),O=r(5311),B=r(84781),L=r(70262);let Z=e=>{var t,r,i,c,w,_,S;let{source:N,index:Z,isVisible:A,rid:z,showCheckbox:U}=e,R=(0,b.Z)(e=>e.extensionEnable),M=(0,b.Z)(e=>e.legacyExtensionEnable),V=(0,f.useTranslations)(),{selectedSources:q,setSelectedSources:H,sourceOriginalList:W,sourceTranslatedList:G}=(0,F.Z)(),{isDark:X}=(0,v.Z)(),{snippet:K,url:J,link:Q,title:$,other_info:Y}=N,ee=(0,T.Z)(e=>e.autoTranslateSources),et=(0,O.Z)(e=>e.threads),[er,ea]=(0,u.useState)(!1),[el,eo]=(0,u.useState)(!1),[en,ei]=(0,u.useState)({translatedTitle:"",translatedSnippet:""}),[es,ed]=(0,u.useState)(K),ec=(0,p.lx)(J||Q||"").hostname,[eu,ep]=(0,u.useState)(!1),eh=(0,u.useMemo)(()=>(0,g.a)(K),[K]),eg=(e,t)=>{let r="".concat(z,"-").concat(e,"-").concat(t),a=W.find(e=>e.id===r);if(a)return{translatedTitle:a.translatedTitle,translatedSnippet:a.translated.join("\n")};let l="".concat(e,"-").concat(t),o=G.find(e=>e.id===l);return o?{translatedTitle:o.translatedTitle,translatedSnippet:o.translatedSnippet}:null},em=()=>{if(el)return;let e=eg(N.url||N.link||"",(0,k.w0)());e?(ei(e),eo(!0),ea(!0)):(eo(!1),ea(!1))};return(0,u.useEffect)(()=>{em()},[W,G]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex items-start w-full notranslate",children:[U&&(0,a.jsx)("div",{className:"flex-none p-2",children:(0,a.jsx)(I.K,{isSelected:q.includes(Z),onChange:e=>{let{lastSelectedIndex:t,setLastSelectedIndex:r}=F.Z.getState(),a=e.nativeEvent.shiftKey,l=e.target.checked;if(a&&null!==t){let e=Math.min(t,Z),r=Array.from({length:Math.max(t,Z)-e+1},(t,r)=>e+r);l?H(Array.from(new Set([...q,...r]))):H(q.filter(e=>!r.includes(e)))}else l?H([...q,Z]):H(q.filter(e=>e!==Z));r(Z)}})}),(0,a.jsx)("div",{className:"relative rounded-lg w-full flex flex-col gap-2",children:(0,a.jsx)(x.Z,{source:N,placement:"left",isVisible:A,rid:z,offset:U?65:void 0,children:(0,a.jsxs)("div",{className:(0,E.Z)("flex items-start gap-3 w-full rounded-lg p-2 hover:bg-gray-100 dark:hover:bg-[#444549] mb-6",(null==et?void 0:null===(t=et[0])||void 0===t?void 0:t.category)===P.J5?"":"cursor-pointer "),onClick:()=>{var e;let t=null==et?void 0:null===(e=et[0])||void 0===e?void 0:e.category;if(!Q||t===P.J5)return;if("image"===N.source_type){ep(!0);return}let r=Q;if(!r.includes(".file")){if(r.includes("http")||(r="http://".concat(r)),(0,y.N0)()){(0,j.oh)({url:r});return}R?window.open((0,C.m1)(r),"_blank"):M?window.open((0,C.m1)(r,!0),"_blank"):window.open(r,"_blank")}},children:[(0,a.jsx)("span",{className:"block flex-shrink-0 w-6 rounded-full text-center leading-6 text-sm bg-theme-bg-100 dark:bg-theme-bg-dark-100 text-theme-font-600 dark:text-theme-font-dark-600",children:Z+1}),(0,a.jsxs)("section",{className:"w-full",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1 text-theme-font-400 dark:text-theme-font-dark-700 min-h-6",children:[(0,a.jsx)("span",{className:"flex-none inline-block w-[16px] h-[16px]",children:(null==et?void 0:null===(r=et[0])||void 0===r?void 0:r.category)===P.J5||(null==et?void 0:null===(i=et[0])||void 0===i?void 0:i.category)===P.Ys&&(null==N?void 0:N.source_type)==="image"?(0,a.jsx)(D.Z,{fileName:$,w:4,h:4}):(0,a.jsx)(m.Z,{src:(N.url||N.link||"").includes(".file")?N.url||N.link||"":"https://www.google.com/s2/favicons?domain=".concat(ec,"&sz=",16),title:$})}),(0,a.jsx)("p",{className:"text-sm line-clamp-1 break-all",children:(0,p.CN)({url:(null==N?void 0:N.link)||"",title:(null==N?void 0:N.title)||"",sourceType:(null==N?void 0:N.source_type)||""})})]}),(null==et?void 0:null===(c=et[0])||void 0===c?void 0:c.category)!==P.J5&&(null==et?void 0:null===(w=et[0])||void 0===w?void 0:w.category)!==P.Ys?(0,a.jsx)("section",{className:"mt-2 leading-4 text-theme-font-700 dark:text-theme-font-dark-700",children:(0,a.jsxs)("span",{className:"text-sm",children:[(0,p.pz)(Q||"")?(0,a.jsx)("span",{className:"max-w-fit inline-block mr-1 align-[-2px] ".concat(X?"text-white":"text-black"),children:(0,a.jsx)(h.UK,{})}):"",(0,a.jsx)("span",{children:el&&ee?en.translatedTitle:$}),eh&&(0,a.jsxs)("span",{className:"inline-block text-sm text-bold ml-2",children:["[",eh,"]"]})]})}):null,(0,a.jsx)("section",{className:"mt-2 text-xs text-theme-font-600 dark:text-theme-font-dark-600 line-clamp-3 leading-normal",children:(null==et?void 0:null===(_=et[0])||void 0===_?void 0:_.category)===P.Ys&&(null==N?void 0:N.source_type)==="image"?(0,a.jsx)(l.J,{radius:"sm",classNames:{img:"w-full h-[w-full/8] object-cover overflow-hidden"},alt:(null==N?void 0:N.title)||"image",src:(0,L.UK)((null==N?void 0:null===(S=N.other_info)||void 0===S?void 0:S.file_id)||"")}):el&&ee?en.translatedSnippet:es}),"topic"===N.engine_name&&(0,a.jsxs)("div",{className:"flex w-full items-center gap-2 mt-2 text-theme-font-600 dark:text-[#F3F5F7]",children:[(0,a.jsxs)("div",{className:"p-1.5 bg-[#F6F7F9] dark:bg-[#353B46] gap-1 rounded-lg ml-auto flex items-center justify-center",children:["document"===N.source_type&&(0,a.jsx)(B.g9,{className:"w-4 h-4"}),"document"===N.source_type&&(0,a.jsx)("div",{className:"text-xs",children:V("topic.file")}),"website"===N.source_type&&(0,a.jsx)(s.Z,{size:16}),"website"===N.source_type&&(0,a.jsx)("div",{className:"text-xs",children:V("topic.link")})]}),(0,a.jsx)("div",{className:"p-1.5 bg-[#F6F7F9] rounded-lg dark:bg-[#353B46]",children:(0,a.jsx)(B.HV,{className:"w-4 h-4"})})]})]})]})})},Z)]}),(0,a.jsx)(o.Vq,{open:eu,onOpenChange:()=>{ep(!1)},children:(0,a.jsxs)(o.cZ,{hideCloseButton:!0,"aria-describedby":void 0,className:(0,E.Z)("max-w-screen-sm","bg-transparent border-none shadow-none"),children:[(0,a.jsx)(n.T,{children:(0,a.jsx)(o.$N,{className:"dark:bg-gray-600",children:$||"image"})}),(0,a.jsxs)(o.a7,{className:"w-full max-w-md mx-auto relative",children:[(0,a.jsx)("div",{className:"absolute -top-8 right-2 z-20",children:(0,a.jsx)(o.GG,{className:"rounded-full p-1 bg-white/80 outline-none dark:bg-gray-700",children:(0,a.jsx)(d.Z,{size:20})})}),(0,a.jsx)("div",{className:"relative mb-4 -mt-3  flex justify-center z-0 rounded-xl bg-[#E4E4E7] dark:bg-[#27272A]  min-h-[200px]",children:(0,a.jsx)(l.J,{classNames:{img:"max-h-[calc(100vh-160px)]"},radius:"sm",alt:$||"image",src:(0,L.UK)((null==Y?void 0:Y.file_id)||"")})})]})]})})]})},A=e=>{let{sources:t,canEdit:r,isDone:l,isAll:o,isAllDisabled:n,onOpen:s,isVisible:d,rid:h}=e,g=(0,f.useTranslations)(),[v,x]=(0,u.useState)(!0),{isMobile:b}=(0,w.Z)(),C=(0,u.useMemo)(()=>t.length<=3?t:t.slice(0,3),[t]),y=(0,u.useMemo)(()=>t.length<=3?[]:t.slice(3,t.length).map(e=>{let{url:t,link:r,title:a}=e,l=t||r||"",o=(0,p.lx)(l).hostname;return{src:l.includes(".file")?l:"https://www.google.com/s2/favicons?domain=".concat(o,"&sz=",16),title:a}}),[t]);return(0,u.useEffect)(()=>{o&&x(!1)},[o]),(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:"flex flex-col  ".concat(o?"":"overflow-hidden"),children:[t.length>0?(v?C:t).map((e,t)=>(0,a.jsx)("div",{children:o?(0,a.jsx)(Z,{index:t,source:e,isVisible:d,rid:h,showCheckbox:r}):(0,a.jsx)(Z,{index:t,source:e,isVisible:d,rid:h})},t)):l?(0,a.jsx)("section",{className:"text-center my-10",children:g("no_sources")}):(0,a.jsx)("section",{className:"flex flex-col gap-5",children:[,,,].fill("").map((e,t)=>(0,a.jsx)(i.O,{className:"max-w-sm h-28 bg-zinc-200 dark:bg-gray-900/30"},t))}),v&&(0,a.jsx)("section",{children:(0,a.jsxs)("section",{className:"relative z-[1] flex justify-end items-center",children:[(0,a.jsx)("section",{className:"flex flex-wrap gap-2",children:Array.from(new Set(y)).slice(0,3).map((e,t)=>(0,a.jsx)(m.Z,{src:e.src,title:e.title},t))}),!!y.length&&(0,a.jsxs)("button",{className:(0,N.cn)("flex items-center gap-1 text-sm m-1 px-3 py-1.5 rounded-lg","text-theme-font-600 dark:text-theme-font-dark-600","bg-transparent hover:bg-default-100","transition-colors duration-150","disabled:opacity-50 disabled:cursor-not-allowed"),disabled:n,onClick:()=>{b?x(!1):s&&s(),(0,_.fk)(S.U.THREAD_MORE_SOURCES,{sources:t.length},!0)},children:[g("view_more_num",{number:y.length}),(0,a.jsx)(c.Z,{size:18})]})]})})]})})}},67185:function(e,t,r){"use strict";r.d(t,{Oq:function(){return s},Qz:function(){return n},TE:function(){return d},jW:function(){return l},jo:function(){return i}});var a=r(14386);let l=[{id:"basic-1",textColor:"#323232",styleObject:{backgroundColor:"#3E81F4",color:"#FFFFFF"},titleColor:"#FFFFFF",threadTitleStyle:{color:"#323232"},markdownStyle:{},bodyStyle:{backgroundColor:"#FFFFFF"},logoIcon:(0,a.UW)(),qrcodeBg:"linear-gradient(to right bottom, rgb(36, 171, 247), rgb(40, 121, 251))"},{id:"basic-2",textColor:"#6E553B",styleObject:{backgroundColor:"#FFDF76",color:"#361B00"},titleColor:"#361B00",threadTitleStyle:{color:"#353535"},markdownStyle:{},bodyStyle:{backgroundColor:"#FEF7E2"},logoIcon:(0,a._j)(),qrcodeBg:"rgba(54,27,0,1)",otherOptions:{}},{id:"basic-3",textColor:"#83785A",styleObject:{backgroundColor:"#8E875E",color:"#FFFFFF"},titleColor:"#FFFFFF",threadTitleStyle:{color:"#D76439"},markdownStyle:{},bodyStyle:{backgroundColor:"#FBFCF7"},logoIcon:(0,a.UW)(),qrcodeBg:"#8E875E",otherOptions:{}},{id:"basic-4",textColor:"#0B3E51",styleObject:{backgroundColor:"#54A6B4",color:"#FFFFFF"},titleColor:"#F6ED4D",threadTitleStyle:{color:"#BAB33E"},markdownStyle:{},bodyStyle:{backgroundColor:"#FFFFFF"},logoIcon:(0,a.UW)(),qrcodeBg:"#54A6B4",otherOptions:{}},{id:"basic-5",textColor:"#393532",styleObject:{backgroundColor:"#D77455",color:"#FFFFFF"},titleColor:"#FFFFFF",threadTitleStyle:{color:"#D77455"},markdownStyle:{},bodyStyle:{backgroundColor:"#FFF8F6"},logoIcon:(0,a._j)(),qrcodeBg:"#000",otherOptions:{}},{id:"basic-6",textColor:"#321450",styleObject:{backgroundColor:"#FF7F2C",color:"#FFFFFF"},titleColor:"#FFFFFF",threadTitleStyle:{color:"#FF7F2C"},markdownStyle:{},bodyStyle:{backgroundColor:"#FDFEFF"},logoIcon:(0,a._j)(),qrcodeBg:"rgb(195,85,37)",otherOptions:{}},{id:"basic-7",textColor:"#368B86",styleObject:{backgroundColor:"#D8E4D8",color:"#5F5A44"},titleColor:"#5F5A44",threadTitleStyle:{color:"#5F5A44"},markdownStyle:{},bodyStyle:{backgroundColor:"#FFFFFF"},logoIcon:(0,a._j)(),qrcodeBg:"rgb(95,90,68)",otherOptions:{}},{id:"basic-8",textColor:"#434343",styleObject:{backgroundColor:"#EDEAD9",color:"#4A4B44"},titleColor:"#4A4B44",threadTitleStyle:{color:"#D88C39"},markdownStyle:{},bodyStyle:{backgroundColor:"#FFFFFF"},logoIcon:(0,a._j)(),qrcodeBg:"rgb(102.106,81)",otherOptions:{}},{id:"basic-9",textColor:"#405B1C",styleObject:{backgroundColor:"#D6D8B1",color:"#4E6C1E"},titleColor:"#4E6C1E",threadTitleStyle:{color:"#B29604"},markdownStyle:{},bodyStyle:{backgroundColor:"#F7F5F1"},logoIcon:(0,a._j)(),qrcodeBg:"rgb(78,108,30)",otherOptions:{}},{id:"basic-10",textColor:"#021A36",styleObject:{backgroundColor:"#F5F2EB",color:"#6C5526"},titleColor:"#9D8046",threadTitleStyle:{color:"#9D8046"},markdownStyle:{},bodyStyle:{backgroundColor:"#FFFFFF"},logoIcon:(0,a._j)(),qrcodeBg:"rgb(108, 85, 38)",otherOptions:{}},{id:"basic-11",textColor:"#271F1D",styleObject:{backgroundColor:"#F5F2EB",color:"#3D6F2D"},titleColor:"#3D6F2D",threadTitleStyle:{color:"#53963D"},markdownStyle:{},bodyStyle:{backgroundColor:"#FFFFFF"},logoIcon:(0,a._j)(),qrcodeBg:"#3D6F2D",otherOptions:{}},{id:"basic-12",textColor:"#004489",styleObject:{backgroundColor:"#004489",color:"# fff"},titleColor:"#FF8D00",threadTitleStyle:{color:"#FE8C01"},markdownStyle:{},bodyStyle:{backgroundColor:"#FFFFFF"},logoIcon:(0,a._j)(),qrcodeBg:"#004489 ",otherOptions:{}},{id:"basic-13",textColor:"#030303",styleObject:{backgroundColor:"#22B4E5",color:"#FFFFFF"},titleColor:"#EFEA38",threadTitleStyle:{color:"#B4B01B"},markdownStyle:{},bodyStyle:{backgroundColor:"#FFFFFF"},logoIcon:(0,a.UW)(),qrcodeBg:"rgb(13, 80, 102)",otherOptions:{}},{id:"basic-14",textColor:"#4E4E4E",styleObject:{background:"url(/shareThreadImg/iosTag.png)",color:"#353535"},titleColor:"#404040",threadTitleStyle:{color:"#404040"},markdownStyle:{},bodyStyle:{backgroundColor:"#FFFFFF"},logoIcon:(0,a._j)(),qrcodeBg:"linear-gradient(to right bottom, rgb(36, 171, 247), rgb(40, 121, 251))",previewImg:"/shareThreadImg/preview9.png"},{id:"basic-15",textColor:"#64846F",styleObject:{backgroundColor:"#B3C3B9",color:"#3F5947"},titleColor:"#64846F",threadTitleStyle:{color:"#B65D63"},markdownStyle:{},bodyStyle:{backgroundColor:"rgb(255,249,242)"},logoIcon:(0,a._j)(),qrcodeBg:"#3F5947",otherOptions:{}},{id:"basic-16",textColor:"#6F2D3D",styleObject:{backgroundColor:"#FDEFDF",color:"#6F2D3D"},titleColor:"#E3A972",threadTitleStyle:{color:"#6F2D3D"},markdownStyle:{},bodyStyle:{backgroundColor:"#FFFFFF"},logoIcon:(0,a._j)(),qrcodeBg:"#6F2D3D",otherOptions:{dotBg:"#B3C3B9",lineBg:"#EEE8E1",lineBorder:"#4A7B5D",dotBorder:"#4A7B5D"}},{id:"basic-17",textColor:"#2B689B",styleObject:{backgroundColor:"#D3E9FC",color:"#2B689B"},titleColor:"#2B689B",threadTitleStyle:{color:"#B65D63"},markdownStyle:{},bodyStyle:{backgroundColor:"#FFFFFF"},logoIcon:(0,a._j)(),qrcodeBg:"#2B689B",otherOptions:{dotBg:"#d3e9fc",dotBorder:"#4D98D9",lineBg:"#E1E5EE",lineBorder:"#4D98D9"}},{id:"basic-18",textColor:"#1D1210",styleObject:{backgroundColor:"rgb(172,158,100)",color:"#1D1210"},titleColor:"#9C8746",threadTitleStyle:{color:"#9C8746"},markdownStyle:{},bodyStyle:{backgroundColor:"#FFF9F3"},logoIcon:(0,a._j)(),qrcodeBg:"#1D1210",otherOptions:{styleDocument:{background:"url(/shareThreadImg/pattern1.png)"}},previewImg:"/shareThreadImg/preview1.png"},{id:"basic-19",textColor:"#1D1210",styleObject:{backgroundColor:"rgb(65,94,70)",color:"#1D1210"},titleColor:"#488352",threadTitleStyle:{color:"#488352"},markdownStyle:{},bodyStyle:{backgroundColor:"#F2F2E7"},logoIcon:(0,a._j)(),qrcodeBg:"#1D1210",otherOptions:{styleDocument:{backgroundImage:"url(/shareThreadImg/pattern2.png)"}},previewImg:"/shareThreadImg/preview2.png"},{id:"basic-20",textColor:"#4F586B",styleObject:{backgroundColor:"rgb(217,217,217)",color:"#343B47"},titleColor:"#005F9E",threadTitleStyle:{color:"#005F9E"},markdownStyle:{},bodyStyle:{backgroundColor:"#F5F5F5"},logoIcon:(0,a._j)(),qrcodeBg:"#343B47",otherOptions:{styleDocument:{backgroundImage:"url(/shareThreadImg/pattern3.png)"}},previewImg:"/shareThreadImg/preview3.png"},{id:"basic-21",textColor:"#4F586B",styleObject:{backgroundColor:"rgb(44,45,101)",color:"#343B47"},titleColor:"#A63939",threadTitleStyle:{color:"#A63939"},markdownStyle:{},bodyStyle:{backgroundColor:"#FFFFFF"},logoIcon:(0,a._j)(),qrcodeBg:"#343B47",otherOptions:{styleDocument:{backgroundImage:"url(/shareThreadImg/pattern4.png)"}},previewImg:"/shareThreadImg/preview4.png"},{id:"basic-22",textColor:"#002323",styleObject:{backgroundColor:"rgb(238,225,192)",color:"#002323"},titleColor:"#E24100",threadTitleStyle:{color:"#E24100"},markdownStyle:{},bodyStyle:{backgroundColor:"#FFFBF2"},logoIcon:(0,a._j)(),qrcodeBg:"#002323",otherOptions:{styleDocument:{backgroundImage:"url(/shareThreadImg/pattern5.png)"}},previewImg:"/shareThreadImg/preview5.png"},{id:"basic-23",textColor:"#481F56",styleObject:{backgroundColor:"rgb(86,24,107)",color:"#481F56"},titleColor:"#E93C5A",threadTitleStyle:{color:"#E93C5A"},markdownStyle:{},bodyStyle:{backgroundColor:"#FFF6FA"},logoIcon:(0,a._j)(),qrcodeBg:"#481F56",otherOptions:{styleDocument:{backgroundImage:"url(/shareThreadImg/pattern6.png)"}},previewImg:"/shareThreadImg/preview6.png"},{id:"basic-24",textColor:"#434343",styleObject:{backgroundColor:"rgb(215,236,253)",color:"#000"},titleColor:"#FFFFFF",threadTitleStyle:{color:"#B65D63"},markdownStyle:{},bodyStyle:{backgroundColor:"#FFFFFF"},logoIcon:(0,a._j)(),qrcodeBg:"#000",otherOptions:{styleDocument:{backgroundImage:"url(/shareThreadImg/cartoonGridBg.png)"}},previewImg:"/shareThreadImg/preview7.png"},{id:"basic-25",textColor:"#808080",styleObject:{background:"linear-gradient(to bottom, #D4E9FC, #5DADEC)",color:"#010101"},titleColor:"#010101",threadTitleStyle:{color:"#010101"},markdownStyle:{},bodyStyle:{backgroundColor:"#FFFFFF"},logoIcon:(0,a._j)(),qrcodeBg:"#010101",otherOptions:{headerLineStyle:{border:"10px solid #035E8D",background:"#02293E"},headerBg:"linear-gradient(0deg, rgba(74, 150, 199, 0.00) 0%, #4A96C7 100%)"},previewImg:"/shareThreadImg/preview8.png"},{id:"basic-26",textColor:"#808080",styleObject:{background:"#BA9B7C",color:"#010101"},titleColor:"#010101",threadTitleStyle:{color:"#010101"},markdownStyle:{},bodyStyle:{backgroundColor:"#FFFFFF"},logoIcon:(0,a._j)(),qrcodeBg:"#010101",otherOptions:{headerLineStyle:{border:"10px solid #816345",background:"#23180C"},headerBg:"linear-gradient(0deg, rgba(186, 155, 124, 0.00) 0%, #BA9B7C 100%)"}},{id:"basic-27",textColor:"#434343",styleObject:{background:"#53A5F7",color:"#010101"},titleColor:"#0E60B4",threadTitleStyle:{color:"#0E60B4"},markdownStyle:{},bodyStyle:{backgroundColor:"#FFFFFF"},logoIcon:(0,a._j)(),qrcodeBg:"#434343",otherOptions:{collisionBg:"#F1DF50"}}],o=e=>l.find(t=>t.id===e),n=[{parentId:"shareTemplate3",templateImg:"/shareThreadImg/template11.png",defaultBgID:"basic-17",defaultBg:o("basic-17")},{parentId:"shareTemplate1",templateImg:"/shareThreadImg/template1.png",defaultBgID:"basic-1",defaultBg:o("basic-1")},{parentId:"shareTemplate2",templateImg:"/shareThreadImg/template2.png",defaultBgID:"basic-14",defaultBg:o("basic-14")},{parentId:"shareTemplate3",templateImg:"/shareThreadImg/template3.png",defaultBgID:"basic-15",defaultBg:o("basic-15")},{parentId:"shareTemplate4",templateImg:"/shareThreadImg/template4.png",defaultBgID:"basic-16",defaultBg:o("basic-16")},{parentId:"shareTemplate5",templateImg:"/shareThreadImg/template5.png",defaultBgID:"basic-18",defaultBg:o("basic-18")},{parentId:"shareTemplate6",templateImg:"/shareThreadImg/template6.png",defaultBgID:"basic-19",defaultBg:o("basic-19")},{parentId:"shareTemplate7",templateImg:"/shareThreadImg/template7.png",defaultBgID:"basic-20",defaultBg:o("basic-20")},{parentId:"shareTemplate8",templateImg:"/shareThreadImg/template8.png",defaultBgID:"basic-21",defaultBg:o("basic-21")},{parentId:"shareTemplate9",templateImg:"/shareThreadImg/template9.png",defaultBgID:"basic-22",defaultBg:o("basic-22")},{parentId:"shareTemplate10",templateImg:"/shareThreadImg/template10.png",defaultBgID:"basic-23",defaultBg:o("basic-23")},{parentId:"shareTemplate15",templateImg:"/shareThreadImg/template15.png",defaultBgID:"basic-24",defaultBg:o("basic-24")},{parentId:"shareTemplate16",templateImg:"/shareThreadImg/template16.png",defaultBgID:"basic-25",defaultBg:o("basic-25")},{parentId:"shareTemplate17",templateImg:"/shareThreadImg/template17.png",defaultBgID:"basic-26",defaultBg:o("basic-26")},{parentId:"shareTemplate18",templateImg:"/shareThreadImg/template14.png",defaultBgID:"basic-27",defaultBg:o("basic-27")}],i=10,s=[{id:"Base",value:""},{id:"Classic",value:"ShipporiMincho"},{id:"Elegance",value:"CustomOutfit"}],d=[1.2,1.4,1.6,1.8]},44634:function(e,t,r){"use strict";let a;var l=r(60161),o=r(31063),n=r(65819),i=r(57546),s=r(65105),d=r(45360),c=r(84706),u=r(18881),p=r(7717),h=r(77844),g=r(70017),m=r(64787),f=r(94572),v=r(40341),x=r(77998),b=r(39109);let w=()=>{i.Z.getState().setLoginModalVisible(!0)},C=()=>{u.Z.getState().setIsRegenerate(!1),u.Z.getState().setIsShowPptModal(!0)},y=0;async function j(e){let{threadId:t,jobId:r,time:l,businessType:o}=e;return new Promise(e=>{a=setInterval(async()=>{++y>=10&&(clearInterval(a),e({editUrl:"",thumbnailUrl:""}));let l=await (0,v.IQ)({threadId:t,jobId:r,businessType:o});console.log("\uD83D\uDE80 ~ interval=setInterval ~ res:",l),(null==l?void 0:l.status)==="success"?(e({editUrl:null==l?void 0:l.editUrl,thumbnailUrl:null==l?void 0:l.thumbnailUrl}),clearInterval(a)):(null==l?void 0:l.status)==="failed"?(e({editUrl:"",thumbnailUrl:""}),clearInterval(a)):console.log("未获取继续轮询...")},l||5e3)})}t.Z=()=>{let e=(0,p.useTranslations)(),t=(0,g.V)(),r=(0,n.ZP)(e=>e.isLogin),a=(0,b.Z)(),{setUiModalType:i,setIsCanvaConnectedLoading:y,isCanvaConnectedLoading:F,setIsCanvaAuthorized:_,setIsShowCanvaModal:S,setIsOpenCanvaEditorLoading:k,setIsImportLoading:T,setDesign:I,setIsReauthorized:N,setBusinessType:P,setBesinessId:D}=(0,u.Z)(),{setPptDetail:E}=(0,x.Z)(),O=(0,s.Oi)("pptUsage"),B=(0,s.GS)("pptUsage"),L=async e=>{let{noteId:t,businessType:r}=e,{subscriptionInfo:a}=s.ZP.getState();return!!a&&(!!O||!(!B||await (0,d.jF)({threadId:t,businessType:r})<=0)||(c.$.publish("showSubscriptionPlan",void 0),!1))},Z=async e=>{let{noteId:t,businessType:r}=e;try{let{status:e}=await (0,m.Es)({threadId:t,businessType:r});return _(e),e}catch(e){return console.error("Error checking authorization:",e),_(!1),!1}},A=async t=>{let{noteId:r,businessType:l}=t;y(!0);try{if(await (0,m.qf)({threadId:r,businessType:l}))return _(!0),a.default(e("ppt.canva_connected")),!0;return _(!1),a.default(e("ppt.canva_connect_failed")),!1}catch(t){return console.error(t),_(!1),a.default(e("ppt.canva_connect_failed")),!1}finally{y(!1)}},z=async t=>{let{noteId:r,businessType:l}=t;F||(y(!0),await (0,m.Iv)({threadId:r,businessType:l})?(_(!1),a.default(e("ppt.canva_disconnected")),S(!1)):a.default(e("ppt.canva_disconnect_failed")),y(!1))},U=async t=>{let{noteId:r,businessType:l}=t;T(!0),k(!0);try{let t=await (0,v.$E)({threadId:r,businessType:l});if(!t)return a.default(e("ppt.import_ppt_failed")),!1;let o=await j({time:5e3,jobId:t,threadId:r,businessType:l}),n=null==o?void 0:o.editUrl;if(!n)return a.default(e("ppt.import_ppt_failed")),!1;return(0,f.bs)({threadId:r,canvaEditUrl:n,canvaThumbnailUrl:null==o?void 0:o.thumbnailUrl}),I(o),window.open(n),S(!0),!0}catch(t){if(console.error(t,null==t?void 0:t.message),!u.Z.getState().isReauthorized&&(null==t?void 0:t.message)==="CANVA_GET_TOKEN_FAIL")return S(!1),k(!0),_(!1),N(!0),R({retry:!0,noteId:r,businessType:f.LB.NOTE}),!1;return a.default(e("ppt.import_ppt_failed")),!1}finally{T(!1)}},R=async e=>{let{retry:t,noteId:r,businessType:a}=e;k(!0);let n=await Z({noteId:r,businessType:a});if(!0!==t&&n){let{canvaEditUrl:e,canvaThumbnailUrl:t}=(0,f.OW)({threadId:r});if(S(!0),!e){if(!await U({noteId:r,businessType:a})){k(!1),S(!1);return}k(!1);return}I({editUrl:e,thumbnailUrl:t}),(0,o.fk)(l.U.THREAD_CANVA_EDIT,{id:r},!0),window.open(e),k(!1);return}if((0,o.fk)(l.U.THREAD_CONNECT_CANVA,{id:r},!0),!await A({noteId:r,businessType:a})){k(!1);return}if(S(!0),!await U({noteId:r,businessType:a})){k(!1),S(!1);return}k(!1)},M=async e=>{let{threadId:t,businessType:r}=e;return await (0,d.OQ)({thread_id:t,businessType:r})};return{operatingPpt:async n=>{let{key:s,noteId:d,businessType:c,pptDetail:u}=n;switch(P(c),D(d),s){case"generate":if((0,o.fk)(l.U.GENERATE_PPT,{value:"generate"},!0),!r){w();return}if(!await L({noteId:d,businessType:c}))return;i("generate"),C();break;case"regenerate":if((0,o.fk)(l.U.REGENERATE_PPT,{value:"generate"},!0),!await L({noteId:d,businessType:c}))return;i("regenerate"),C();break;case"preview":if((0,o.fk)(l.U.PREVIEW_PPT,{value:"preview"},!0),!(null==u?void 0:u.ppt_url)&&!(null==u?void 0:u.pdf_url)){a.default(e("ppt.generating_ppt_tip"));return}i("preview"),C();break;case"edit":(0,o.fk)(l.U.EDIT_PPT,{value:"edit"},!0),i("edit"),C();break;case"download":(0,o.fk)(l.U.AUTHOR_DOWNLOAD_PPT,{value:"download"},!0),(null==u?void 0:u.ppt_url)?window.open(null==u?void 0:u.ppt_url):a.default(e("ppt.generating_ppt_tip"));break;case"share":{(0,o.fk)(l.U.AUTHOR_SHARE_PPT,{value:d},!0);let r=h.Z.getState().current,n=new URL("".concat(location.origin,"/docs/").concat(d));n.searchParams.append("showppt","1"),r&&n.searchParams.append("invite",r),t.copy(n.toString()),a.default(e("ppt.copied_url_success"));break}case"connectCanva":R({noteId:d,businessType:c});break;case"revokeCanva":z({noteId:d,businessType:c})}},fetchLastPpt:M,pollLastPpt:e=>{let t,{threadId:r,businessType:a,interval:l=5e3,maxAttempts:o=10,onPollingResult:n}=e,i=0;return new Promise(e=>{t=setInterval(async()=>{try{let l=await M({threadId:r,businessType:a});if(n(l),(null==l?void 0:l.status)===2||(null==l?void 0:l.status)===3){clearInterval(t),e(l);return}++i>=o&&(clearInterval(t),e(null))}catch(r){console.error("轮询 PPT 状态出错:",r),clearInterval(t),e(null)}},l)})}}}},34097:function(e,t,r){"use strict";r.d(t,{KX:function(){return i},NK:function(){return s},Vd:function(){return n},b4:function(){return o}});var a=r(27976),l=r(13263);let o=e=>fetch("".concat(a.Ez,"/smart/art/struct/query?message_id=").concat(e.message_id,"&thread_id=").concat(e.thread_id),{method:"GET",headers:(0,l.Fe)()}).then(async e=>200!==e.status?Promise.reject(e):await e.json()).catch(e=>e),n=e=>fetch("".concat(a.Ez,"/smart/art/struct/save"),{method:"POST",headers:(0,l.Fe)(),body:JSON.stringify(e)}).then(async e=>200!==e.status?Promise.reject(e):await e.json()).catch(e=>e),i=e=>fetch("".concat(a.Ez,"/smart/art/struct/update"),{method:"POST",headers:(0,l.Fe)(),body:JSON.stringify(e)}).then(async e=>200!==e.status?Promise.reject(e):await e.json()).catch(e=>e),s=async e=>{try{let t=await fetch("".concat(a.Ez,"/smart/art/struct/upload"),{method:"POST",headers:(0,l.Fe)(),body:JSON.stringify(e)});if(200!==t.status)throw Error("Error: ".concat(t.status));return await t.json()}catch(e){throw Error("Error: ".concat(e))}}},69194:function(e,t,r){"use strict";r.d(t,{D:function(){return a}});let a=e=>{let{fileUrl:t}=e;return fetch("".concat("https://preview.felo.ai","/convert?url=").concat(t),{method:"GET"}).then(async e=>200!==e.status?(console.error("Error: Response status is not 200:",e.status),e.status):await e.json()).catch(e=>(console.error("Fetch error:",e),e.response)?e.response.status:e.request?503:500)}},19583:function(e,t,r){"use strict";let a=(0,r(75910).Ue)(e=>({currentData:void 0,setCurrentData:t=>e({currentData:t}),clearCurrentData:()=>e({currentData:void 0})}));t.Z=a},73522:function(e,t,r){"use strict";let a=(0,r(75910).Ue)(e=>({isSaveLoading:!1,setIsSaveLoading:t=>e({isSaveLoading:t}),notionTemplateId:"",setNotionTemplateId:t=>e({notionTemplateId:t}),notionDirectories:[],setNotionDirectories:t=>e({notionDirectories:t})}));t.Z=a},19527:function(e,t,r){"use strict";var a=r(67185),l=r(57231);let o=(0,r(75910).Ue)(e=>({thread_id:"",showThreadModel:!1,shareStatus:"PRIVATE",backgroundTemplate:a.jW[16],shareTemplate:a.Qz[0],fontSize:1.4,typographyTheme:a.Oq[0],is_self:!1,cacheThreadImg:{},showLimitModal:!1,showThreadLimitModalData:null,setShowThreadLimitModalData:t=>e({showThreadLimitModalData:t}),setShareStatus:function(t){let r=!(arguments.length>1)||void 0===arguments[1]||arguments[1];e({shareStatus:t}),r&&(0,l.ws)({thread_id:o.getState().thread_id,read_permission:t})},setShareTemplate:t=>e({shareTemplate:t}),setFontSize:t=>e({fontSize:t}),setTypographyTheme:t=>e({typographyTheme:t}),saveToLocalStorage:()=>{let e=o.getState();localStorage.setItem("shareState",JSON.stringify(e))},setCacheThreadImg:t=>e({cacheThreadImg:t}),setShowThreadModel:t=>e({showThreadModel:t}),setShowLimitModal:t=>e({showLimitModal:t}),setSortThreadId:t=>e({thread_id:t}),setIsSelf:t=>e({is_self:t}),setBackgroundTemplate:t=>e({backgroundTemplate:t}),setShareThreadId:t=>e({thread_id:t})}));t.Z=o},50802:function(e,t,r){"use strict";let a=(0,r(75910).Ue)(e=>({threadPPTCacheData:void 0,setThreadPPTCacheData:t=>e({threadPPTCacheData:t}),pptThreadBtnEntrance:[],setThreadPptBtnEntrance:t=>e({pptThreadBtnEntrance:t})}));t.Z=a},72881:function(e,t,r){"use strict";r.d(t,{b:function(){return a}});let a=e=>{switch(null==e?void 0:e.toLowerCase()){case"pdf":return"/icons/PDF.svg";case"doc":return"/icons/DOC.svg";case"docx":return"/icons/DOCX.svg";case"ppt":return"/icons/PPT.svg";case"pptx":return"/icons/PPTX.svg";case"xls":return"/icons/XLS.svg";case"xlsx":return"/icons/XLSX.svg";case"html":return"/icons/HTML.svg";default:return"/icons/default.svg"}}},62033:function(e,t,r){"use strict";r.d(t,{f:function(){return s}});var a=JSON.parse('{"attachment":{"clickToDownload":"Click to download","noAttachment":"There is no attachment"},"bookmark":{"noBookmark":"There is no bookmark"},"core":{"askingPassword":{"requirePasswordToOpen":"This document requires a password to open","submit":"Submit"},"wrongPassword":{"submit":"Submit","tryAgain":"The password is wrong. Please try again"},"pageLabel":"Page {{pageIndex}}"},"defaultLayout":{"attachment":"Attachment","bookmark":"Bookmark","thumbnail":"Thumbnail"},"download":{"download":"Download"},"drop":{"dragDropFile":"Drag and drop a PDF document here"},"fullScreen":{"enterFullScreen":"Full screen","exitFullScreen":"Exit full screen"},"localeSwitcher":{"switchLocale":"Switch locale"},"open":{"openFile":"Open file"},"pageNavigation":{"enterPageNumber":"Enter a page number","goToFirstPage":"First page","goToLastPage":"Last page","goToNextPage":"Next page","goToPreviousPage":"Previous page"},"print":{"cancel":"Cancel","preparingDocument":"Preparing document ...","print":"Print"},"properties":{"author":"Author","close":"Close","creationDate":"Creation date","creator":"Creator","fileName":"File name","fileSize":"File size","keywords":"Keywords","modificationDate":"Modification date","pageCount":"Page count","pdfProducer":"PDF producer","pdfVersion":"PDF version","showProperties":"Show properties","subject":"Subject","title":"Title"},"rotate":{"rotateBackward":"Rotate counterclockwise","rotateForward":"Rotate clockwise"},"scrollMode":{"pageScrolling":"Page scrolling","horizontalScrolling":"Horizontal scrolling","verticalScrolling":"Vertical scrolling","wrappedScrolling":"Wrapped scrolling","singlePage":"Single Page","dualPage":"Dual Page","dualPageCover":"Dual page with cover"},"search":{"close":"Close","enterToSearch":"Enter to search","matchCase":"Match case","nextMatch":"Next match","previousMatch":"Previous match","search":"Search","wholeWords":"Whole words"},"selectionMode":{"handTool":"Hand tool","textSelectionTool":"Text selection tool"},"theme":{"switchDarkTheme":"Switch to the dark theme","switchLightTheme":"Switch to the light theme"},"thumbnail":{"thumbnailLabel":"Thumbnail of page {{pageIndex}}"},"toolbar":{"moreActions":"More actions"},"zoom":{"actualSize":"Actual size","pageFit":"Page fit","pageWidth":"Page width","zoomDocument":"Zoom document","zoomIn":"Zoom in","zoomOut":"Zoom out"}}'),l=JSON.parse('{"attachment":{"clickToDownload":"クリックしてダウンロードします","noAttachment":"添付ファイルがありません"},"bookmark":{"noBookmark":"ブックマークがありません"},"core":{"askingPassword":{"requirePasswordToOpen":"この文書を開くには、パスワードが必要です","submit":"提出"},"wrongPassword":{"submit":"提出","tryAgain":"パスワードが間違っています。 もう一度やり直してください"},"pageLabel":"ページ {{pageIndex}}"},"defaultLayout":{"attachment":"添付ファイル","bookmark":"ブックマーク","thumbnail":"サムネイル"},"download":{"download":"ダウンロード"},"drop":{"dragDropFile":"ここにPDF文書をドラッグ&ドロップします"},"fullScreen":{"enterFullScreen":"全画面表示","exitFullScreen":"全画面表示を終了します"},"localeSwitcher":{"switchLocale":"ロケールの切り替え"},"open":{"openFile":"ファイルを開きます"},"pageNavigation":{"enterPageNumber":"ページ番号を入力してください","goToFirstPage":"先頭のページ","goToLastPage":"最後のページ","goToNextPage":"次のページ","goToPreviousPage":"前のページ"},"print":{"cancel":"キャンセル","preparingDocument":"文書を準備しています..。","print":"印刷"},"properties":{"author":"著者","close":"クローズ","creationDate":"作成日","creator":"クリエイター","fileName":"ファイル名","fileSize":"ファイルサイズ","keywords":"キーワード","modificationDate":"変更日","pageCount":"ページ数","pdfProducer":"PDFプロデューサー","pdfVersion":"PDFのバージョン","showProperties":"プロパティを表示します","subject":"件名","title":"タイトル"},"rotate":{"rotateBackward":"反時計回りに回転します","rotateForward":"時計回りに回転します"},"scrollMode":{"pageScrolling":"ページスクロール","horizontalScrolling":"水平スクロール","verticalScrolling":"垂直スクロール","wrappedScrolling":"ラップスクロール","singlePage":"単ページ","dualPage":"両ページ","dualPageCover":"カバー付き両ページ"},"search":{"close":"クローズ","enterToSearch":"検索するために入力してください","matchCase":"マッチケース","nextMatch":"次のマッチケース","previousMatch":"前のマッチケース","search":"検索","wholeWords":"全体の単語数"},"selectionMode":{"handTool":"手のひらツール","textSelectionTool":"文字の選択ツール"},"theme":{"switchDarkTheme":"ダークテーマに切り替えます","switchLightTheme":"ライトテーマに切り替えます"},"thumbnail":{"thumbnailLabel":"ページのサムネイル {{pageIndex}}"},"toolbar":{"moreActions":"その他のアクション"},"zoom":{"actualSize":"実際のサイズ","pageFit":"ページに合わせます","pageWidth":"ページの幅","zoomDocument":"ドキュメントの表示を拡大し、縮小します","zoomIn":"ズームイン","zoomOut":"ズームアウト"}}'),o=JSON.parse('{"attachment":{"clickToDownload":"다운로드하려면 클릭하기","noAttachment":"첨부 파일이 없습니다"},"bookmark":{"noBookmark":"책갈피가 없습니다"},"core":{"askingPassword":{"requirePasswordToOpen":"이 문서를 열려면 암호가 필요합니다","submit":"제출"},"wrongPassword":{"submit":"제출","tryAgain":"암호가 잘못되었습니다. 다시 시도하십시오"},"pageLabel":"페이지 {{pageIndex}}"},"defaultLayout":{"attachment":"첨부","bookmark":"책갈피","thumbnail":"썸네일"},"download":{"download":"다운로드"},"drop":{"dragDropFile":"PDF 파일을 여기로 드래그하세요"},"fullScreen":{"enterFullScreen":"전체 화면","exitFullScreen":"전체 화면 종료"},"localeSwitcher":{"switchLocale":"로케일 변경"},"open":{"openFile":"파일 열기"},"pageNavigation":{"enterPageNumber":"페이지 번호를 입력하십시오","goToFirstPage":"첫 페이지","goToLastPage":"마지막 페이지","goToNextPage":"다음 페이지","goToPreviousPage":"이전 페이지"},"print":{"cancel":"취소","preparingDocument":"문서 준비 중...","print":"인쇄"},"properties":{"author":"저자","close":"닫기","creationDate":"만든 날짜","creator":"제작자","fileName":"파일 이름","fileSize":"파일 크기","keywords":"키워드","modificationDate":"수정 날짜","pageCount":"페이지 수","pdfProducer":"PDF 작성하기","pdfVersion":"PDF 버전","showProperties":"상세정보 보기","subject":"주제","title":"제목"},"rotate":{"rotateBackward":"반시계 방향으로 회전","rotateForward":"시계 방향으로 회전"},"scrollMode":{"pageScrolling":"페이지 스크롤","horizontalScrolling":"수평 스크롤","verticalScrolling":"수직 스크롤","wrappedScrolling":"랩 스크롤","singlePage":"단일 페이지","dualPage":"두 페이지","dualPageCover":"커버가 있는 두 페이지"},"search":{"close":"닫기","enterToSearch":"검색하려면 입력하세요","matchCase":"대/소문자 구분","nextMatch":"다음 찾기","previousMatch":"이전 찾기","search":"검색","wholeWords":"단어 단위로"},"selectionMode":{"handTool":"손 도구","textSelectionTool":"선택 도구"},"theme":{"switchDarkTheme":"어두운 테마로 전환","switchLightTheme":"밝은 테마로 전환"},"thumbnail":{"thumbnailLabel":"페이지의 썸네일 {{pageIndex}}"},"toolbar":{"moreActions":"추가 작업"},"zoom":{"actualSize":"실제 크기","pageFit":"페이지에 맞춤","pageWidth":"너비에 맞춤","zoomDocument":"문서 확대/축소","zoomIn":"확대","zoomOut":"축소"}}'),n=JSON.parse('{"attachment":{"clickToDownload":"Нажмите для скачивания","noAttachment":"Нет вложений"},"bookmark":{"noBookmark":"Нет закладок"},"core":{"askingPassword":{"requirePasswordToOpen":"Для открытия этого файла требуется пароль","submit":"Отправить"},"wrongPassword":{"submit":"Отправить","tryAgain":"Неверный пароль. Пожалуйста, попробуйте снова"},"pageLabel":"Страница {{pageIndex}}"},"defaultLayout":{"attachment":"Вложения","bookmark":"Закладки","thumbnail":"Миниатюры"},"download":{"download":"Скачать"},"drop":{"dragDropFile":"Перетащите PDF-документ сюда"},"fullScreen":{"enterFullScreen":"Полный экран","exitFullScreen":"Выйти из полноэкранного режима"},"localeSwitcher":{"switchLocale":"Изменить язык"},"open":{"openFile":"Открыть файл"},"pageNavigation":{"enterPageNumber":"Введите номер страницы","goToFirstPage":"Первая страница","goToLastPage":"Последняя страница","goToNextPage":"Следующая страница","goToPreviousPage":"Предыдущая страница"},"print":{"cancel":"Отмена","preparingDocument":"Подготовка документа...","print":"Печать"},"properties":{"author":"Автор","close":"Закрыть","creationDate":"Дата создания","creator":"Создатель","fileName":"Имя файла","fileSize":"Размер файла","keywords":"Ключевые слова","modificationDate":"Дата изменения","pageCount":"Количество страниц","pdfProducer":"Создано в","pdfVersion":"Версия PDF","showProperties":"Показать свойства","subject":"Тема","title":"Заголовок"},"rotate":{"rotateBackward":"Повернуть против часовой стрелки","rotateForward":"Повернуть по часовой стрелке"},"scrollMode":{"pageScrolling":"Прокрутка страниц","horizontalScrolling":"Горизонтальная прокрутка","verticalScrolling":"Вертикальная прокрутка","wrappedScrolling":"Обтекающая прокрутка","singlePage":"Одна страница","dualPage":"Две страницы","dualPageCover":"Две страницы с обложкой"},"search":{"close":"Закрыть","enterToSearch":"Введите для поиска","matchCase":"Учитывать регистр","nextMatch":"Следующее совпадение","previousMatch":"Предыдущее совпадение","search":"Поиск","wholeWords":"Только целые слова"},"selectionMode":{"handTool":"Инструмент \\"Рука\\"","textSelectionTool":"Инструмент выделения текста"},"theme":{"switchDarkTheme":"Переключить на темную тему","switchLightTheme":"Переключить на светлую тему"},"thumbnail":{"thumbnailLabel":"Миниатюра страницы {{pageIndex}}"},"toolbar":{"moreActions":"Дополнительные действия"},"zoom":{"actualSize":"Реальный размер","pageFit":"По размеру страницы","pageWidth":"По ширине страницы","zoomDocument":"Масштаб документа","zoomIn":"Увеличить","zoomOut":"Уменьшить"}}'),i=JSON.parse('{"attachment":{"clickToDownload":"點擊下載","noAttachment":"沒有附件"},"bookmark":{"noBookmark":"沒有書籤"},"core":{"askingPassword":{"requirePasswordToOpen":"此文件需要密碼才能打開","submit":"提交"},"wrongPassword":{"submit":"提交","tryAgain":"密碼錯誤。請重試"},"pageLabel":"頁面 {{pageIndex}}"},"defaultLayout":{"attachment":"附件","bookmark":"書籤","thumbnail":"縮略圖"},"download":{"download":"下載"},"drop":{"dragDropFile":"將 PDF 文檔拖放到此處"},"fullScreen":{"enterFullScreen":"全屏","exitFullScreen":"退出全屏"},"localeSwitcher":{"switchLocale":"更改區域設置"},"open":{"openFile":"打開文件"},"pageNavigation":{"enterPageNumber":"輸入頁碼","goToFirstPage":"第一頁","goToLastPage":"最後一頁","goToNextPage":"下一頁","goToPreviousPage":"上一頁"},"print":{"cancel":"取消","preparingDocument":"準備文件...","print":"打印"},"properties":{"author":"作者","close":"關閉","creationDate":"創作日期","creator":"創作者","fileName":"文件名稱","fileSize":"文件大小","keywords":"關鍵詞","modificationDate":"修改日期","pageCount":"頁數","pdfProducer":"PDF製作軟體","pdfVersion":"PDF版本","showProperties":"顯示屬性","subject":"主題","title":"標題"},"rotate":{"rotateBackward":"逆時針旋轉","rotateForward":"順時針旋轉"},"scrollMode":{"pageScrolling":"頁面滾動","horizontalScrolling":"水平滾動","verticalScrolling":"垂直滾動","wrappedScrolling":"環繞滾動","singlePage":"單頁","dualPage":"雙頁","dualPageCover":"雙頁帶封面"},"search":{"close":"關閉","enterToSearch":"輸入搜索詞","matchCase":"相符","nextMatch":"下一個相符","previousMatch":"上一個相符","search":"搜索","wholeWords":"全部詞句"},"selectionMode":{"handTool":"手型工具","textSelectionTool":"文本選擇工具"},"theme":{"switchDarkTheme":"切換到深色模式","switchLightTheme":"切換到淺色模式"},"thumbnail":{"thumbnailLabel":"頁面縮略圖 {{pageIndex}}"},"toolbar":{"moreActions":"更多操作"},"zoom":{"actualSize":"實際尺寸","pageFit":"適合頁面","pageWidth":"頁面寬度","zoomDocument":"縮放文件","zoomIn":"放大","zoomOut":"縮小"}}');let s={en:a,ja:l,ko:o,ru:n,"zh-Hans":JSON.parse('{"attachment":{"clickToDownload":"点击下载","noAttachment":"没有附件"},"bookmark":{"noBookmark":"没有书签"},"core":{"askingPassword":{"requirePasswordToOpen":"此文件需要密码才能打开","submit":"提交"},"wrongPassword":{"submit":"提交","tryAgain":"密码错误。请重试"},"pageLabel":"页面 {{pageIndex}}"},"defaultLayout":{"attachment":"附件","bookmark":"书签","thumbnail":"缩略图"},"download":{"download":"下载"},"drop":{"dragDropFile":"将 PDF 文档拖放到此处"},"fullScreen":{"enterFullScreen":"全屏","exitFullScreen":"退出全屏"},"localeSwitcher":{"switchLocale":"更改区域设置"},"open":{"openFile":"打开文件"},"pageNavigation":{"enterPageNumber":"输入页码","goToFirstPage":"第一页","goToLastPage":"最后一页","goToNextPage":"下一页","goToPreviousPage":"上一页"},"print":{"cancel":"取消","preparingDocument":"准备文件...","print":"打印"},"properties":{"author":"作者","close":"关闭","creationDate":"创作日期","creator":"创作者","fileName":"文件名称","fileSize":"文件大小","keywords":"关键词","modificationDate":"修改日期","pageCount":"页数","pdfProducer":"PDF制作软件","pdfVersion":"PDF版本","showProperties":"显示属性","subject":"主题","title":"标题"},"rotate":{"rotateBackward":"逆时针旋转","rotateForward":"顺时针旋转"},"scrollMode":{"pageScrolling":"页面滚动","horizontalScrolling":"水平滚动","verticalScrolling":"垂直滚动","wrappedScrolling":"环绕滚动","singlePage":"单页","dualPage":"双页","dualPageCover":"双页带封面"},"search":{"close":"关闭","enterToSearch":"输入搜索词","matchCase":"相符","nextMatch":"下一个相符","previousMatch":"上一个相符","search":"搜索","wholeWords":"全部词句"},"selectionMode":{"handTool":"手型工具","textSelectionTool":"文本选择工具"},"theme":{"switchDarkTheme":"切换到深色模式","switchLightTheme":"切换到浅色模式"},"thumbnail":{"thumbnailLabel":"页面缩略图 {{pageIndex}}"},"toolbar":{"moreActions":"更多操作"},"zoom":{"actualSize":"实际尺寸","pageFit":"适合页面","pageWidth":"页面宽度","zoomDocument":"缩放文件","zoomIn":"放大","zoomOut":"缩小"}}'),"zh-Hant":i}},86386:function(e){e.exports={"bg--colors":"style_bg--colors___5ol8","bg--outline":"style_bg--outline__dCZdN","bg--ppt":"style_bg--ppt__p9NqR","bg--ppt__img":"style_bg--ppt__img__BEDGc","fade-out":"style_fade-out__SaDlj",fadeOut:"style_fadeOut__pwzp8"}},606:function(){},25210:function(){},21473:function(){},97235:function(){},82605:function(){}}]);