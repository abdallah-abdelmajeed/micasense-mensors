"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4659],{64412:function(e,t,a){a.d(t,{Q:function(){return r}});var s=a(52676),n=a(25568),i=a(4814);let r=e=>{var t;let{fileName:a,w:r,h:l}=e;switch((null===(t=a.split(".").pop())||void 0===t?void 0:t.toLowerCase())||""){case"pdf":return(0,s.jsx)(n.ce,{className:(0,i.Z)(r?"w-".concat(r):"w-9",l?"h-".concat(l):"h-9")});case"doc":return(0,s.jsx)(n.yy,{className:(0,i.Z)(r?"w-".concat(r):"w-9",l?"h-".concat(l):"h-9")});case"docx":return(0,s.jsx)(n.kS,{className:(0,i.Z)(r?"w-".concat(r):"w-9",l?"h-".concat(l):"h-9")});case"xls":return(0,s.jsx)(n.Qk,{className:(0,i.Z)(r?"w-".concat(r):"w-9",l?"h-".concat(l):"h-9")});case"ppt":return(0,s.jsx)(n.PJ,{className:(0,i.Z)(r?"w-".concat(r):"w-9",l?"h-".concat(l):"h-9")});case"txt":return(0,s.jsx)(n.hu,{className:(0,i.Z)(r?"w-".concat(r):"w-9",l?"h-".concat(l):"h-9")});case"xls":return(0,s.jsx)(n.q_,{className:(0,i.Z)(r?"w-".concat(r):"w-9",l?"h-".concat(l):"h-9")});case"xlsx":return(0,s.jsx)(n.$g,{className:(0,i.Z)(r?"w-".concat(r):"w-9",l?"h-".concat(l):"h-9")});default:return(0,s.jsx)(n.X9,{className:(0,i.Z)(r?"w-".concat(r):"w-9",l?"h-".concat(l):"h-9")})}};t.Z=e=>{var t;let{fileName:a,w:r,h:l}=e;switch((null===(t=a.split(".").pop())||void 0===t?void 0:t.toLowerCase())||""){case"pdf":return(0,s.jsx)(n.X,{className:(0,i.Z)(r?"w-".concat(r):"w-9",l?"h-".concat(l):"h-9")});case"doc":return(0,s.jsx)(n.LV,{className:(0,i.Z)(r?"w-".concat(r):"w-9",l?"h-".concat(l):"h-9")});case"docx":return(0,s.jsx)(n.h_,{className:(0,i.Z)(r?"w-".concat(r):"w-9",l?"h-".concat(l):"h-9")});case"txt":return(0,s.jsx)(n.Ot,{className:(0,i.Z)(r?"w-".concat(r):"w-9",l?"h-".concat(l):"h-9")});case"png":return(0,s.jsx)(n.T3,{className:(0,i.Z)(r?"w-".concat(r):"w-9",l?"h-".concat(l):"h-9")});case"jpg":case"jpeg":return(0,s.jsx)(n.Fc,{className:(0,i.Z)(r?"w-".concat(r):"w-9",l?"h-".concat(l):"h-9")});case"tiff":return(0,s.jsx)(n.Hc,{className:(0,i.Z)(r?"w-".concat(r):"w-9",l?"h-".concat(l):"h-9")});case"gif":return(0,s.jsx)(n.oq,{className:(0,i.Z)(r?"w-".concat(r):"w-9",l?"h-".concat(l):"h-9")});case"webp":return(0,s.jsx)(n.et,{className:(0,i.Z)(r?"w-".concat(r):"w-9",l?"h-".concat(l):"h-9")});default:return(0,s.jsx)(n.vU,{className:(0,i.Z)(r?"w-".concat(r):"w-9",l?"h-".concat(l):"h-9")})}}},90488:function(e,t,a){var s=a(52676),n=a(92823),i=a(4814),r=a(65884),l=a(75271),o=a(25568);let d=e=>new Promise(t=>{let a=new window.Image;a.onload=()=>t(!0),a.onerror=()=>t(!1),a.src=e});t.Z=e=>{var t,a,c;let{width:u=16,height:m=16,src:h,title:f="",hasHtml:p=!1}=e,[g,x]=(0,l.useState)(!0);if((0,l.useEffect)(()=>{h&&d(h).then(e=>{x(!e)})},[h]),h&&h.includes(".file"))switch((null===(a=f.split(".").pop())||void 0===a?void 0:a.toLowerCase())||""){case"pdf":return(0,s.jsx)(o.X,{width:u,height:m});case"doc":return(0,s.jsx)(o.LV,{width:u,height:m});case"docx":return(0,s.jsx)(o.h_,{width:u,height:m});case"txt":return(0,s.jsx)(o.Ot,{width:u,height:m})}return g||!h?(0,s.jsx)(r.Z,{width:u,height:m,className:(0,i.Z)("inline-block align-top",null===(c=e.classNames)||void 0===c?void 0:c.wrapper,p&&"text-[#8AC5FF]")}):(0,s.jsx)(n.J,{...e,width:u,height:m,alt:"",classNames:{wrapper:(0,i.Z)("inline-block align-top",null===(t=e.classNames)||void 0===t?void 0:t.wrapper)}})}},26894:function(e,t,a){var s=a(52676),n=a(19370),i=a(90824),r=a(65884),l=a(75271),o=a(11782),d=a(7717),c=a(4590);t.Z=e=>{let{language:t,onChangeLanguage:a,hideAutoDetect:u=!1,template:m}=e,h=(0,d.useTranslations)(),f=(0,d.useLocale)(),p=(0,l.useMemo)(()=>{var e,t;return(null==m?void 0:null===(t=m.sub_topics)||void 0===t?void 0:null===(e=t[0])||void 0===e?void 0:e.title)=="ppt_generation"?o.g$.filter(e=>c.Po[e.value]):[...o.g$]},[o.g$,m]);return(0,l.useEffect)(()=>{var e,s;(null==m?void 0:null===(s=m.sub_topics)||void 0===s?void 0:null===(e=s[0])||void 0===e?void 0:e.title)!="ppt_generation"||c.Po[t]||a(f||"en")},[m,t]),(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[!u&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"flex-none flex items-center justify-center rounded-md border border-input bg-[#F6F7F9] dark:bg-[#454E5D] ring-offset-background file:border-0  file:bg-transparent file:text-sm file:font-medium  file:text-foreground placeholder:text-muted-foreground  focus-visible:outline-none focus-visible:ring-2  focus-visible:ring-ring focus-visible:ring-offset-2  disabled:cursor-not-allowed disabled:opacity-50  md:text-sm cursor-not-allowed w-fit px-3 text-sm h-8",children:h("agent.auto_detect")}),(0,s.jsx)("div",{className:"flex items-center gap-2",children:(0,s.jsx)(i.Z,{className:"w-4 h-4"})})]}),(0,s.jsxs)(n.Ph,{defaultValue:t,onValueChange:a,children:[(0,s.jsxs)(n.i4,{className:"w-fit gap-2 h-8 bg-[#F6F7F9] dark:bg-[#454E5D]",children:[u&&(0,s.jsx)(r.Z,{className:"w-4 h-4"}),(0,s.jsx)(n.ki,{})]}),(0,s.jsx)(n.Bw,{className:"language-select-dropdown",children:p.map(e=>(0,s.jsx)(n.Ql,{value:e.value,children:e.label},e.value))})]})]})}},96156:function(e,t,a){a.d(t,{Z:function(){return V}});var s=a(52676),n=a(75271),i=a(7717),r=a(96164),l=a(26595),o=a(51054),d=a(61954),c=a(43378),u=a(17224),m=a(31063),h=a(60161),f=a(65105),p=a(37766),g=a(89335),x=a(70262),v=a(84706),w=a(65819),_=a(57546),b=a(4814),j=a(31022),y=a(36551),N=a(38058),Z=a(93071),S=a(75710),F=a(13005),E=a(72932),k=a(10328),I=a(57862),A=a(57207),C=a(25010),z=a(64412),R=a(27976),P=e=>{let{handleClick:t,isMini:a,loading:r,filesList:o,threadId:d}=e,c=(0,i.useTranslations)(),{files:u,setFiles:m,removeFilesById:h}=(0,p.Z)(),f=e=>{h([e]),d||(0,N.lc)({ids:[e]})},g=(0,n.useCallback)((e,t)=>{var n;return(0,s.jsxs)(C.z,{size:"sm",variant:"ghost",className:(0,b.Z)("h-8 hover:bg-[#EDFAFF] hover:text-primary px-1 gap-1 dark:hover:bg-[#3E536E]",a?"min-w-8 w-8 rounded-full":""),disabled:t,children:[(0,s.jsx)("span",{className:"w-5 h-5 flex items-center justify-center font-medium",children:a?(0,s.jsx)(S.Z,{className:"!w-[18px] !h-[18px]"}):(0,s.jsx)(z.Z,{fileName:e.title})}),a?null:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("span",{className:"inline-block text-xs truncate flex-1 max-w-20 sm:max-w-24 md:max-w-28 lg:max-w-56 xl:max-w-96",children:[R.r8?"[".concat(null!==(n=null==e?void 0:e.words)&&void 0!==n?n:0,"] "):"",e.title]})," ",(0,s.jsx)("span",{className:"flex items-center justify-center h-4 w-4 min-w-4 min-h-4 text-[#7f94b1] cursor-pointer hover:bg-gray-200  rounded-full text-xs",onClick:t=>{t.preventDefault(),t.stopPropagation(),f(null==e?void 0:e.id)},children:(0,s.jsx)(F.Z,{size:1,className:"scale-75 rounded-full"})})]})]},e.id)},[]);return(0,s.jsxs)(A.J2,{children:[(0,s.jsx)(A.xo,{asChild:!0,children:(null==o?void 0:o.length)===1?g(u[0],r):(0,s.jsxs)(C.z,{size:"sm",variant:"ghost",className:(0,b.Z)("h-8 hover:bg-[#EDFAFF] hover:text-primary px-1 gap-1 dark:hover:bg-[#3E536E]",a?"min-w-8 w-8 rounded-full":""),disabled:r,children:[(0,s.jsx)("span",{className:"w-4 h-4 flex items-center justify-center font-medium",children:(0,s.jsx)(S.Z,{className:"!w-[18px] !h-[18px]"})}),a?null:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"inline-block text-xs truncate flex-1 max-w-20 sm:max-w-24 md:max-w-28 lg:max-w-56 xl:max-w-96",children:c("searchAddition.file_count",{count:(null==o?void 0:o.length)||0})}),(0,s.jsx)(E.Z,{})]})]})}),(0,s.jsx)(A.yk,{className:"p-0 min-w-60 !z-41 rounded-xl border-[#efefef] shadow-lg dark:border-[#222]",children:(0,s.jsxs)("div",{className:"p-0 w-full",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between gap-1 text-xs py-2.5 px-3 border-b-1 border-[#EBEEF3] dark:border-[#222]",children:[(0,s.jsx)("div",{className:"text-xs font-medium",children:c("searchAddition.addition_file_title")}),(0,s.jsxs)("div",{className:"text-xs text-gray-500",children:[(0,s.jsxs)(C.z,{variant:"ghost",size:"sm",className:(0,b.Z)("mr-2","h-6 px-1 gap-1 min-w-4 font-normal text-xs","hover:bg-[#EDFAFF] dark:hover:bg-[#3E536E]"),onClick:t,children:[(0,s.jsx)(k.Z,{size:12,className:"scale-85"}),c("searchAddition.add")]}),d?null:(0,s.jsxs)(C.z,{variant:"ghost",size:"sm",className:(0,b.Z)("h-6 px-1 gap-1 min-w-4 font-normal text-xs","hover:bg-[#EDFAFF] dark:hover:bg-[#3E536E]"),onClick:()=>{if(!d){let e=p.Z.getState().homeFiles.map(e=>e.id);(0,N.lc)({ids:e})}m([])},children:[(0,s.jsx)(I.Z,{size:12,className:"scale-85"}),c("searchAddition.remove")]})]})]}),(0,s.jsx)("div",{className:"px-2 py-3",children:o.map(e=>{var t;return(0,s.jsxs)("div",{className:(0,b.Z)("flex items-center justify-between gap-1 text-xs py-1.5 text-gray-500 px-1 rounded","hover:bg-[#EDFAFF] dark:hover:bg-[#3E536E]"),children:[(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)("div",{className:"w-4 h-4 flex items-center justify-center font-medium",children:(0,s.jsx)(z.Z,{fileName:e.title})}),(0,s.jsxs)(Z.O,{className:"inline-block text-xs truncate flex-1 max-w-48",size:"sm",children:[R.r8?"[".concat(null!==(t=null==e?void 0:e.words)&&void 0!==t?t:0,"] "):"",e.title]})]}),(!d||(null==o?void 0:o.length)>1)&&(0,s.jsx)("div",{className:"flex items-center",children:(0,s.jsx)(l.A,{variant:"light",className:"m-0 p-0 h-4 w-4 min-w-4 min-h-4 text-[#7f94b1]",size:"sm",isIconOnly:!0,startContent:(0,s.jsx)(F.Z,{size:12}),onPress:()=>f(e.id)})})]},e.id)})})]})})]})},D=a(97247),T=a(41223),O=a(74926),L=a(39109),U=a(78236);let H=(0,n.forwardRef)((e,t)=>{var a,Z;let{isMini:S,threadId:F,loading:E,type:k,mode:I}=e,A=(0,i.useTranslations)(),C=(0,u.useRouter)(),z=(0,f.WI)(),R=(0,L.Z)(),{homeFiles:H,setHomeFiles:V,files:M,setFiles:B,isUploading:$,setIsUploading:J,threadFiles:G,currentFileProgress:Q,setCurrentFileProgress:Y,previousSearchCategory:W,setPreviousSearchCategory:q,homeImages:X,isImageUploading:K,setNThUpload:ee}=(0,p.Z)(),et=(0,w.ZP)(e=>e.isLogin),ea=(0,f.P2)(),es=(0,f.Oi)("chatDocumentsUsage"),[en,ei]=(0,n.useState)(!1),[er,el]=(0,n.useState)(!1),eo=(0,n.useRef)(null),[ed,ec]=(0,n.useState)(!0),eu=()=>"home"===k?p.Z.getState().homeFiles:p.Z.getState().files,em=(0,n.useMemo)(()=>"home"===k?p.Z.getState().homeFiles:p.Z.getState().files,[k,M,H]),eh=(0,n.useMemo)(()=>es?x.Mr:x.CD,[es]),ef=(0,n.useMemo)(()=>{if(!es){var e,t;return(null!==(t=null==ea?void 0:null===(e=ea.chatDocumentsUsage)||void 0===e?void 0:e.balance)&&void 0!==t?t:0)<=0}return!1},[null==ea?void 0:ea.chatDocumentsUsage,es]),ep=()=>{var e,t;return"home"===k?(null===(e=p.Z.getState().homeFiles)||void 0===e?void 0:e.length)||0:(null===(t=p.Z.getState().files)||void 0===t?void 0:t.length)||0},eg=e=>{let{type:t}=e,a="home"===t?p.Z.getState().homeFiles:p.Z.getState().files,s=p.Z.getState().threadFiles;return Array.from(new Set([...(F?(null==a?void 0:a.filter(e=>(null==e?void 0:e.threadId)===F))||[]:(null==a?void 0:a.filter(e=>!(null==e?void 0:e.threadId)))||[]).map(e=>null==e?void 0:e.id),...(F&&(null==s?void 0:s.filter(e=>(null==e?void 0:e.threadId)===F))||[]).map(e=>null==e?void 0:e.id)]))},ex=(0,n.useMemo)(()=>{var e;return(null===(e=eg({type:k}))||void 0===e?void 0:e.length)>eh},[eh]),ev=(0,n.useMemo)(()=>z?x.fc:x.r0,[z]),ew=(0,n.useMemo)(()=>{let e="home"===k?H||[]:M||[],t=F&&(null==G?void 0:G.filter(e=>(null==e?void 0:e.threadId)===F))||[];return Array.from(new Set([...e,...t].map(e=>e.id))).map(a=>[...e,...t].find(e=>e.id===a)).reduce((e,t)=>{var a;return e+(null!==(a=null==t?void 0:t.words)&&void 0!==a?a:0)},0)>ev},[k,H,M,F,G,ev]),e_=(0,n.useMemo)(()=>z?A("searchAddition.max_words"):A("searchAddition.max_words_free"),[z]),eb=()=>{j.Z.getState().setExtensionSelected(W||y.gl),q(null)},ej=e=>["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","text/plain"].includes(e.type)?e.size>26214400?(R.default(A("searchAddition.size_limit_exceeded_tip",{size:25,pages:500})),(null==M?void 0:M.length)||eb(),!1):ew?(R.default(A("searchAddition.thread_words_limit_exceeded_tip",{words:e_})),(null==M?void 0:M.length)||eb(),!1):!ex||(z||v.$.publish("showSubscriptionPlan",void 0),R.default(A("searchAddition.thread_upload_limit_exceeded_tip",{count:eh})),!1):(R.default(A("topic.error_file_type_not_supported")),(null==M?void 0:M.length)||eb(),!1),ey=e=>{var t;let a=null!==(t=p.Z.getState().currentFileProgress)&&void 0!==t?t:0,s=setInterval(()=>{var t,n;let i=eu();a=(null!==(n=null===(t=i.find(t=>t.id===e))||void 0===t?void 0:t.progress)&&void 0!==n?n:a)+(1.9*Math.random()+.1),"home"===k?V(i.map(t=>t.id===e?{...t,progress:Math.min(a,95),status:"analyzing"}:t)):B(i.map(t=>t.id===e?{...t,progress:Math.min(a,95),status:"analyzing"}:t)),a>=95&&clearInterval(s)},800);return s},eN=async e=>{var t,a,s,n,i;if($)return;if(ef){v.$.publish("showSubscriptionPlan",void 0);return}if(ex)return;let r=null===(t=eg({type:k}))||void 0===t?void 0:t.length;if((null!==(a=null==e?void 0:e.length)&&void 0!==a?a:0)+r>eh){if(!z){v.$.publish("showSubscriptionPlan",void 0);return}R.default(A("searchAddition.thread_upload_limit_exceeded_tip",{count:eh}));return}ee((null!==(s=p.Z.getState().nThUpload)&&void 0!==s?s:0)+1);let l=Array.from(e);J(!0),j.Z.getState().setExtensionSelected(y.J5);let o=[];for(let[e,t]of Array.from(l).entries()){o.push(e);let a=eu(),s=null!==(n=p.Z.getState().nThUpload)&&void 0!==n?n:0,i="".concat(s,"_").concat(e),r=[{id:i,title:t.name,size:(0,x.sS)(t.size),token:0,pages:0,progress:0,status:"uploading",type:t.type,created_at:new Date().toISOString(),modified_at:new Date().toISOString(),length:0,words:0,threadId:F||"",tempId:i}];"home"===k&&V([...r,...a])}let d=new Map;for(let[e,t]of Array.from(l).entries()){let a=null!==(i=p.Z.getState().nThUpload)&&void 0!==i?i:0,s="".concat(a,"_").concat(e);J(!0),Y(0);try{if(await (0,N.Wl)()){if(z?R.default(A("searchAddition.upload_limit_exceeded_tip")):v.$.publish("showSubscriptionPlan",void 0),J(!1),Y(0),"home"===k){let e=eu();V((0,x._n)({files:e,tempId:s}))}continue}}catch(e){if(R.default(A("server.INTERNAL_SERVER_ERROR")),J(!1),Y(0),"home"===k){let e=eu();V((0,x._n)({files:e,tempId:s}))}continue}new FormData().append("file",t);let n="";if(!ej(t)){if("home"===k){let e=eu();V((0,x._n)({files:e,tempId:s}))}J(!1),Y(0);continue}(0,m.fk)(h.U.SEAECH_FILE,{fileName:t.name},!0),J(!0);let r=(0,x.ct)(0,e=>{if(Y(null!=e?e:0),"home"===k){let t=eu();V((0,x._n)({files:t,tempId:s})),V(t.map(t=>t.tempId===s?{...t,progress:e}:t))}});"1"!==(0,x.y6)()&&(ei(!0),(0,x.ny)());try{d.set(t.name,!0),await (0,g.Vj)({file:t,threadId:F||"",onProgress:a=>{if(n||(n=a.file_id),!d.has(n)){var s,i;let r=null!==(s=p.Z.getState().nThUpload)&&void 0!==s?s:0,l=eu(),o="home"===k?l.map(t=>t.tempId==="".concat(r,"_").concat(e)?{...t,id:n}:t):[{id:n,title:t.name,size:(0,x.sS)(t.size),token:0,pages:0,progress:null!==(i=p.Z.getState().currentFileProgress)&&void 0!==i?i:0,status:"uploading",type:t.type,created_at:new Date().toISOString(),modified_at:new Date().toISOString(),length:(null==a?void 0:a.length)||0,words:(null==a?void 0:a.words)||0,threadId:F||""}];"home"===k?V([...o]):B([...o,...l]);let c=ey(n);d.set(n,c),d.delete(t.name)}},onDone:e=>{if(r(),d.has(n)&&(clearInterval(d.get(n)),d.delete(n)),(null==e?void 0:e.status)==="SUCCESS"){var t,a;null===(t=f.ZP.getState())||void 0===t||t.reduceSubscriptioUsageTimes({featureName:"chatDocumentsUsage"});let s=eu(),i=s.reduce((e,t)=>{var a;return e+(null!==(a=null==t?void 0:t.words)&&void 0!==a?a:0)},0);if(ew||i+(null!==(a=null==e?void 0:e.words)&&void 0!==a?a:0)>ev){if(R.default(A("searchAddition.thread_words_limit_exceeded_tip",{words:e_})),"home"===k){let e=eu();V((0,x.mF)({files:e,id:n}))}else B([...(0,x.mF)({files:s,id:n})]);J(!1);return}"home"===k?V(s.map(t=>t.id===n?{...t,progress:100,words:(null==e?void 0:e.words)||0,pages:(null==e?void 0:e.page_count)||0,status:"completed"}:t)):B(s.map(t=>t.id===n?{...t,progress:100,words:(null==e?void 0:e.words)||0,pages:(null==e?void 0:e.page_count)||0,status:"completed"}:t)),J(!1);return}(null==e?void 0:e.status)==="PAGE_OVER_SIZE"?R.default(A("searchAddition.page_limit_exceeded_tip",{pages:"500"})):R.default(A("server.INTERNAL_SERVER_ERROR"));let s=eu();if("home"===k){let e=eu();V((0,x.mF)({files:e,id:n}))}else B([...(0,x.mF)({files:s,id:n})]);J(!1),Y(0)},onError:()=>{R.default(A("server.INTERNAL_SERVER_ERROR")),r(),d.delete(t.name),0===d.size&&J(!1);let e=eu();if("home"===k){let e=eu();V((0,x.mF)({files:e,id:n}))}else B([...(0,x.mF)({files:e,id:n})]);Y(0)}})}catch(t){r(),R.default(A("server.INTERNAL_SERVER_ERROR")),J(!1),Y(0);let e=eu();if("home"===k){let e=eu();V((0,x.mF)({files:e,id:n}))}else B([...(0,x.mF)({files:e,id:n})])}}ep()||(Y(0),eb())};(0,n.useImperativeHandle)(t,()=>({handleFiles:eN}));let eZ=()=>{var e;if((0,T.s2)()){el(!0);return}if(!et){_.Z.getState().setLoginModalVisible(!0);return}if(ef){v.$.publish("showSubscriptionPlan",void 0);return}if(ex){z||v.$.publish("showSubscriptionPlan",void 0),R.default(A("searchAddition.thread_upload_limit_exceeded_tip",{count:eh}));return}null===(e=eo.current)||void 0===e||e.click()};return(0,n.useEffect)(()=>{var e,t;let a=null===(t=O.Z.getState().template)||void 0===t?void 0:null===(e=t.params)||void 0===e?void 0:e.some(e=>"file"===e.type);((null==em?void 0:em.length)||(null==X?void 0:X.length))&&!a&&(O.Z.getState().clearTemplate(),W===y.Wh&&q(null)),(null==em?void 0:em.length)?j.Z.getState().setExtensionSelected(y.J5):(null==X?void 0:X.length)?j.Z.getState().setExtensionSelected(y.Ys):ed||eb(),ec(!1)},[em.length,H.length,M.length,X.length]),(0,n.useEffect)(()=>{let e=e=>{(async()=>{try{await Promise.all([p.Z.getState().setFiles([]),p.Z.getState().setHomeFiles([]),p.Z.getState().setHomeImages([]),p.Z.getState().setIsGoToSearch(!1),p.Z.getState().setHomeImagesQustions([]),U.Z.getState().setFiles([]),U.Z.getState().setHomeFiles([]),U.Z.getState().setHomeImages([]),U.Z.getState().setIsGoToSearch(!1),U.Z.getState().setHomeImagesQustions([])])}catch(e){console.error("Failed to clear search addition store:",e)}})()};return C.events.on("routeChangeStart",e),()=>{C.events.off("routeChangeStart",e)}},[C.events]),(0,s.jsxs)(s.Fragment,{children:[(0,D.N0)()||(0,D.Eg)()?null:(0,s.jsxs)("div",{className:"max-w-fit relative z-20",children:[(0,s.jsx)("input",{type:"file",ref:eo,className:"hidden",multiple:!0,accept:".pdf,.doc,.docx,.txt",onChange:e=>{let{files:t}=e.target,a=j.Z.getState().extensionSelected;q(a===y.J5||a===y.Ys?null:a),t&&eN(t),e.target.value=""}}),!$&&(null==em?void 0:em.length)&&"home"!==k?(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(P,{handleClick:eZ,isDraggingDisabled:ex,maxFileCount:eh,isMini:S,loading:E,filesList:em,threadId:F})}):(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(r.e,{delay:0,closeDelay:0,content:es?A("searchAddition.add_file_tip"):A("searchAddition.add_file_tip_free",{count:(null==ea?void 0:null===(a=ea.chatDocumentsUsage)||void 0===a?void 0:a.balance)||0}),classNames:{content:["text-white bg-gray-600 dark:bg-[#353535]"]},children:"home"===k?(0,s.jsx)(l.A,{variant:"light",size:"sm",className:(0,b.Z)("gap-1 mx-0 px-1","min-w-8","text-inherit"),isDisabled:$||K||E||(null==X?void 0:X.length)>0,startContent:(0,s.jsx)(d.Z,{size:18}),onPress:eZ,radius:S?"full":"sm"}):(0,s.jsx)(l.A,{variant:"light",size:"sm",className:(0,b.Z)("gap-1 mx-0 px-1",$?"text-primary":"text-inherit","min-w-8","text-inherit"),isDisabled:$||K||E||(null==X?void 0:X.length)>0||(null==H?void 0:H.length)>0,color:$?"primary":"default",startContent:$?Q<=0?(0,s.jsx)(o.Z,{"aria-label":"Loading...",classNames:{svg:"w-6 h-6"},size:"sm"}):(0,s.jsx)(o.Z,{"aria-label":"Loading...",classNames:{svg:"w-6 h-6"},size:"sm",value:Q,showValueLabel:!0}):(0,s.jsx)(d.Z,{size:18}),onPress:eZ,radius:S?"full":"sm"})})})]}),(0,s.jsx)(c.Vq,{open:en,onOpenChange:ei,children:(0,s.jsxs)(c.cZ,{className:"w-80 rounded-lg overflow-hidden",hideCloseButton:!0,"aria-describedby":"to_web_use_file_upload_tip",children:[(0,s.jsx)(c.a7,{className:"text-gray-500 text-sm leading-6 text-center",children:(0,s.jsx)("p",{dangerouslySetInnerHTML:{__html:null===(Z=A(z?"searchAddition.first_use_file_upload_tip_pro":"searchAddition.first_use_file_upload_tip"))||void 0===Z?void 0:Z.replace("Felo Pro","<span class='text-red-500'>Felo Pro</span>")}})}),(0,s.jsx)("div",{className:"flex justify-center p-0 sm:flex-col border-t-1 border-gray-200 dark:border-[#27272A]",children:(0,s.jsx)(l.A,{className:"w-full rounded-none bg-transparent",onPress:()=>{ei(!1)},children:A("searchAddition.first_use_file_upload_btn")})})]})}),(0,s.jsx)(c.Vq,{open:er,onOpenChange:el,children:(0,s.jsxs)(c.cZ,{className:"w-2/3 rounded-lg overflow-hidden",hideCloseButton:!0,"aria-describedby":"to_web_use_file_upload_tip",children:[(0,s.jsx)(c.a7,{className:"text-gray-500 text-sm leading-6 text-center",children:(0,s.jsx)("p",{children:A("searchAddition.to_web_use_file_upload_tip")})}),(0,s.jsx)("div",{className:"flex justify-center p-0 sm:flex-col border-t-1 border-gray-200 dark:border-[#27272A]",children:(0,s.jsx)(l.A,{className:"w-full rounded-none bg-transparent",onPress:()=>{el(!1)},children:A("searchAddition.to_web_use_file_upload_btn")})})]})})]})});H.displayName="AddFile";var V=H},12490:function(e,t,a){var s=a(52676),n=a(7717),i=a(65884),r=a(96164),l=a(31022),o=a(38188),d=a(75271),c=a(84781);t.Z=e=>{let{isReply:t}=e,a=(0,n.useTranslations)(),{isTopicSearchNetwork:u,setIsTopicSearchNetwork:m}=(0,l.Z)(),h=e=>{m(e),localStorage.setItem(o.J.TOPIC_WEB_SEARCH,e?"true":"false")};return(0,d.useEffect)(()=>{let e=localStorage.getItem(o.J.TOPIC_WEB_SEARCH);e&&m("true"===e)},[]),(0,s.jsxs)("div",{className:"flex h-8 items-center gap-2",children:[(0,s.jsx)(r.e,{classNames:{content:["text-white bg-gray-600 dark:bg-[#353535]"]},content:a(u?"topic.online_answer":"topic.offline_answer"),children:(0,s.jsxs)("div",{onClick:()=>h(!u),className:"flex justify-center gap-2 text-sm cursor-pointer ".concat(u&&"text-[#0080FF]"),children:[u?(0,s.jsx)(i.Z,{size:20}):(0,s.jsx)(c.x5,{className:"w-5 h-5"}),a("topic.web_search")]})}),t&&(0,s.jsx)("div",{className:"text-gray-500 dark:text-gray-400",children:"|"})]})}},76011:function(e,t,a){a.d(t,{F:function(){return n}}),a(52676),a(26595),a(91840),a(34180),a(48958),a(64657),a(5687),a(55383),a(93650),a(49983),a(3501),a(49264),a(7534),a(9455),a(70463);var s=a(75271);let n="felo_search_setting";t.Z=()=>((0,s.useEffect)(()=>{localStorage.getItem(n)&&localStorage.removeItem(n)},[]),null)},57207:function(e,t,a){a.d(t,{J2:function(){return l},xo:function(){return o},yk:function(){return d}});var s=a(52676),n=a(75271),i=a(62967),r=a(46571);let l=i.fC,o=i.xz,d=n.forwardRef((e,t)=>{let{className:a,align:n="center",sideOffset:l=4,...o}=e;return(0,s.jsx)(i.h_,{children:(0,s.jsx)(i.VY,{ref:t,align:n,sideOffset:l,className:(0,r.cn)("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...o})})});d.displayName=i.VY.displayName},19370:function(e,t,a){a.d(t,{Bw:function(){return p},Ph:function(){return c},Ql:function(){return g},U$:function(){return x},i4:function(){return m},ki:function(){return u}});var s=a(52676),n=a(75271),i=a(18669),r=a(72932),l=a(28930),o=a(40736),d=a(37481);let c=i.fC;i.ZA;let u=i.B4,m=n.forwardRef((e,t)=>{let{className:a,children:n,...l}=e;return(0,s.jsxs)(i.xz,{ref:t,className:(0,d.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...l,children:[n,(0,s.jsx)(i.JO,{asChild:!0,children:(0,s.jsx)(r.Z,{className:"h-4 w-4 opacity-50"})})]})});m.displayName=i.xz.displayName;let h=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(i.u_,{ref:t,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",a),...n,children:(0,s.jsx)(l.Z,{className:"h-4 w-4"})})});h.displayName=i.u_.displayName;let f=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(i.$G,{ref:t,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",a),...n,children:(0,s.jsx)(r.Z,{className:"h-4 w-4"})})});f.displayName=i.$G.displayName;let p=n.forwardRef((e,t)=>{let{className:a,children:n,position:r="popper",...l}=e;return(0,s.jsx)(i.h_,{children:(0,s.jsxs)(i.VY,{ref:t,className:(0,d.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===r&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:r,...l,children:[(0,s.jsx)(h,{}),(0,s.jsx)(i.l_,{className:(0,d.cn)("p-1","popper"===r&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:n}),(0,s.jsx)(f,{})]})})});p.displayName=i.VY.displayName,n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(i.__,{ref:t,className:(0,d.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",a),...n})}).displayName=i.__.displayName;let g=n.forwardRef((e,t)=>{let{className:a,children:n,...r}=e;return(0,s.jsxs)(i.ck,{ref:t,className:(0,d.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...r,children:[(0,s.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,s.jsx)(i.wU,{children:(0,s.jsx)(o.Z,{className:"h-4 w-4"})})}),(0,s.jsx)(i.eT,{children:n})]})});g.displayName=i.ck.displayName;let x=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(i.Z0,{ref:t,className:(0,d.cn)("-mx-1 my-1 h-px bg-muted",a),...n})});x.displayName=i.Z0.displayName},31442:function(e,t,a){a.d(t,{e:function(){return s}});let s={AdvancedAssistantDisable:"extension.advanced_assistant_disable",LoginExpired:"extension.login_expired",Timeout:"extension.timeout"}},2240:function(e,t,a){var s=a(75271);t.Z=function(){let e=(0,s.useRef)(!0);return(0,s.useEffect)(()=>{let t=()=>{e.current=!1},a=()=>{e.current=!0};return window.addEventListener("compositionstart",t),window.addEventListener("compositionend",a),()=>{window.removeEventListener("compositionstart",t),window.removeEventListener("compositionend",a)}},[]),e}},57591:function(e,t,a){var s=a(75271);t.Z=function(e){let[t,a]=(0,s.useState)(e),n=(0,s.useRef)(t);return(0,s.useEffect)(()=>{n.current=t},[t]),[t,(0,s.useCallback)(e=>{n.current=e,a(e)},[]),n]}},38058:function(e,t,a){a.d(t,{S6:function(){return l},Wl:function(){return i},lc:function(){return r}});var s=a(27976),n=a(13263);let i=async()=>{let e=(0,n.LP)();return fetch("".concat(s.EG,"/file/upload/limit"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"".concat(e)}}).then(async e=>{if(null==e?void 0:e.ok){var t;if(200!==e.status)return!0;let a=await e.json();return null===(t=null==a?void 0:a.data)||void 0===t||t}throw Error("failure")}).catch(e=>{throw console.log("error",e),Error("failure")})},r=async e=>{let{ids:t}=e,a=(0,n.LP)();return fetch("".concat(s.EG,"/file/delete"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"".concat(a)},body:JSON.stringify(t)})},l=async e=>{let{id:t}=e,a=(0,n.LP)();return t?fetch("".concat(s.XJ,"/threads/analytics/").concat(t,"/image"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"".concat(a)}}).then(async e=>{if(null==e?void 0:e.ok){if(200!==e.status)return[];let t=await e.json();return console.log("fetchAnalyticsImage response",t),t||[]}return[]}).catch(e=>(console.log("error",e),[])):[]}},13366:function(e,t,a){var s=a(75910),n=a(98496),i=a(11782);let r="agent-params-storage",l=()=>{try{let t=localStorage.getItem(r);if(t){var e;let a=JSON.parse(t);return(null===(e=a.state)||void 0===e?void 0:e.language)||""}}catch(e){console.error("Failed to parse stored language:",e)}try{if("undefined"!=typeof navigator){let e=navigator.language||navigator.userLanguage,t=i.g$.find(t=>t.value===e);if(t)return t.value;let a=e.split("-")[0],s=i.g$.find(e=>e.value===a||e.value.startsWith(a+"-"));if(s)return s.value;if("zh"===a){if(e.includes("CN")||e.includes("SG"))return"zh-Hans";if(e.includes("TW")||e.includes("HK")||e.includes("MO"))return"zh-Hant";return"zh-Hans"}}}catch(e){console.error("Failed to get browser language:",e)}return"en"},o=(0,s.Ue)()((0,n.tJ)(e=>({language:l(),setLanguage:t=>e(()=>({language:t})),initializeLanguage:t=>e(e=>e.language?e:{language:t})}),{name:r,partialize:e=>({language:e.language}),skipHydration:!0}));t.Z=o},48518:function(e,t,a){let s=(0,a(75910).Ue)(e=>({currentData:void 0,templateData:void 0,setCurrentData:t=>e({currentData:t}),setTemplateData:t=>e({templateData:t}),clearCurrentData:()=>e({currentData:void 0}),clearTemplateData:()=>e({templateData:void 0})}));t.Z=s},78236:function(e,t,a){let s=(0,a(75910).Ue)((e,t)=>({homeFiles:[],setHomeFiles:t=>e(e=>({...e,homeFiles:t})),files:[],setFiles:t=>e(e=>({...e,files:t})),isUploading:!1,setIsUploading:t=>e({isUploading:t}),documents:[],setDocuments:t=>e({documents:t}),chatDocumentsCounts:0,setChatDocumentsCounts:t=>e({chatDocumentsCounts:t}),threadFiles:[],setThreadFiles:t=>e(e=>({...e,threadFiles:t})),currentFileProgress:0,setCurrentFileProgress:t=>e({currentFileProgress:t}),previousSearchCategory:null,setPreviousSearchCategory:t=>e({previousSearchCategory:t}),removeHomeFilesById:a=>{let s=t().homeFiles;e({homeFiles:[...null==s?void 0:s.filter(e=>!a.includes(e.id))]})},removeFilesById:a=>{let s=t().files;e({files:[...null==s?void 0:s.filter(e=>!a.includes(e.id))]})},nThUpload:0,setNThUpload:t=>e({nThUpload:t}),isImageUploading:!1,setIsImageUploading:t=>e({isImageUploading:t}),homeImages:[],setHomeImages:t=>e({homeImages:t}),threadImages:[],setThreadImages:t=>e({threadImages:t}),isOpenFirstUseModal:!1,setIsOpenFirstUseModal:t=>e({isOpenFirstUseModal:t}),removeHomeImageSById:a=>{let s=t().homeImages;e({homeImages:[...null==s?void 0:s.filter(e=>!a.includes(e.id))]})},homeImageSQustions:[],setHomeImagesQustions:t=>e({homeImageSQustions:t}),isImageChat:!0,setIsImageChat:t=>e({isImageChat:t}),isGoToSearch:!1,setIsGoToSearch:t=>e({isGoToSearch:t})}));t.Z=s},88708:function(e,t,a){a.d(t,{LQ:function(){return d},Sc:function(){return n},YX:function(){return i},Ye:function(){return o},el:function(){return r},qG:function(){return l},u1:function(){return c}});var s=a(25994);let n=e=>e===s.PN,i=e=>e===s.$8||e===s.PN,r=e=>{var t;return null===(t=e.params)||void 0===t?void 0:t.some(e=>i(e.type))},l=e=>{var t;return null===(t=e.params)||void 0===t?void 0:t.some(e=>e.type===s.PN)},o=e=>{var t;return null===(t=e.params)||void 0===t?void 0:t.some(e=>"file"===e.type)},d=e=>{var t;return null===(t=e.params)||void 0===t?void 0:t.some(e=>"file"===e.type)},c=e=>{var t;return null===(t=e.params)||void 0===t?void 0:t.some(e=>e.type===s.Kp)}},44509:function(e,t,a){a.d(t,{T:function(){return n},Y:function(){return s}});let s=async(e,t,a)=>{var s;let n=e.getBoundingClientRect(),i=null===(s=document.querySelector("#".concat(t)))||void 0===s?void 0:s.getBoundingClientRect();if(!i){null==a||a();return}let{width:r,left:l,top:o}=n,{left:d,bottom:c,height:u,width:m}=i,h=e.animate([{transformOrigin:"top",transform:"translate(0, 0) scale(1)",opacity:1},{opacity:0,transform:"translate(".concat(d-l+(m-r)/2,"px, ").concat(c-o-u/2,"px) scale(0)"),transformOrigin:"top"}],{duration:300,fill:"forwards"});await h.finished,null==a||a()},n=async(e,t,a)=>{var s;let n=e.getBoundingClientRect(),i=null===(s=document.querySelector("#".concat(t)))||void 0===s?void 0:s.getBoundingClientRect();if(!i){null==a||a();return}let{width:r}=n,{left:l,top:o}=i,d=window.innerWidth/2,c=window.innerHeight/2,u=e.animate([{transformOrigin:"top",transform:"translate(0, 0) scale(1)",opacity:1},{opacity:0,transform:"translate(".concat(l-d-r/2,"px, ").concat(o-c,"px) scale(0)"),transformOrigin:"top"}],{duration:600,fill:"forwards"});await u.finished,null==a||a()}},34276:function(e,t,a){a.d(t,{f:function(){return i}});var s=a(97247),n=a(60635);let i=async e=>{let{query:t,setLoading:a}=e;if((0,s.Eg)()){if(!t)return!1;a(!0),(0,n.mN)(t);try{let e=await (0,n.C1)({type:"onGetHKTVMallQueryStatus",timeout:4e3});if(console.log("isValidatedQuery",e),a(!1),!0!==e)return!1}catch(e){return console.log("\uD83D\uDE80 ~ onSubmit ~ error:",e),a(!1),!1}}return!0}},93734:function(e,t,a){a.d(t,{Y:function(){return n},h:function(){return i}});var s=a(36551);let n=e=>{let t="";switch(e){case s.gl:case s.ti:case s.rN:t="extension.all";break;case s.pN:t="extension.social";break;case s.Kp:t="extension.academic";break;case s.hs:t="extension.document";break;case s.zA:t="extension.xiaohongshu";break;case s.X7:t="extension.twitter";break;case s.xn:t="extension.reddit";break;case s.aI:case s.Bv:t="extension.chat";break;case s.J5:t="extension.chat_with_document";break;case s.Wh:t="extension.search_agent";break;case s.V9:t="extension.web_summary";break;case s.Ys:t="extension.chat_with_image";break;case s.RQ:t="topic.topic";break;case s.Ts:t="extension.chat_with_voice"}return t},i=e=>{let t="";switch(e){case s.gl:t="extension.all";break;case s.pN:t="extension.social_search";break;case s.Kp:t="extension.academic_search";break;case s.hs:t="extension.document_search";break;case s.zA:t="extension.xiaohongshu_search";break;case s.X7:t="extension.twitter_search";break;case s.xn:t="extension.reddit_search";break;case s.aI:t="extension.chat";break;case s.RQ:t="topic.topic"}return t}}}]);