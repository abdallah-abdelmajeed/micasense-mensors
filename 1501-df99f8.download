(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1501],{46024:function(e,t,n){"use strict";n.d(t,{Hf:function(){return d},e:function(){return o},fX:function(){return i},nj:function(){return s},om:function(){return c},pi:function(){return l},vN:function(){return a}});var r=n(52676);let a=e=>(0,r.jsx)("svg",{width:"18",height:"18",viewBox:"0 0 18 18",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e,children:(0,r.jsx)("path",{d:"M11.0816 14.2125L10.4441 16.0312C10.3941 16.1687 10.3066 16.2813 10.1816 16.3688C10.0566 16.4563 9.91914 16.5 9.76914 16.5C9.51914 16.5 9.31601 16.3969 9.15976 16.1906C9.00351 15.9844 8.97539 15.7563 9.07539 15.5063L11.9254 7.96875C11.9879 7.83125 12.0816 7.71875 12.2066 7.63125C12.3316 7.54375 12.4691 7.5 12.6191 7.5H13.1816C13.3316 7.5 13.4691 7.54375 13.5941 7.63125C13.7191 7.71875 13.8129 7.83125 13.8754 7.96875L16.7254 15.525C16.8254 15.7625 16.8004 15.9844 16.6504 16.1906C16.5004 16.3969 16.3004 16.5 16.0504 16.5C15.8879 16.5 15.7473 16.4563 15.6285 16.3688C15.5098 16.2813 15.4191 16.1625 15.3566 16.0125L14.7191 14.2125H11.0816ZM6.56289 10.4813L3.30039 13.725C3.16289 13.8625 2.99102 13.9344 2.78477 13.9406C2.57852 13.9469 2.40039 13.875 2.25039 13.725C2.11289 13.5875 2.04414 13.4125 2.04414 13.2C2.04414 12.9875 2.11289 12.8125 2.25039 12.675L5.51289 9.4125C5.07539 8.975 4.67852 8.475 4.32227 7.9125C4.1397 7.62425 3.95468 7.30269 3.77729 6.96178C3.5317 6.4898 3.88878 5.94819 4.42083 5.94819C4.69989 5.94819 4.95397 6.10523 5.09024 6.34875C5.28183 6.69114 5.48216 7.01294 5.66289 7.275C5.91289 7.6375 6.21289 8 6.56289 8.3625C6.97539 7.95 7.40352 7.37188 7.84727 6.62813C8.29102 5.88438 8.62539 5.175 8.85039 4.5H2.02539C1.81289 4.5 1.63477 4.42813 1.49102 4.28438C1.34727 4.14062 1.27539 3.9625 1.27539 3.75C1.27539 3.5375 1.34727 3.35938 1.49102 3.21563C1.63477 3.07188 1.81289 3 2.02539 3H5.77539V2.25C5.77539 2.0375 5.84727 1.85938 5.99102 1.71562C6.13477 1.57187 6.31289 1.5 6.52539 1.5C6.73789 1.5 6.91602 1.57187 7.05977 1.71562C7.20352 1.85938 7.27539 2.0375 7.27539 2.25V3H10.6504C10.8629 3 11.041 3.07188 11.1848 3.21563C11.3285 3.35938 11.4004 3.5375 11.4004 3.75C11.4004 3.9625 11.3285 4.14062 11.1848 4.28438C11.041 4.42813 10.8629 4.5 10.6504 4.5H10.3504C10.0879 5.4 9.69414 6.325 9.16914 7.275C8.64414 8.225 8.12539 8.95 7.61289 9.45L9.0871 10.9549C9.28614 11.1581 9.35066 11.4576 9.25293 11.7247C9.06635 12.2347 8.41136 12.3752 8.03206 11.9865L6.56289 10.4813ZM11.5504 12.9H14.2504L12.9004 9.075L11.5504 12.9Z",fill:"currentColor"})}),l=e=>(0,r.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e,children:(0,r.jsx)("path",{d:"M22 11.086v.92a10 10 0 1 1-5.93-9.14M22 4L12 14.01l-3-3",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),s=e=>(0,r.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e,children:(0,r.jsx)("path",{d:"M10 8.00224C10.1762 7.50136 10.524 7.07901 10.9817 6.80998C11.4395 6.54095 11.9777 6.4426 12.501 6.53237C13.0243 6.62213 13.499 6.89421 13.8409 7.30041C14.1829 7.70661 14.37 8.22072 14.3692 8.75168C14.3692 10.2506 12.1209 11 12.1209 11M12.1499 14H12.1599M7 18V20.3355C7 20.8684 7 21.1348 7.10923 21.2716C7.20422 21.3906 7.34827 21.4599 7.50054 21.4597C7.67563 21.4595 7.88367 21.2931 8.29976 20.9602L10.6852 19.0518C11.1725 18.662 11.4162 18.4671 11.6875 18.3285C11.9282 18.2055 12.1844 18.1156 12.4492 18.0613C12.7477 18 13.0597 18 13.6837 18H16.2C17.8802 18 18.7202 18 19.362 17.673C19.9265 17.3854 20.3854 16.9265 20.673 16.362C21 15.7202 21 14.8802 21 13.2V7.8C21 6.11984 21 5.27976 20.673 4.63803C20.3854 4.07354 19.9265 3.6146 19.362 3.32698C18.7202 3 17.8802 3 16.2 3H7.8C6.11984 3 5.27976 3 4.63803 3.32698C4.07354 3.6146 3.6146 4.07354 3.32698 4.63803C3 5.27976 3 6.11984 3 7.8V14C3 14.93 3 15.395 3.10222 15.7765C3.37962 16.8117 4.18827 17.6204 5.22354 17.8978C5.60504 18 6.07003 18 7 18Z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),i=e=>(0,r.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e,children:(0,r.jsx)("path",{d:"M10 17.6586V20C10 21.1046 10.8954 22 12 22C13.1046 22 14 21.1046 14 20V17.6586M12 2V3M3 12H2M5.5 5.5L4.8999 4.8999M18.5 5.5L19.1002 4.8999M22 12H21M18 12C18 15.3137 15.3137 18 12 18C8.68629 18 6 15.3137 6 12C6 8.68629 8.68629 6 12 6C15.3137 6 18 8.68629 18 12Z",stroke:"#0080FF",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),o=e=>(0,r.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e,children:[(0,r.jsx)("path",{d:"M8.00001 14.6668C11.6667 14.6668 14.6667 11.6668 14.6667 8.00016C14.6667 4.3335 11.6667 1.3335 8.00001 1.3335C4.33334 1.3335 1.33334 4.3335 1.33334 8.00016C1.33334 11.6668 4.33334 14.6668 8.00001 14.6668Z",fill:"#02B66F",stroke:"#02B66F",strokeWidth:"1.33333",strokeLinecap:"round",strokeLinejoin:"round"}),(0,r.jsx)("path",{d:"M5.16666 7.99995L7.05332 9.88661L10.8333 6.11328",stroke:"white",strokeWidth:"1.33333",strokeLinecap:"round",strokeLinejoin:"round"})]}),c=e=>(0,r.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e,children:(0,r.jsx)("path",{d:"M5 21C4.45 21 3.97917 20.8042 3.5875 20.4125C3.19583 20.0208 3 19.55 3 19V5C3 4.45 3.19583 3.97917 3.5875 3.5875C3.97917 3.19583 4.45 3 5 3H19C19.55 3 20.0208 3.19583 20.4125 3.5875C20.8042 3.97917 21 4.45 21 5V19C21 19.55 20.8042 20.0208 20.4125 20.4125C20.0208 20.8042 19.55 21 19 21H5ZM5 19H19V5H5V19ZM7 17H17C17.2 17 17.35 16.9083 17.45 16.725C17.55 16.5417 17.5333 16.3667 17.4 16.2L14.65 12.525C14.55 12.3917 14.4167 12.325 14.25 12.325C14.0833 12.325 13.95 12.3917 13.85 12.525L11.25 16L9.4 13.525C9.3 13.3917 9.16667 13.325 9 13.325C8.83333 13.325 8.7 13.3917 8.6 13.525L6.6 16.2C6.46667 16.3667 6.45 16.5417 6.55 16.725C6.65 16.9083 6.8 17 7 17Z",fill:"currentColor"})}),d=e=>(0,r.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e,children:(0,r.jsx)("path",{d:"M15.85 12.425C16 12.325 16.075 12.1833 16.075 12C16.075 11.8167 16 11.675 15.85 11.575L10.275 8C10.1083 7.88333 9.9375 7.875 9.7625 7.975C9.5875 8.075 9.5 8.225 9.5 8.425V15.575C9.5 15.775 9.5875 15.925 9.7625 16.025C9.9375 16.125 10.1083 16.1167 10.275 16L15.85 12.425ZM5 21C4.45 21 3.97917 20.8042 3.5875 20.4125C3.19583 20.0208 3 19.55 3 19V5C3 4.45 3.19583 3.97917 3.5875 3.5875C3.97917 3.19583 4.45 3 5 3H19C19.55 3 20.0208 3.19583 20.4125 3.5875C20.8042 3.97917 21 4.45 21 5V19C21 19.55 20.8042 20.0208 20.4125 20.4125C20.0208 20.8042 19.55 21 19 21H5ZM5 19H19V5H5V19Z",fill:"currentColor"})})},81501:function(e,t,n){"use strict";n.d(t,{Z:function(){return ee}});var r=n(52676),a=n(75271),l=n(82313),s=n(26595),i=n(14701),o=n.n(i),c=n(43220),d=n.n(c),u=n(13003),h=n(31022),p=n(46264),m=n(13288),g=n(57434),x=n(75450),f=n(6229),v=n(77774),b=n(14593),k=n(34407);n(16832);var w=n(70017),j=n(40736),C=n(35362),y=n(4590),N=n(97247),_=n(60635),F=n(25339),S=n(2839),D=n(41250),Z=n(82550),M=n(20271),E=n(49759),L=n(56975),A=n(41031),T=n(74538),z=n(25568),H=n(67241),I=n(13263),R=n(7717),B=n(99421),P=n(29871);let $=e=>e&&(e.startsWith("https://sandbox_outputs")||e.startsWith("sandbox_outputs"))?e.replace(/^(https:\/\/)?sandbox_outputs/,"".concat("https://api.felo.ai/search","/resources/sandbox_outputs")):e;var V=n(43378),Y=n(79736),q=n(52502),O=n(92070),U=n(69017),J=n(39496),W=n(13005),X=n(1167),K=n(27976);function G(e){let{src:t,alt:n,sources:l}=e,s=(0,R.useTranslations)(),[i,o]=(0,a.useState)(1.2),[c,d]=(0,a.useState)(!1),[h,p]=(0,a.useState)({x:0,y:0}),[m,g]=(0,a.useState)({x:0,y:0}),[x,f]=(0,a.useState)(!1),[v,b]=(0,a.useState)(!1),[k,w]=(0,a.useState)(""),[j,C]=(0,a.useState)(!1),y=e=>{e.stopPropagation(),C(!j)},F=e=>{if((0,N.N0)()){(0,_.oh)({url:e});return}window.open(e,"_blank")},S=e=>e.split(/(\[\d+\])/g).map((e,t)=>{let n=e.match(/\[(\d+)\]/);if(n){let a=n[1],s=null==l?void 0:l[Number(a)-1];return s?(0,r.jsx)("span",{className:"footnote-ref inline-block mx-[2px] my-0 select-none",children:(0,r.jsx)(u.Z,{source:s,rid:s.url,children:(0,r.jsx)("a",{className:"inline-block text-[#475467] dark:text-[#babdc5] leading-normal cursor-pointer no-underline font-medium bg-theme-bg-300 dark:bg-theme-bg-dark-300 min-w-4 h-4 text-center rounded-full align-top text-xs",href:s.url,target:"_blank",onClick:e=>{e.preventDefault(),e.stopPropagation(),F(s.url)},children:a})})},t):(0,r.jsx)("span",{children:e},t)}return/<[^>]*>/.test(e)?(0,r.jsx)("span",{dangerouslySetInnerHTML:{__html:e}},t):(0,r.jsx)("span",{children:e},t)}),D=()=>{d(!1)};(0,a.useEffect)(()=>{if(t){let e=new Image;e.src=t,e.onload=()=>{f(!0),w(t)},e.onerror=()=>{w("".concat(K.XJ,"/imgs/").concat(btoa(t)))}}},[t]),(0,a.useEffect)(()=>{if(!k)return;let e=new Image;e.src=k,e.onload=()=>{f(!0)},e.onerror=()=>{f(!1),b(!0)}},[k]);let Z=()=>(0,r.jsx)("div",{className:"absolute top-0 right-[-35px] opacity-0  group-hover:opacity-100 transition-opacity bg-[#F6F7F9]  dark:bg-[#2F333C] rounded-md flex items-center",children:(0,r.jsx)(X.pn,{delayDuration:0,children:(0,r.jsxs)(X.u,{children:[(0,r.jsx)(X.aJ,{asChild:!0,children:(0,r.jsx)("button",{className:"p-1.5 rounded-l-md",onClick:y,children:(0,r.jsx)(O.Z,{size:16,className:"text-[#64778A] dark:text-[#BBBDC5]"})})}),(0,r.jsx)(X._v,{children:s("hide_image")})]})})});return x?(0,r.jsxs)(r.Fragment,{children:[j&&n&&(0,r.jsx)(X.pn,{delayDuration:0,children:(0,r.jsxs)(X.u,{children:[(0,r.jsx)(X.aJ,{asChild:!0,children:(0,r.jsxs)("span",{className:"p-1 cursor-pointer my-2 bg-[#D1E6FF] dark:bg-[#242A38] text-sm rounded-lg",onClick:y,children:[(0,r.jsx)(U.Z,{className:"w-4 h-4 mr-2 inline-block"}),(0,r.jsx)("span",{className:"align-middle",children:S(n)})]})}),(0,r.jsx)(X._v,{children:s("show_image")})]})}),v?(0,r.jsxs)("span",{className:"".concat(j&&"hidden"," text-black/30 dark:text-white/30 relative group bg-gray-100 dark:bg-[#242A38] text-sm rounded-lg p-1"),children:[(0,r.jsx)(J.Z,{className:"w-4 h-4 mr-1 inline-block"}),(0,r.jsx)("span",{className:"align-middle",children:s("image_not_found")}),Z()]}):(0,r.jsx)("div",{className:"".concat(j&&"hidden"," text-center max-w mb-6 mt-4 flex items-center justify-center"),onClick:e=>{e.stopPropagation(),e.preventDefault()},children:(0,r.jsxs)("div",{className:"border-1 p-4 group rounded-lg relative border-[#EAEFF4] dark:border-[#242A38]",children:[(0,r.jsxs)(V.Vq,{onOpenChange:e=>{e?o(1.2):(o(1),p({x:0,y:0}))},children:[(0,r.jsx)(V.hg,{asChild:!0,children:(0,r.jsxs)("div",{className:"inline-block",children:[(0,r.jsx)("img",{src:k,alt:n,className:"inline-block mt-0 cursor-pointer object-cover select-none outline-none mb-2"}),Z()]})}),(0,r.jsx)(V.cZ,{hideCloseButton:!0,className:"max-w-[100vw] max-h-[100vh] w-screen h-screen p-0 border-none bg-black/90",children:(0,r.jsxs)(V.a7,{children:[(0,r.jsx)("div",{className:"absolute top-8 right-2 z-20",children:(0,r.jsx)(V.GG,{className:"rounded-full p-1 bg-white/80 outline-none dark:bg-gray-700",children:(0,r.jsx)(W.Z,{size:24})})}),(0,r.jsx)(Y.M,{children:(0,r.jsx)(q.E.div,{className:"w-full h-full flex items-center justify-center",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.1},children:(0,r.jsx)(q.E.img,{src:k,alt:n,className:"max-w-full max-h-[90vh] object-contain cursor-move",style:{scale:i,x:h.x,y:h.y,touchAction:"none"},onWheel:e=>{e.preventDefault(),o(e.deltaY>0?Math.max(.5,.95*i):Math.min(5,i/.95))},onTouchStart:e=>{2===e.touches.length&&g({x:Math.hypot(e.touches[0].clientX-e.touches[1].clientX,e.touches[0].clientY-e.touches[1].clientY),y:0})},onTouchMove:e=>{if(2===e.touches.length){let t=Math.hypot(e.touches[0].clientX-e.touches[1].clientX,e.touches[0].clientY-e.touches[1].clientY);o(Math.min(Math.max(.5,i+(t-m.x)*.01),5)),g({x:t,y:0})}},onMouseDown:e=>{d(!0),g({x:e.clientX-h.x,y:e.clientY-h.y})},onMouseMove:e=>{c&&p({x:e.clientX-m.x,y:e.clientY-m.y})},onMouseUp:D,onMouseLeave:D,drag:!0,dragConstraints:{top:-300,left:-300,right:300,bottom:300}})})})]})})]}),!!n&&(0,r.jsx)("p",{className:"text-center text-xs font-normal text-gray-400 dark:text-gray-500 select-text",children:S(n)})]})})]}):(0,r.jsx)("span",{className:"inline-block [&~br]:hidden"})}let Q=e=>{var t,n,l;let i=(0,w.V)(),o=(0,a.useRef)(null),c=(0,R.useTranslations)(),[d,u]=(0,a.useState)(!1);null===(l=e.children)||void 0===l||null===(n=l.props)||void 0===n||null===(t=n.className)||void 0===t||t.includes("language-md");let h=async e=>{if(o.current){u(!0);let t=o.current.textContent||"";await (0,I.zC)({file_type:e,markdown:t},()=>{u(!1)})}};return(0,r.jsxs)("pre",{ref:o,className:"relative whitespace-break-spaces rounded-2xl dark:border dark:border-[#606B80]",children:[e.isDocument&&(0,r.jsx)("div",{className:"cursor-pointer",children:(0,r.jsxs)(E.F,{children:[(0,r.jsx)(L.S,{children:(0,r.jsx)(s.A,{isIconOnly:!0,size:"sm",className:"absolute w-[14px] mr-2 top-2 right-8 text-white",variant:"light",onPress:()=>{if(o.current){let e=o.current.innerText;i.copy(e)}},children:d?(0,r.jsx)(H.dP,{}):(0,r.jsx)(H.oA,{})})}),(0,r.jsxs)(A.a,{variant:"flat",onAction:e=>h(e),className:"p-2",children:[(0,r.jsx)(T.W,{startContent:(0,r.jsx)(z.O3,{}),className:"text-[#1D3C6D] hover:!bg-blue-100 hover:!text-[#1D3C6D] dark:text-[#EDF3FC] hover:dark:!bg-[#1D3C6D] hover:dark:!text-[#EDF3FC]",children:c("export_docx")},"DOCX"),(0,r.jsx)(T.W,{startContent:(0,r.jsx)(z.IG,{}),className:"text-[#1D3C6D] hover:!bg-blue-100 hover:!text-[#1D3C6D] dark:text-[#EDF3FC] hover:dark:!bg-[#1D3C6D] hover:dark:!text-[#EDF3FC]",children:c("export_pdf")},"PDF")]})]})}),(0,r.jsx)(s.A,{isIconOnly:!0,size:"sm",className:"absolute top-2 right-2 text-white",variant:"light",onPress:()=>{if(o.current){let e=o.current.innerText;i.copy(e)}},children:i.copied?(0,r.jsx)(j.Z,{size:16,color:"#4ba570"}):(0,r.jsx)(C.Z,{size:14})}),e.children]})};var ee=a.memo(e=>{var t,n,s,i;let{className:c,children:w,sources:j,rid:C,loading:E,isVisible:L,isDocument:A}=e,T=(0,R.useTranslations)(),z=(0,a.useRef)(""),[H,I]=(0,a.useState)(!1),V=(0,a.useRef)([]),Y=(0,a.useRef)(null),{isMobile:q}=(0,P.Z)(),O=(0,a.useMemo)(()=>e=>{let{node:t,...n}=e;if(!n.href)return null;let{extensionEnable:a,legacyExtensionEnable:l}=h.Z.getState(),s=j?j[+n.href-1]:void 0,i=(null==s?void 0:s.url)||(null==s?void 0:s.link)||n.href;i=$(i);let o=e=>{if(e.preventDefault(),(0,N.N0)()){(0,_.oh)({url:i});return}a?window.open((0,y.m1)(i),"_blank"):l?window.open((0,y.m1)(i,!0),"_blank"):window.open(i,"_blank")};if(!s){let e=n.children||i||"";if(/^-?\d+(\.\d+)?$/.test(e))return;let t=e.length>200?/https?:\/\/[-a-zA-Z0-9@:%._+~#=]{2,256}\b([-a-zA-Z0-9@:%_+.~#?&/=]*)/g:RegExp(F.FK,"gi"),a=t.exec(e),l=[];for(;null!==a&&a&&a[0]!==a.input;){let[e,n]=a,r=a.input.substring(0,a.index),s=new F.fh(e,n),i=a.input.substring(a.index+a[0].length);a=t.exec(i),l=[...l,{type:"text",content:r},{type:"link",content:s.getAnchorText(),href:s.getAnchorHref()},{type:"text",content:a?"":i}]}let s="inline cursor-pointer no-underline text-blue-500 dark:text-blue-500 hover:underline";return l.length?(0,r.jsx)(r.Fragment,{children:l.map((e,t)=>"link"===e.type?(0,r.jsx)("a",{href:e.href,target:"_blank",className:s,children:e.content},t):e.content)}):(0,r.jsx)("a",{href:i,target:"_blank",className:s,onClick:o,children:n.children})}if(s){var c;null==t||null===(c=t.position)||void 0===c||c.start.offset}return(0,r.jsx)("span",{className:"".concat(d().footnoteRef," footnote-ref"),children:(0,r.jsx)(u.Z,{source:s,precedingText:"",rid:C,children:(0,r.jsx)("a",{className:"inline-block leading-normal !text-inherit cursor-pointer no-underline font-medium bg-theme-bg-300 dark:bg-theme-bg-dark-300 min-w-4 h-4 text-center rounded-full text-xs",href:i,target:"_blank",onClick:o,children:n.href})})})},[j]),U=(0,a.useMemo)(()=>e=>{let{...t}=e;return(0,r.jsx)("p",{...t,dir:"auto"})},[]),J=(0,a.useMemo)(()=>e=>{let{id:t,className:n,children:a,...l}=e;return t&&t.includes("answer_reflection_start")?(0,r.jsxs)("div",{className:n,...l,children:[(0,r.jsx)("hr",{}),(0,r.jsxs)("div",{className:"mt-[0px] mb-4 text-[#0080FF] flex items-center gap-x-2",children:[(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",children:[(0,r.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,r.jsx)("path",{d:"M2 12h20M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"})]}),(0,r.jsx)("span",{children:T("step.searching_internet")}),(0,r.jsxs)("span",{className:"inline-flex items-center h-4",children:[(0,r.jsx)("span",{className:"w-1 h-1 mx-0.5 rounded-full bg-current animate-loading-dot"}),(0,r.jsx)("span",{className:"w-1 h-1 mx-0.5 rounded-full bg-current animate-loading-dot delay-200"}),(0,r.jsx)("span",{className:"w-1 h-1 mx-0.5 rounded-full bg-current animate-loading-dot delay-400"})]})]})]}):t&&t.includes("answer_reflection")?(0,r.jsxs)("div",{className:n,...l,children:[(0,r.jsx)("hr",{}),(0,r.jsx)("div",{className:"mt-[0px] mb-4 text-[#0080FF] flex items-center gap-x-2",children:(0,r.jsx)("span",{children:T("step.supplement_from_search")})})]}):(0,r.jsx)("div",{className:n,...l,children:a})},[]);(0,a.useEffect)(()=>{E||V.current.forEach(e=>{(0,B.cC)(e.source,e.rid,e.precedingText,e.link)})},[E]),(0,a.useEffect)(()=>{let e=(null==j?void 0:j.some(e=>"scholar"===e.engine_name||"scholar"===e.engine))||!1;!E&&L&&(H||e||q||I(!0))},[E,L,H,q]);let W=e=>{let t=/```[\s\S]*?```/g,n=e.split(t),r=e.match(t)||[],a=n.map(e=>e.replace(/((\[\d+\][ \t]*)+)/g,'<span class="footnote-wrapper">$1</span>')),l="";for(let e=0;e<a.length;e++)l+=a[e],e<r.length&&(l+=r[e]);return l},X=(0,a.useMemo)(()=>{let e=null==w?void 0:w.replace(/\[(\d+(?:,\s*\d+)*)\]/g,(e,t)=>t.split(",").map(e=>"[".concat(e.trim(),"]")).join(""));return e=(0,B.k5)(W(e||"")),e="".replace("",e),z.current=e,e},[w]);(0,a.useEffect)(()=>{let e=e=>{Y.current&&Y.current.contains(e.target)&&(e.preventDefault(),(0,B.$5)(e))};return document.addEventListener("copy",e),()=>{document.removeEventListener("copy",e)}},[]);let K=(0,a.useMemo)(()=>e=>{let{src:t,alt:n,...a}=e;if(null==t?void 0:t.startsWith("https://DATA_URI/")){let e=decodeURIComponent(t.replace("https://DATA_URI/",""));return(0,r.jsx)(G,{src:e,sources:j,alt:n||""})}let l=$(t||"");return(0,r.jsx)(G,{src:l,sources:j,alt:n||""})},[j]);return(0,r.jsx)("div",{className:c,ref:Y,children:(0,r.jsx)(l.U,{className:o().markdown,remarkPlugins:[f.Z,x.Z,g.Z,D.Z,Z.Z,M.Z],rehypePlugins:[v.Z,[b.Z,{...k.R,attributes:{...k.R.attributes,"*":[...(null===(t=k.R.attributes)||void 0===t?void 0:t["*"])||[],"className","style","data-*"],code:[...(null===(n=k.R.attributes)||void 0===n?void 0:n.code)||[],"className","data-language"],div:[...(null===(s=k.R.attributes)||void 0===s?void 0:s.div)||[],"className","id","style"],span:[...(null===(i=k.R.attributes)||void 0===i?void 0:i.span)||[],"className","style"]},tagNames:[...k.R.tagNames||[],"svg","path","circle","polygon","polyline","line","rect","iframe","details","summary","section","article","aside","header","footer","nav","main"]}],m.Z,[p.Z,{detect:!1,ignoreMissing:!0}],S.Z],components:{pre:e=>Q({...e,isDocument:A}),p:U,a:O,div:J,img:K},children:(e=>{let t=e=>e.replace(/\[(\d+)\]\(\d+\)/g,"[$1]");return e.replace(/!\[(.*?)\]\((data:image[^)]+)\)/g,(e,n,r)=>{let a=t(n),l="https://DATA_URI/".concat(encodeURIComponent(r));return"![".concat(a,"](").concat(l,")")}).replace(/!\[(.*?)\]\((https?:\/\/[^\)]+)\)/g,(e,n,r)=>{let a=t(n),l=r.replace(/\s+/g,encodeURIComponent(" "));return"![".concat(a,"](").concat(l,")")})})((e=>{let t="";for(let n=0;n<e.length;n+=1){let r=e[n],a=e[n+1]||" ";"$"===r&&a>="0"&&a<="9"&&(r="\\$"),t+=r}return t})(X))})})})},13003:function(e,t,n){"use strict";n.d(t,{Z:function(){return T}});var r=n(52676),a=n(75271),l=n(75154),s=n(90488),i=n(57606),o=n(4389),c=n(4590),d=n(31022),u=n(27585),h=n(49992),p=n(7717),m=n(27571),g=n(56650),x=n(26595),f=n(46024),v=n(49905),b=n(3295),k=n(36551),w=n(64412),j=n(5311),C=n(30674),y=a.memo(e=>{var t,n,y,N,_,F,S,D,Z,M,E,L,A,T,z,H,I,R,B;let{source:P,precedingText:$,rid:V}=e,Y=(0,p.useTranslations)(),{snippet:q,url:O,link:U,title:J,engine_name:W,source_type:X}=P,K=O||U||"",G=(0,u.lx)(K).hostname,Q=(0,l.a)(q),[ee,et]=(0,a.useState)(!1),{sourceHighlightList:en,sourceOriginalList:er,sourceAllMatchList:ea,sourceTranslatedList:el}=(0,i.Z)(),[es,ei]=(0,a.useState)(b.Z.getState().autoTranslateSources),[eo,ec]=(0,a.useState)({translatedTitle:"",translatedSnippet:""}),ed=(0,d.Z)(e=>e.extensionEnable),eu=(0,d.Z)(e=>e.legacyExtensionEnable),eh=(0,j.Z)(e=>e.threads),[ep,em]=(0,a.useState)([]),[eg,ex]=(0,a.useState)(!1),[ef,ev]=(0,a.useState)(null),eb=(0,a.useRef)(null),[ek,ew]=(0,a.useState)(!1),[ej,eC]=(0,a.useState)((0,o.ND)(P.snippet)),[ey,eN]=(0,a.useState)(null),e_=(0,a.useRef)(null),[eF,eS]=(0,a.useState)("");(0,a.useEffect)(()=>{if($){let e="".concat(V,"-").concat(K,"-").concat($),t=en.find(t=>t.id===e);t?eS(eg?"":t.translatedHighlightContent):eS("")}else{let e=P.link,t=en.find(t=>t.link===e);t?eS(eg?"":t.translatedHighlightContent):eS("")}},[K,es,$,P.link,en,eg,V]),(0,a.useEffect)(()=>{let e=(0,v.w0)();et(!!(0,v.SG)(J,q,e))},[P]);let eD=async()=>{try{let e=(0,v.w0)(),t=P.url||P.link||"",n="".concat(V,"-").concat(t,"-").concat(e),r=er.findIndex(e=>e.id===n);if(-1!==r)return;let a=(0,o.ND)(P.snippet);await (0,v.R6)(P.title,a,V||"",P.link||"",e,n)}catch(e){console.warn("error:",e)}};(0,a.useEffect)(()=>{ee&&es&&eD()},[es]);let eZ=(0,a.useCallback)(()=>{try{let e=(0,v.w0)(),t="".concat(V,"-").concat(K,"-").concat(e),n=er.findIndex(e=>e.id===t);-1!==n?eE(n,e):(ei(!1),eL(e),eM())}catch(e){console.warn("error:",e)}},[V,er,K,en,el]),eM=()=>{let e=(0,v.w0)(),t="".concat(K,"-").concat(e),n=el.findIndex(e=>e.id===t);-1!==n&&(ec({translatedTitle:el[n].translatedTitle,translatedSnippet:el[n].translatedSnippet}),ei(b.Z.getState().autoTranslateSources))},eE=(e,t)=>{let n={translatedTitle:er[e].translatedTitle,translatedSnippet:er[e].translated.join("\n")};if(eL(t),!$){let t=en.filter(e=>e.rid===V&&e.link===U),a=[];for(var r=0;r<t.length;r++){let n=er[e].original.findIndex(e=>e===t[r].originalTargetChunk);if(-1!==n){let l=t[r];l.translatedTargetChunk=er[e].translated[n],a.push(l)}}let l=(0,o.KB)(er[e].translated,a,!0);n.translatedSnippet=l,ec(n);return}let a="".concat(V,"-").concat(K,"-").concat($),l=en.find(e=>e.id===a);if(!l){ec(n);return}let s=er[e].original.findIndex(e=>e===l.originalTargetChunk);ec({translatedTitle:er[e].translatedTitle,translatedSnippet:-1!==s?(0,o.LA)(er[e].translated[s],er[e].translated):n.translatedSnippet})},eL=e=>{if($){let e="".concat(V,"-").concat(K,"-").concat($),t=en.find(t=>t.id===e);t?eC(t.originalHighlightContent):eC((0,o.ND)(P.snippet))}else{let t=P.snippet,n=en.filter(e=>e.rid===V&&e.link===U);if(n.length>0){let e=ea.findIndex(e=>e.rid===V&&e.link===U);eC((0,o.KB)(ea[e].snippet.split("\n"),n,!1))}else eC((0,o.ND)(t,e))}},eA=()=>{if(e_.current){let e=e_.current.scrollHeight;ei(!es),setTimeout(()=>{if(e_.current){let t=e_.current.scrollHeight;t>e?eN(t):ey||eN(e)}},0)}};(0,a.useEffect)(()=>{("scholar"===P.engine_name||"scholar"===P.engine)&&eH()},[]),(0,a.useEffect)(()=>{eZ()},[en,el,er]);let eT=(0,r.jsxs)("p",{className:"text-sm text-theme-font-500 dark:text-theme-font-dark-500",children:[(0,r.jsx)("a",{className:"hover:underline hover:underline-offset-2",href:(null===(B=P.link)||void 0===B?void 0:B.includes(".file"))?void 0:P.link,target:"_blank",children:G}),Q&&(0,r.jsxs)("span",{className:"inline-block text-sm text-bold ml-2",children:["[",Q,"]"]})]}),ez=ed?(0,c.m1)(P.link):eu?(0,c.m1)(P.link,!0):P.link;async function eH(){try{let e=await (0,m.q)({sources:[P]});em(e)}catch(e){console.error("Error fetching articles:",e)}}let{other_info:eI}=P;eI||(eI=P);let eR=eI,eB=(null===(t=ep[0])||void 0===t?void 0:t.articleData)||{},eP=(100*eR.relevance).toFixed(0),e$=()=>{ex(!eg)},eV=eg?eR:eB,eY="title"in eV&&eV.title?eV.title:J,eq="abstracts"in eV&&eV.abstracts?eV.abstracts:q;(0,a.useEffect)(()=>{eb.current&&eV.abstracts&&null===ef&&ev(eb.current.offsetHeight)},[ef,eV.abstracts]);let eO=Y("scholar.translated_by"),eU="Glarity",eJ=eO.split(eU);return(0,a.useEffect)(()=>{if("scholar"!==P.engine_name&&"scholar"!==P.engine)return;let e=()=>{document.getElementById("abstractsId")},t=t=>{let n=document.getElementById("abstractsId");if(n||e(),!n){t.preventDefault();return}let{scrollTop:r,clientHeight:a,scrollHeight:l}=n;n.contains(t.target)?"wheel"===t.type?(t.deltaY<0&&r<=0||t.deltaY>0&&r+a>=l-1)&&t.preventDefault():t.stopPropagation():t.preventDefault()},n=["wheel","touchmove"];return ek&&n.forEach(e=>document.addEventListener(e,t,{passive:!1})),()=>{n.forEach(e=>document.removeEventListener(e,t))}},[ek,P.engine_name,P.engine]),(0,a.useEffect)(()=>{let e=e=>{if(!e_.current)return;let{scrollHeight:t,clientHeight:n}=e_.current;t>n&&e_.current.contains(document.elementFromPoint(e.clientX,e.clientY))&&(e.preventDefault(),e_.current.scrollTop+=e.deltaY)};return document.addEventListener("wheel",e,{passive:!1}),()=>{document.removeEventListener("wheel",e)}},[]),"scholar"===P.engine_name||"scholar"===P.engine?(0,r.jsx)("div",{"data-tooltip":"true",className:"flex max-w-[512px] gap-3 w-full rounded-lg p-4 hover:bg-gray-100 dark:hover:bg-[#444549]",onMouseEnter:()=>{ew(!0)},onMouseLeave:()=>{ew(!1)},children:(0,r.jsxs)("section",{children:[(0,r.jsx)("span",{className:"text-sm font-semibold dark:text-[#F5F5F6]",children:eV.topic||eR.topic}),(0,r.jsx)("section",{className:"mt-1 leading-4 mb-4",children:(0,r.jsxs)("span",{className:"text-sm text-bold text-md",children:[(0,r.jsx)("div",{className:"text-[#0A1C38] font-semibold leading-5 dark:text-[#F5F5F6]",children:(0,r.jsx)("a",{className:"hover:underline hover:underline-offset-2 font-semibold",href:eR.source_url,target:"_blank",children:(0,r.jsx)("span",{children:eY})})}),(0,r.jsx)("div",{className:"text-[#7A90B1] dark:text-[#94A2B8] text-xs leading-4 my-2",children:(0,r.jsx)("span",{children:eV.source||eR.source})}),(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-3 border-b border-dashed border-gray-300 pb-3 dark:border-[#434955]",children:[(0,r.jsxs)(x.A,{radius:"sm",variant:"bordered",className:"bg-[#0080FF] text-[#ffffff] h-6 text-xs border-0 rounded-md px-2 py-1",onPress:()=>{window.open(U||eR.source_url,"_blank")},children:[(0,r.jsx)(g.Z,{size:16,className:"mr-0"}),"SEMANTIC_SCHOLAR"===eR.article_channel?"Semantic Scholar":Y("scholar.view_via_publisher")]}),eR.source_url_pdf&&(0,r.jsx)(x.A,{radius:"sm",size:"sm",variant:"bordered",className:"text-[#0080FF] h-6 text-xs px-1 py-2 border rounded-md border-[#0080FF] font-medium",onPress:()=>{window.open(eR.source_url_pdf,"_blank")},children:"PDF"})]}),eq&&(0,r.jsx)("div",{id:"abstractsId",ref:eb,style:{height:ef?"".concat(ef,"px"):"auto"},className:"text-[#1D3C6D] dark:text-[#CECFD2] text-sm leading-5 box-border mb-3 max-h-[140px] overflow-y-auto custom-scrollbar",children:eF?null==eF?void 0:eF.split("\n").map((e,t)=>(0,r.jsx)("p",{className:"whitespace-pre-wrap mb-3 last:mb-0 leading-relaxed",dangerouslySetInnerHTML:{__html:e}},t)):(0,o.ND)(eq).split("\n").map((e,t)=>(0,r.jsx)("p",{className:"whitespace-pre-wrap mb-3 last:mb-0 leading-relaxed",dangerouslySetInnerHTML:{__html:e}},t))}),(0,r.jsxs)("div",{className:"flex text-xs leading-5 text-[#667085] gap-2 flex-wrap dark:text-[#94A2B8]",children:[(null==eR?void 0:eR.authors)&&(null==eR?void 0:null===(n=eR.authors)||void 0===n?void 0:n.length)!==0&&(0,r.jsx)("span",{className:"py-0.5 px-1.5 bg-[#EDF0F3] rounded whitespace-nowrap dark:bg-[#2D323C]",children:(0,h.$)((null==eV?void 0:eV.authors)||(null==eR?void 0:eR.authors))}),eR.publication_date&&(0,r.jsx)("span",{className:"py-0.5 px-1.5 bg-[#EDF0F3] rounded whitespace-nowrap dark:bg-[#2D323C]",children:eR.publication_date.slice(0,10)}),eR.type&&(0,r.jsx)("span",{className:"py-0.5 px-1.5 bg-[#EDF0F3] rounded whitespace-nowrap dark:bg-[#2D323C]",children:eV.type||eR.type}),void 0!==eR.cited_by_count&&(0,r.jsxs)("span",{className:"py-0.5 px-1.5 bg-[#EDF0F3] rounded whitespace-nowrap dark:bg-[#2D323C]",children:[eR.cited_by_count," ",Y("scholar.citations")]})]})]})}),(0,r.jsx)("span",{className:"py-2 px-3 bg-[#E7F3FF] rounded-lg border border-[#A4D1FD] dark:border-[#6F9ECD] text-[#0080FF] text-xs font-medium dark:bg-[#2D323C]",children:"".concat(eP,"% ").concat(Y("scholar.relevant"))}),(null==eR?void 0:null===(y=eR.lang)||void 0===y?void 0:y.toLowerCase())!==(null==eR?void 0:null===(N=eR.target_lang)||void 0===N?void 0:N.toLowerCase())&&(0,r.jsx)("div",{className:"text-xs text-gray-500 dark:text-[#BABDC5] text-center border-t border-dashed border-gray-300 border-[#ECEFF4]  mt-4 pt-2 dark:border-[#2F333B]",children:eg?(0,r.jsx)("span",{onClick:e$,className:"text-[#006DD9] dark:text-[#2F95FB] cursor-pointer",children:Y("scholar.show_translation")}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("span",{children:[eJ[0]," ",(0,r.jsx)("span",{onClick:()=>{window.open("https://glarity.app/products/webpage-translation-with-chatgpt","_blank")},className:"text-[#006DD9] dark:text-[#2F95FB] cursor-pointer",children:eU}),eJ[1]," "]})," ",(0,r.jsx)("span",{onClick:e$,className:"text-[#006DD9] dark:text-[#2F95FB] cursor-pointer",children:Y("scholar.view_original")})]})})]})}):(0,r.jsx)("section",{ref:e_,"data-tooltip":"true",style:{height:ey?"".concat(ey,"px"):"auto"},className:"flex flex-col w-[400px] p-4 overflow-x-hidden overflow-y-auto scrollbar ".concat($?"max-h-[400px]":"max-h-[50vh]"),children:es?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("header",{className:"mb-3 pb-1.5 border-b-1 border-dashed border-theme-border-100 dark:border-theme-border-dark-100",children:[(0,r.jsxs)("div",{className:"flex items-start gap-1",children:[(0,r.jsx)("span",{className:"flex-none mt-0.5 w-5 h-5",children:(null==eh?void 0:null===(E=eh[0])||void 0===E?void 0:E.category)===k.J5||(null==eh?void 0:null===(L=eh[0])||void 0===L?void 0:L.category)===k.Ys&&"image"===X?(0,r.jsx)(w.Z,{fileName:J,w:4,h:4}):(0,r.jsx)(s.Z,{src:K.includes(".file")?K:"https://www.google.com/s2/favicons?domain=".concat(G,"&sz=",16),title:J})}),(null==eh?void 0:null===(A=eh[0])||void 0===A?void 0:A.category)===k.J5||(null==eh?void 0:null===(T=eh[0])||void 0===T?void 0:T.category)===k.Ys&&"image"===X?J:(0,r.jsx)("a",{className:"text-theme-font-800 dark:text-theme-font-dark-800 hover:underline hover:underline-offset-2",href:(null===(z=P.link)||void 0===z?void 0:z.includes(".file"))?void 0:P.link,target:"_blank",children:(0,r.jsx)("span",{className:"text-md font-medium leading-5",children:eo.translatedTitle})}),ee&&(0,r.jsx)("div",{onClick:eA,className:"ml-auto p-1 hover:bg-[#E7F3FF] rounded-lg text-[#0080FF] bg-[#F0F7FF] cursor-pointer dark:text-[#FFF] dark:bg-[#006fee] dark:hover:bg-[#0080FF]",children:(0,r.jsx)(f.vN,{})})]}),(null==eh?void 0:null===(H=eh[0])||void 0===H?void 0:H.category)===k.J5||(null==eh?void 0:null===(I=eh[0])||void 0===I?void 0:I.category)===k.Ys&&"image"===X?null:eT]}),eo.translatedSnippet?(0,r.jsx)("div",{className:"text-theme-font-800 dark:text-theme-font-dark-800",children:null===(R=eo.translatedSnippet)||void 0===R?void 0:R.split("\n").map((e,t)=>(0,r.jsx)("p",{className:"whitespace-pre-wrap mb-3 last:mb-0 leading-relaxed",dangerouslySetInnerHTML:{__html:e}},t))}):(0,r.jsx)("div",{className:"flex justify-center items-center h-full text-sm",children:(0,r.jsx)(C.c,{label:Y("topic.loading"),size:"sm"})})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("header",{className:"mb-3 pb-1.5 border-b-1 border-dashed border-theme-border-100 dark:border-theme-border-dark-100",children:[(0,r.jsxs)("div",{className:"flex items-start gap-1",children:[(0,r.jsx)("span",{className:"flex-none mt-0.5 w-5 h-5",children:(null==eh?void 0:null===(_=eh[0])||void 0===_?void 0:_.category)===k.J5||(null==eh?void 0:null===(F=eh[0])||void 0===F?void 0:F.category)===k.Ys&&"image"===X?(0,r.jsx)(w.Z,{fileName:J,w:4,h:4}):(0,r.jsx)(s.Z,{src:K.includes(".file")?K:"https://www.google.com/s2/favicons?domain=".concat(G,"&sz=",16),title:J})}),(null==eh?void 0:null===(S=eh[0])||void 0===S?void 0:S.category)===k.J5||(null==eh?void 0:null===(D=eh[0])||void 0===D?void 0:D.category)===k.Ys&&"image"===X?(0,r.jsx)("span",{className:"text-md font-medium leading-5",children:J}):(0,r.jsx)("a",{className:"text-theme-font-800 dark:text-theme-font-dark-800 hover:underline hover:underline-offset-2",href:(null==ez?void 0:ez.includes(".file"))?void 0:ez,target:"_blank",children:(0,r.jsx)("span",{className:"text-md font-medium leading-5",children:J})}),ee&&(0,r.jsx)("div",{onClick:eA,className:"ml-auto p-1 hover:bg-gray-200 rounded-lg text-gray-700 bg-gray-100 cursor-pointer dark:hover:bg-gray-600 dark:bg-gray-700 dark:text-white",children:(0,r.jsx)(f.vN,{})})]}),(null==eh?void 0:null===(Z=eh[0])||void 0===Z?void 0:Z.category)===k.J5||(null==eh?void 0:null===(M=eh[0])||void 0===M?void 0:M.category)===k.Ys&&"image"===X?null:eT]}),(0,r.jsx)("div",{className:"text-theme-font-800 dark:text-theme-font-dark-800",children:null==ej?void 0:ej.split("\n").map((e,t)=>(0,r.jsx)("p",{className:"whitespace-pre-wrap mb-3 last:mb-0 leading-relaxed",dangerouslySetInnerHTML:{__html:e}},t))})]})})}),N=n(99979),_=n(17859),F=a.memo(e=>{let{source:t,openIframe:n}=e,{snippet:a,url:l,link:s,title:i,other_info:o}=t;return o&&"imageUrl"in o?(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("section",{"data-tooltip":"true",className:"flex flex-col max-w-[400px] whitespace-pre-wrap cursor-pointer",onClick:()=>window.open(s||l,"_blank"),children:(0,r.jsxs)("section",{className:"relative",children:[(0,r.jsx)("img",{src:(0,_.V)(o.imageUrl),alt:t.title,className:"w-full h-full min-w-80 min-h-96 object-cover"}),(0,r.jsx)("section",{className:"absolute bottom-0 left-0 w-full py-3 px-4 bg-white/90 text-black dark:bg-black/70 dark:text-white",children:(0,r.jsxs)("section",{className:"w-full flex items-center justify-between gap-2",children:[(0,r.jsxs)("section",{className:"flex items-center gap-2",children:[(0,r.jsx)("img",{src:o.avatar,className:"w-6 h-6 rounded-full"}),(0,r.jsx)("span",{className:"truncate",children:o.nickname})]}),(0,r.jsxs)("section",{className:"flex items-center gap-2",children:[(0,r.jsx)(N.Z,{size:14}),(0,r.jsx)("span",{children:null==o?void 0:o.liked_count})]})]})})]})})}):(0,r.jsx)(y,{source:t})}),S=n(96164),D=n(64657),Z=n(5687),M=n(93650),E=n(9455),L=n(29871);let A=e=>{let{source:t,openIframe:n,precedingText:a,rid:l}=e,{url:s,link:i}=t;return(0,u.lx)(s||i||"").hostname.includes("xiaohongshu.com")?(0,r.jsx)(F,{source:t,openIframe:n}):(0,r.jsx)(y,{source:t,precedingText:a,rid:l})};var T=a.memo(e=>{let{source:t,placement:n,children:l,precedingText:s,isVisible:c,rid:d,offset:h}=e,{isMobile:p}=(0,L.Z)(),{isOpen:m,onOpen:g,onClose:x}=(0,E.q)(),[f,k]=(0,a.useState)(!1),[w,j]=(0,a.useState)("top"),C=(0,a.useRef)(null),y=(0,b.Z)(e=>e.autoTranslateSources),{sourceOriginalList:N,sourceAllMatchList:_,sourceTranslatedList:F}=(0,i.Z)(),[T,z]=(0,a.useState)(""),H=async()=>{try{let e=(0,v.w0)(),n=t.url||t.link||"",r="".concat(d,"-").concat(n,"-").concat(e),a=N.findIndex(e=>e.id===r);if(-1!==a)return;let l=(0,o.ND)(t.snippet);await (0,v.R6)(t.title,l,d||"",t.link||"",e,r)}catch(e){console.warn("error:",e)}};return(0,a.useEffect)(()=>{let{url:e,link:n}=t;if(!(0,u.lx)(e||n||"").hostname.includes("xiaohongshu.com")&&t&&"scholar"!==t.engine_name&&"scholar"!==t.engine){if(!c)return;y&&H()}},[t,s,c,y]),p?l:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(S.e,{delay:100,showArrow:!0,onOpenChange:e=>{if(!n&&e){var t;let e=null===(t=C.current)||void 0===t?void 0:t.getBoundingClientRect();if(e){let t=window.innerHeight,n=e.top;t-e.bottom>n?j("bottom"):j("top")}}},placement:n||w,offset:h,className:"notranslate p-0 shadow-xl rounded-xl overflow-hidden bg-white dark:bg-theme-bg-dark-300",content:(0,r.jsx)(A,{source:t,openIframe:e=>{k(!1),z(e),g()},precedingText:s,rid:d}),classNames:{base:"notranslate"},children:(0,r.jsx)("span",{ref:C,children:l})}),(0,r.jsx)(D.R,{isOpen:m,onClose:()=>{z(""),x()},size:"5xl",closeButton:(0,r.jsx)(r.Fragment,{}),children:(0,r.jsx)(Z.A,{children:(0,r.jsx)(M.I,{className:"p-0",children:(0,r.jsx)("section",{className:"h-[80vh]",children:(0,r.jsx)("iframe",{src:T,width:"100%",height:"100%"})})})})})]})})},25339:function(e,t,n){"use strict";n.d(t,{FK:function(){return a},fh:function(){return l}});let r=/[A-Za-z0-9.-]*[A-Za-z0-9-]/,a=["(?:","(",/(?:[A-Za-z][-.+A-Za-z0-9]+:(?![A-Za-z][-.+A-Za-z0-9]+:\/\/)(?!\d+\/?)(?:\/\/)?)/.source,r.source,")","|","(?:",/(?:www\.)/.source,r.source,")","|","(?:",r.source,/\.(?:international|construction|contractors|enterprises|photography|productions|foundation|immobilien|industries|management|properties|technology|christmas|community|directory|education|equipment|institute|marketing|solutions|vacations|bargains|boutique|builders|catering|cleaning|clothing|computer|democrat|diamonds|graphics|holdings|lighting|partners|plumbing|supplies|training|ventures|academy|careers|company|cruises|domains|exposed|flights|florist|gallery|guitars|holiday|kitchen|neustar|okinawa|recipes|rentals|reviews|shiksha|singles|support|systems|agency|berlin|camera|center|coffee|condos|dating|estate|events|expert|futbol|kaufen|luxury|maison|monash|museum|nagoya|photos|repair|report|social|supply|tattoo|tienda|travel|viajes|villas|vision|voting|voyage|actor|build|cards|cheap|codes|dance|email|glass|house|mango|ninja|parts|photo|shoes|solar|today|tokyo|tools|watch|works|aero|arpa|asia|best|bike|blue|buzz|camp|club|cool|coop|farm|fish|gift|guru|info|jobs|kiwi|kred|land|limo|link|menu|mobi|moda|name|pics|pink|post|qpon|rich|ruhr|sexy|tips|vote|voto|wang|wien|wiki|zone|bar|bid|biz|cab|cat|ceo|com|edu|gov|int|kim|mil|net|onl|org|pro|pub|red|tel|uno|wed|xxx|xyz|ac|ad|ae|af|ag|ai|al|am|an|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cu|cv|cw|cx|cy|cz|de|dj|dk|dm|do|dz|ec|ee|eg|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|st|su|sv|sx|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tp|tr|tt|tv|tw|tz|ua|ug|uk|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|za|zm|zw)\b/.source,")",")","(?:"+/[-A-Za-z0-9+&@#\\/%=~_()|'$*[\]?!:,.;]*[-A-Za-z0-9+&@#/%=~_()|'$*[\]]/.source+")?"].join("");class l{getUrl(){let e=this._url;return this._protocolMatched||this.protocolPrepended||(e="http://"+e,this.protocolPrepended=!0),e}getAnchorHref(){return this.getUrl().replace(/&amp;/g,"&")}getAnchorText(){return this._url}constructor(e,t){this.protocolPrepended=!1,this._url=e,this._protocolMatched=t}}},75154:function(e,t,n){"use strict";n.d(t,{a:function(){return r}});let r=e=>{if(!e)return"";let t=[...e.matchAll(/(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{1,2}), (\d{4})/g)];if(t.length>0){let n=t[0];if(0===e.indexOf(n[0])){let e=new Date("".concat(n[1]," ").concat(n[2],", ").concat(n[3])),t=e.getFullYear().toString(),r=(e.getMonth()+1).toString().padStart(2,"0"),a=e.getDate().toString().padStart(2,"0");return"".concat(t,"-").concat(r,"-").concat(a)}}return""}},27571:function(e,t,n){"use strict";n.d(t,{q:function(){return l}});var r=n(13263);let a=new Map,l=async e=>{let{sources:t,retries:n=1}=e,l=async(e,t,n)=>{let s="".concat(e,"-").concat(t);if(a.has(s))return a.get(s);try{let n=await (0,r.bo)(e,t);return a.set(s,n),n}catch(r){if(n>0)return console.warn("获取文章信息失败，重试中... 剩余重试次数: ".concat(n),r),l(e,t,n-1);return console.error("获取文章信息时出错:",r),null}};try{let e=Array.isArray(t)?t:[t],r=e.filter(e=>e.other_info&&"article_id"in e.other_info).map(e=>({article_id:e.other_info.article_id,session_id:e.other_info.session_id})),a=await Promise.all(r.map(e=>{let{article_id:t,session_id:r}=e;return l(t,r,n)}));return e.map((e,t)=>{var n,r,l,s;let i=a[t];return i?{...e,articleData:i}:{...e,articleData:{title:e.title,abstracts:e.snippet,authors:(null==e?void 0:null===(n=e.other_info)||void 0===n?void 0:n.authors)||[],source:(null==e?void 0:null===(r=e.other_info)||void 0===r?void 0:r.source)||"",topic:(null==e?void 0:null===(l=e.other_info)||void 0===l?void 0:l.topic)||"",type:(null==e?void 0:null===(s=e.other_info)||void 0===s?void 0:s.type)||""}}})}catch(e){throw Error("获取文章信息时出错: ".concat(e))}}},17859:function(e,t,n){"use strict";n.d(t,{V:function(){return r}});let r=e=>e?e.includes("https://sns-webpic-qc.xhscdn.com")?e.replace("https://sns-webpic-qc.xhscdn.com","https://felo.ai/webpic"):e.includes("http://sns-webpic-qc.xhscdn.com")?e.replace("http://sns-webpic-qc.xhscdn.com","https://felo.ai/webpic"):e:""},49992:function(e,t,n){"use strict";n.d(t,{$:function(){return r}});let r=e=>{if(!e||0===e.length)return"";let t=e[0],n=e.length-1;return n>0?"".concat(t," +").concat(n):t}},4389:function(e,t,n){"use strict";n.d(t,{KB:function(){return m},LA:function(){return h},ND:function(){return o},Si:function(){return c},UA:function(){return d}});var r=n(29499),a=n(32096),l=n(13263),s=n(57606);let i=(e,t,n)=>{if("bn"===n||"hi"===n){let e=t.match(/[^।]*।/g);if(e)return e}if("ur"===n){let e=t.match(/[^۔]*۔/g);if(e)return e}return e},o=(e,t)=>e?p(e,t).join("\n"):"",c=async(e,t)=>{try{let n=[],a=[];for(let t=0;t<e.length;t++){let l=[],i=[],o=s.Z.getState().sourceOriginalList.find(n=>n.rid==e[t].rid&&n.link===e[t].link);o?(l=(null==o?void 0:o.translated)||[],i=(null==o?void 0:o.original)||[]):l=e[t].snippet.split("\n");let c=l.join("\n"),d=(0,r.h4)(e[t].matchContent);if(c){let r={content:c,chunk:d};n.push(r);let s={contentSentences:l,id:e[t].id,originalSentences:i,matchContent:d};a.push(s)}}let i=await (0,l.d4)(n);if(!i)return null;await Promise.all(i.map(async(n,r)=>{let l=h(n.target_chunk,a[r].contentSentences,t),i=a[r].contentSentences.findIndex(e=>e===n.target_chunk),o=a[r].originalSentences.length>0,c={id:a[r].id,translatedHighlightContent:o?l:"",originalHighlightContent:o?h(a[r].originalSentences[i],a[r].originalSentences,t):l,originalTargetChunk:o?a[r].originalSentences[i]:n.target_chunk,translatedTargetChunk:o?n.target_chunk:"",rid:e[r].rid,link:e[r].link};s.Z.getState().addHighlightItem(c)}))}catch(e){return console.log(e),null}},d=async(e,t)=>{try{let a=[],i=[];for(let t=0;t<e.length;t++){let n=[],l=[],o=s.Z.getState().sourceOriginalList.find(n=>n.rid==e[t].rid&&n.link===e[t].link);o?(n=(null==o?void 0:o.translated)||[],l=(null==o?void 0:o.original)||[]):n=e[t].snippet.split("\n");let c=n.join("\n"),d=(0,r.h4)(e[t].matchContent);if(c){let r={content:c,chunk:d};a.push(r);let s={contentSentences:n,id:e[t].id,originalSentences:l};i.push(s)}}let o=await (0,l.d4)(a);if(!o)return null;let c=[];for(var n=0;n<o.length;n++){let r=h(o[n].target_chunk,i[n].contentSentences,t),a=i[n].originalSentences.length>0,l={id:i[n].id,translatedHighlightContent:a?r:"",originalHighlightContent:"",originalTargetChunk:"",translatedTargetChunk:a?o[n].target_chunk:"",rid:e[n].rid,link:e[n].link};c.push(l)}return c}catch(e){return console.log(e),null}};function u(e){return e?e.replace(/[.,\/#!$%\^&\*;:{}=\-_`~()·\s]/g,""):""}let h=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r='<span class="bg-blue-200 text-black px-1 rounded">'.concat(e,"</span>"),a=t.findIndex(t=>t===e||u(t).includes(u(e)));-1==a&&(t=[e,...t],a=0);let l=t.slice(Math.max(0,a-2),a),s=t.slice(a+1,a+3);return(n?t.map((e,t)=>t===a?r:e):[...l.map(e=>e),r,...s.map(e=>e)]).join("\n")},p=(e,t)=>e?(e=e.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(RegExp("([^\\p{P}])\\n","gu"),"$1,").replace(RegExp("(\\p{P})\\n","gu"),"$1"),i((0,a.Vl)(e).filter(e=>"Sentence"===e.type).map(e=>e.raw).map(e=>e.replace(RegExp("^[\\p{P}]+","u"),"")),e,t)):[],m=(e,t,n)=>{let r=[];for(let a of e){let e=a;for(let r of t){let t=n?r.translatedTargetChunk:r.originalTargetChunk,l=e=>e.replace(/\s+/g,"").trim();if(l(a)==l(t)&&!a.includes("<span>")){e=a.replace(a,'<span class="bg-blue-200 text-black px-1 rounded">'.concat(a,"</span>"));break}}r.push(e)}return r.join("\n")}},99421:function(e,t,n){"use strict";n.d(t,{$5:function(){return g},LY:function(){return p},SK:function(){return d},cC:function(){return m},h_:function(){return x},k5:function(){return u}});var r=n(57606),a=n(49905),l=n(4389),s=n(97247),i=n(23873),o=n(75534),c=n(3295);function d(e){let t="";for(let n=0;n<e.length;n+=1){let r=e[n],a=e[n-1]||" ",l=e[n+1]||" ";"$"===r&&l>="0"&&l<="9"&&"$"!==a&&(r="\\$"),"~"===r&&l>="0"&&l<="9"&&(r="\\~"),t+=r}return t}function u(e){return e.replace(/(```[\s\S]*?```|`.*?`)|\\\[([\s\S]*?[^\\])\\\]|\\\((.*?)\\\)|\[(\d+)\]|([（(])(https?:\/\/\S+)([）)])/g,(e,t,n,r,a,l,s,i)=>t?t:n?"$$".concat(n,"$$"):r?"$".concat(r,"$"):a?"[".concat(a,"](").concat(a,")"):s?"".concat(l).concat(s).concat(i):e)}let h=async e=>{try{let t=[];for(let n=0;n<e.length;n+=6)t.push(e.slice(n,n+6));await Promise.all(t.map(e=>(0,l.Si)(e)))}catch(e){console.warn("error:",e)}},p=async e=>{if((0,s.N0)())return;let t=r.Z.getState().sourceAllMatchList.filter(t=>t.rid===e);try{c.Z.getState().autoTranslateSources&&await (0,a.mj)(t,r.Z.getState().sourceOriginalList),await h(t)}catch(e){console.warn("Error processing match content:",e)}},m=(e,t,n,a)=>{let s=e.url||e.link||"",i="".concat(t,"-").concat(s,"-").concat(n);if(!r.Z.getState().sourceAllMatchList.some(e=>e.id===i)){let s={rid:t||"",id:i,matchContent:n,snippet:(0,l.ND)(e.snippet),title:e.title,link:a};r.Z.getState().addSourceAllMatchListItem(s)}},g=e=>{var t,n,r;let a=document.getSelection();if(!a||0===a.rangeCount)return;let l=a.getRangeAt(0),s=document.createElement("div");s.appendChild(l.cloneContents());let i=s.getElementsByClassName("footnote-ref");for(;i.length>0;){let e=i[0];null===(r=e.parentNode)||void 0===r||r.removeChild(e)}let o=s.innerHTML,c=s.textContent||"";null===(t=e.clipboardData)||void 0===t||t.setData("text/html",o),null===(n=e.clipboardData)||void 0===n||n.setData("text/plain",c)},x=async e=>{try{let t=e.replace(/(`[\s\S]*?`|`.*?`)|\[(\d+)\]/g,(e,t,n)=>t||(n?"":e)),n=await i.TU.parse(t);return(0,o.s9)(n,{wordwrap:!1,selectors:[{selector:"h1",options:{uppercase:!1}},{selector:"h2",options:{uppercase:!1}},{selector:"h3",options:{uppercase:!1}}]}).replace(/[^\S\n]+/g," ").replace(/\n\s*\n+/g,"\n").trim()}catch(t){return console.log("error",t),e}}},43220:function(e){e.exports={footnoteRef:"footnote_footnoteRef__k_UCF"}},14701:function(e){e.exports={markdown:"markdown_markdown__wTkaE"}}}]);